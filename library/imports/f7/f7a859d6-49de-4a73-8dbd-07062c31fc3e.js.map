{"version":3,"sources":["assets\\common-plugin\\Scripts\\AdAgentDouyin.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import AdAgent from \"./AdAgent\";\r\nimport { BannerLocation, LevelStatus, BeForGameOverAdId } from \"./YZ_Constant\";\r\nimport PlatUtils from \"./PlatUtils\";\r\nimport { utils } from \"./Utils\";\r\n\r\nconst { ccclass, property } = cc._decorator;\r\n\r\n@ccclass\r\nexport default class AdAgentDouyin extends AdAgent {\r\n\r\n    _bannerAd: any = null;\r\n    _videoAd: any = null;\r\n    _sysData: any = null;\r\n\r\n    _bannerAds: any[] = [];\r\n    _isBannerShow: boolean = false;\r\n\r\n    public get ServerConfig() {\r\n        return utils.Tool_Douyin.ServerConfig;\r\n    }\r\n\r\n    //@ts-ignore\r\n    tt: any = window.tt;\r\n    public Init() {\r\n        if (PlatUtils.IsDouyin) {\r\n            //@ts-ignore\r\n\r\n            this._sysData = utils.Tool_Douyin._sysInfo;\r\n            // utils.registerServerInitEvent(() => {\r\n            //     // this._initVideoAd();\r\n\r\n            // }, this)\r\n        }\r\n    }\r\n\r\n    _bannerBottom: number = 0;\r\n    public ShowBanner(location: BannerLocation, args: any = null) {\r\n        if (PlatUtils.IsDouyin) {\r\n\r\n            if (utils.isShowRecommondGamesBanner() && utils.Tool_Douyin.isShowMoreGamesModal()) {\r\n                utils.showRecommendGamesBanner();\r\n                utils.showLog(`服务器配置展示自定义banner`);\r\n                return;\r\n            }\r\n            if (utils.Tool_Douyin.isNewsArticleLite) {\r\n                utils.showLog(\"头条极速版不显示Banner广告\");\r\n                return;\r\n            }\r\n            if (this._isConfigValid()) {\r\n\r\n                let argsTmp = args;\r\n                let bannerSizePercent: number = 1;\r\n                if (argsTmp && argsTmp.width) {\r\n                    bannerSizePercent = ((argsTmp.width < 0) ? 0.1 : argsTmp.width);\r\n                    bannerSizePercent = ((argsTmp.width > 1) ? 1 : bannerSizePercent);\r\n                }\r\n\r\n                if (argsTmp && argsTmp.bottom) {\r\n                    this._bannerBottom = argsTmp.bottom / this._sysData.pixelRatio;\r\n                    this._bannerBottom = ((this._bannerBottom < 0) ? 0 : this._bannerBottom);\r\n                    this._bannerBottom = ((this._bannerBottom > this._sysData.screenHeight) ? this._sysData.screenHeight : this._bannerBottom);\r\n                }\r\n\r\n                let targetBannerAdWidth = 60;\r\n                let left: number = (this._sysData.screenWidth - targetBannerAdWidth) * 0.5;\r\n                let top: number = this._sysData.screenHeight - (targetBannerAdWidth / 16 * 9 - this._bannerBottom);\r\n\r\n                // 创建一个居于屏幕底部正中的广告\r\n                let bannerId: string = utils.config.douyinconfig.bannerId;\r\n                utils.showLog(\"显示Banner广告: bannerId=\" + bannerId + \" #targetBannerAdWidth=\", targetBannerAdWidth);\r\n                //@ts-ignore\r\n                try {\r\n                    let bannerAd = this.tt.createBannerAd({\r\n                        adUnitId: bannerId,\r\n                        style: {\r\n                            width: targetBannerAdWidth,\r\n                            left: left,\r\n                            top: top\r\n                        }\r\n                    });\r\n\r\n                    if (bannerAd) {\r\n                        let self = this;\r\n                        bannerAd.onLoad(function () {\r\n                            bannerAd.show().then(() => {\r\n                                utils.showLog('广告显示成功');\r\n                                for (let i = 0; i < self._bannerAds.length; i++) {\r\n                                    if (self._bannerAds[i] != bannerAd && self._bannerAds[i] != null) {\r\n                                        self._bannerAds[i].destroy();\r\n                                    }\r\n                                }\r\n                                self._bannerAds.length = 0;\r\n                                self._bannerAds.push(bannerAd);\r\n                            }).catch(err => {\r\n                                utils.showLog(`广告组件出现问题  ${err.errCode, err.errMsg}`);\r\n                            });\r\n                        });\r\n\r\n                        bannerAd.onError((err) => {\r\n                            if (err) {\r\n                                utils.showLog(`Banner 广告出错: errCode:  ${err.errCode} errMsg:${err.errMsg}`);\r\n                            }\r\n                        });\r\n\r\n                        bannerAd.onResize((res) => {\r\n                            // 如果一开始设置的 banner 宽度超过了系统限制，可以在此处加以调整\r\n                            bannerAd.style.top = this._sysData.screenHeight - res.height - this._bannerBottom;\r\n\r\n                            if (res.width > 0) {\r\n                                bannerAd.style.left = (this._sysData.screenWidth - res.width) * 0.5;\r\n                            } else {\r\n                                bannerAd.style.left = (this._sysData.screenWidth - targetBannerAdWidth) / 2;\r\n                            }\r\n\r\n                        });\r\n\r\n                        this._bannerAds.push(bannerAd);\r\n                    }\r\n\r\n                } catch (error) {\r\n\r\n                }\r\n\r\n\r\n            } else {\r\n                utils.showLog(\"抖音小游戏配置文件出错!\");\r\n            }\r\n        }\r\n    }\r\n    public HideBanner(location: BannerLocation) {\r\n        if (PlatUtils.IsDouyin) {\r\n            for (let i = 0; i < this._bannerAds.length; i++) {\r\n                if (this._bannerAds[i] != null) {\r\n                    this._bannerAds[i].destroy();\r\n                }\r\n            }\r\n            this._bannerAds.length = 0;\r\n        }\r\n    }\r\n\r\n\r\n    private checkCanShowInterstitial() {\r\n        if (this.tt.createInterstitialAd) {\r\n            return true;\r\n        }\r\n        return false;\r\n    }\r\n\r\n\r\n    _lastShowInterstitialTime: number = 0\r\n    public ShowInterstitial(location: BannerLocation) {\r\n        if (PlatUtils.IsDouyin) {\r\n            if (this.checkCanShowInterstitial()) {\r\n                let curTime: number = new Date().getTime();\r\n                let interval: number = (curTime - this._lastShowInterstitialTime) / 1000;\r\n                if (interval < 30) {\r\n                    utils.showLog(\"距离插屏广告或者激励视频广告上次播放时间间隔不足30秒\");\r\n                    return;\r\n                }\r\n                this._lastShowInterstitialTime = curTime;\r\n                utils.delayCall(this._createMiniGameInsertAd.bind(this), this.ServerConfig.intersititia_delay_show_time || 0);\r\n            } else {\r\n                utils.showLog(\"当前客户端版本不支持插屏！\");\r\n            }\r\n        }\r\n    }\r\n\r\n    private interstitialAd = null;\r\n    public _createMiniGameInsertAd() {\r\n        try {\r\n            if (!utils.config.douyinconfig.insertId) {\r\n                utils.showLog(\"插屏ID配置有误\");\r\n                return;\r\n            }\r\n            if (this.interstitialAd) {\r\n                this.interstitialAd.destroy();\r\n                this.interstitialAd = null;\r\n            }\r\n\r\n            this.interstitialAd = this.tt.createInterstitialAd({\r\n                adUnitId: utils.config.douyinconfig.insertId\r\n            });\r\n            this.interstitialAd.load().then(() => {\r\n                this.interstitialAd.show();\r\n            }).catch(err => {\r\n                utils.showLog(err);\r\n                utils.showLog(\"err.errCode:\" + err.errCode);\r\n\r\n                switch (err.errCode) {\r\n                    case 2001:\r\n                        utils.showLog(\"小程序启动一定时间内不允许展示插屏广告\")\r\n                        break;\r\n                    case 2002:\r\n                        utils.showLog(\"距离小程序插屏广告或者激励视频广告上次播放时间间隔不足，不允许展示插屏广告\")\r\n                        break;\r\n                    case 2003:\r\n                        utils.showLog(\"当前正在播放激励视频广告或者插屏广告，不允许再次展示插屏广告\")\r\n                        break;\r\n                    case 2004:\r\n                        utils.showLog(\"该项错误不是开发者的异常情况，或因小程序页面切换导致广告渲染失败\")\r\n                        break;\r\n                    case 2005:\r\n                        utils.showLog(\"插屏广告实例不允许跨页面调用\")\r\n                        break;\r\n                    default:\r\n                        // 参考 https://minigame.vivo.com.cn/documents/#/lesson/open-ability/ad?id=广告错误码信息 对错误码做分类处理\r\n                        utils.showLog(\"插屏广告展示失败\")\r\n                        break;\r\n                }\r\n\r\n            });\r\n        } catch (error) {\r\n            utils.showLog(error);\r\n        }\r\n\r\n\r\n    }\r\n    _videoCallback: Function = null;\r\n    _isVideoLoaded: boolean = false;\r\n    _isVideoShow: boolean = false;\r\n    public ShowVideo(callback: Function) {\r\n\r\n        if (PlatUtils.IsDouyin) {\r\n            this._videoCallback = callback;\r\n            this._isVideoShow = true;\r\n\r\n            if (utils.Tool_Douyin.ServerConfig) {\r\n                let posId: string = utils.config.douyinconfig.videoId.trim();\r\n                utils.showLog(\"video广告ID:\" + posId);\r\n                if (!this._videoAd) {\r\n                    //@ts-ignore\r\n                    this._videoAd = tt.createRewardedVideoAd({\r\n                        adUnitId: posId\r\n                    });\r\n                    if (this._videoAd) {\r\n                        utils.showLog(\"初始化注册视频回调!\");\r\n                        // this._videoAd.onLoad(() => {\r\n                        //     utils.showLog(\"激励视频加载成功\", this._isVideoShow);\r\n                        //     // this._isVideoLoaded = true;\r\n                        //     // if (this._isVideoShow) {\r\n\r\n                        //     //     this._isVideoShow = false;\r\n                        //     // }\r\n                        // })\r\n\r\n                        this._videoAd.onError((err) => {\r\n                            utils.showLog(`激励视频出错: ${err.code, err.msg}`);\r\n                            this._isVideoLoaded = false;\r\n                            if (this._videoCallback) {\r\n                                this._videoCallback(false, \"暂无视频广告!\");\r\n                                this._videoCallback = null;\r\n                            }\r\n                        });\r\n\r\n                        this._videoAd.onClose((res) => {\r\n                            this._isVideoShow = false;\r\n                            this._isVideoLoaded = false;\r\n                            if (res.isEnded) {\r\n                                utils.showLog('激励视频广告完成，发放奖励');\r\n                                if (this._videoCallback) {\r\n                                    this._videoCallback(true, \"\");\r\n                                    this._videoCallback = null;\r\n                                }\r\n                            } else {\r\n                                utils.showLog('激励视频广告取消关闭，不发放奖励');\r\n                                if (this._videoCallback) {\r\n                                    this._videoCallback(false, \"观看完视频才能获得奖励!\");\r\n                                    this._videoCallback = null;\r\n                                }\r\n                            }\r\n                        });\r\n                    } else {\r\n                        utils.showLog(\"videoAd 对象创建失败，播放失败!\");\r\n                        if (this._videoCallback) {\r\n                            this._videoCallback(false, \"暂无视频广告!\");\r\n                            this._videoCallback = null;\r\n                        }\r\n                    }\r\n                }\r\n                // else {\r\n\r\n                // if (this._isVideoLoaded) {\r\n                //     this._videoAd.show().then(() => {\r\n                //         utils.showLog(\"激励视频播放成功!\");\r\n                //     }).catch((ero) => {\r\n                //         utils.showLog(\"激励视频播放失败! >>>>\" + ero);\r\n                //         if (this._videoCallback) {\r\n                //             this._videoCallback(false, \"视频播放失败,请稍后再试!\");\r\n                //             this._videoCallback = null;\r\n                //         }\r\n                //     });\r\n                //     this._isVideoShow = false;\r\n                // } else {\r\n                this._videoAd.load().then(() => {\r\n                    utils.showLog(\"激励视频加载成功\");\r\n                    this._videoAd.show().then(() => {\r\n                        utils.showLog(\"激励视频播放成功!\");\r\n                        this._lastShowInterstitialTime = new Date().getTime();\r\n                    }).catch(() => {\r\n                        utils.showLog(\"激励视频播放失败!\");\r\n                        if (this._videoCallback) {\r\n                            this._videoCallback(false, \"视频播放失败,请稍后再试!\");\r\n                            this._videoCallback = null;\r\n                        }\r\n                    });\r\n                }).catch(() => {\r\n                    utils.showLog(\"再次播放视频资源加载失败!\");\r\n                    if (this._videoCallback) {\r\n                        this._videoCallback(false, \"视频播放失败,请稍后再试!\");\r\n                        this._videoCallback = null;\r\n                    }\r\n                });\r\n            }\r\n\r\n            // }\r\n        } else {\r\n            utils.showLog(\"获取配置失败，视频无法播放!\");\r\n            if (this._videoCallback) {\r\n                this._videoCallback(false, \"暂无视频广告!\");\r\n                this._videoCallback = null;\r\n            }\r\n        }\r\n        // }\r\n    }\r\n\r\n    _initVideoAd() {\r\n        if (!this._videoAd) {\r\n            if (utils.Tool_Douyin.ServerConfig) {\r\n                let posId: string = utils.config.douyinconfig.videoId.trim();\r\n                utils.showLog(\"video广告ID:\" + posId);\r\n                //@ts-ignore\r\n                this._videoAd = tt.createRewardedVideoAd({\r\n                    adUnitId: posId\r\n                });\r\n\r\n                if (this._videoAd) {\r\n                    utils.showLog(\"初始化注册视频回调!\");\r\n                    this._videoAd.onLoad(() => {\r\n                        utils.showLog(\"激励视频加载成功\", this._isVideoShow);\r\n                        this._isVideoLoaded = true;\r\n                        if (this._isVideoShow) {\r\n                            this._videoAd.show().then(() => {\r\n                                utils.showLog(\"激励视频播放成功!\");\r\n                            }).catch(() => {\r\n                                utils.showLog(\"激励视频播放失败!\");\r\n                                if (this._videoCallback) {\r\n                                    this._videoCallback(false, \"视频播放失败,请稍后再试!\");\r\n                                    this._videoCallback = null;\r\n                                }\r\n                            });\r\n                            this._isVideoShow = false;\r\n                        }\r\n                    })\r\n\r\n                    this._videoAd.onError((err) => {\r\n                        utils.showLog(`激励视频出错: ${err.code, err.msg}`, err);\r\n                        this._isVideoLoaded = false;\r\n                        if (this._videoCallback) {\r\n                            this._videoCallback(false, \"暂无视频广告!\");\r\n                            this._videoCallback = null;\r\n                        }\r\n                    });\r\n\r\n                    this._videoAd.onClose((res) => {\r\n                        this._isVideoShow = false;\r\n                        this._isVideoLoaded = false;\r\n                        if (res.isEnded) {\r\n                            utils.showLog('激励视频广告完成，发放奖励');\r\n                            if (this._videoCallback) {\r\n                                this._videoCallback(true, \"\");\r\n                                this._videoCallback = null;\r\n                            }\r\n                        } else {\r\n                            utils.showLog('激励视频广告取消关闭，不发放奖励');\r\n                            if (this._videoCallback) {\r\n                                this._videoCallback(false, \"观看完视频才能获得奖励!\");\r\n                                this._videoCallback = null;\r\n                            }\r\n                        }\r\n\r\n                        this._videoAd.load().then(() => {\r\n                            utils.showLog(\"关闭视频后重新加载视频资源成功！\");\r\n                            this._isVideoShow = false;\r\n                            this._isVideoLoaded = true;\r\n                        });\r\n                    });\r\n                } else {\r\n                    utils.showLog(\"暂无视频广告!\");\r\n                    if (this._videoCallback) {\r\n                        this._videoCallback(false, \"暂无视频广告!\");\r\n                        this._videoCallback = null;\r\n                    }\r\n                }\r\n            } else {\r\n                utils.showLog(\"暂无视频广告!\");\r\n                if (this._videoCallback) {\r\n                    this._videoCallback(false, \"暂无视频广告!\");\r\n                    this._videoCallback = null;\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    _isConfigValid() {\r\n        if (PlatUtils.IsDouyin) {\r\n            return (utils.config.douyinconfig\r\n                && utils.config.douyinconfig.appID\r\n                && utils.config.douyinconfig.bannerId\r\n                && utils.config.douyinconfig.videoId);\r\n        }\r\n        return false;\r\n    }\r\n\r\n    public ShowCloseBtnBanner(location: BannerLocation = BannerLocation.Home, args: any) {\r\n        utils.showLog(\"ShowCloseBtnBanner >>>>>>>>>.\");\r\n\r\n        let isMoveBtn = 0;\r\n        let fadeInTime = 0;\r\n        let btn: cc.Node = args.closeBtn;\r\n        let winHeight = cc.winSize.height;\r\n\r\n        btn.opacity = 0;\r\n        if (this.ServerConfig) {\r\n\r\n\r\n            if (this.ServerConfig.show_close_btn_delay) {\r\n                fadeInTime = this.ServerConfig.show_close_btn_delay;\r\n            }\r\n\r\n            // setTimeout(() => {\r\n\r\n            //     utils.showLog(\"延迟调用关闭按钮的Banner >>>>\");\r\n            //     this.ShowBanner(location, args);\r\n\r\n            //     var adY = 200;\r\n            //     utils.showLog('utils - adY:' + adY);\r\n            //     if (adY > 0 && btn) {\r\n            //         btn.y = -(winHeight / 2 - adY) + btn.height;\r\n            //         utils.showLog(\"btnClose.y\" + btn.y);\r\n            //     }\r\n            // }, isMoveBtn);\r\n\r\n            setTimeout(() => {\r\n                btn.runAction(cc.fadeIn(0.3));\r\n            }, fadeInTime * 1000);\r\n        }\r\n\r\n    }\r\n\r\n\r\n}\r\n"]}