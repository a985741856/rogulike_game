{"version":3,"sources":["assets\\scripts\\UI\\UIBackPanel.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import { randomInt } from \"crypto\";\r\nimport { utils } from \"../../common-plugin/Scripts/Utils\";\r\nimport { cocosz } from \"../Framework/CocosZ\";\r\nimport { PanelName } from \"../Framework/Constant\";\r\nimport TweenEffect from \"../Framework/TweenEffect\";\r\nimport UIPage from \"../Framework/UIPage\";\r\nimport list from \"../commonUi/list\"\r\nimport Msg from \"../Framework/Msg\";\r\nimport { type } from \"os\";\r\nimport Constant from \"../Framework/Constant\"\r\n\r\n// @ts-ignore\r\nconst i18n = require('LanguageData');\r\nconst {ccclass , property} = cc._decorator;\r\n\r\ntype goodData = {\r\n    avatar ?: string;\r\n    goodsName ?: string;\r\n    quantity ?: string;\r\n    id ?: number;\r\n    goodsImage ?: string;\r\n    remark ?: string;\r\n}\r\n\r\nexport class loadRes {\r\n    /**  动态加载资源，可以带回调函数 ，返回promise对象\r\n    *  @param url resources文件路径\r\n    * @param type 资源类型\r\n    * @param callback 回调函数\r\n    */\r\n    public static load_res(url:string,callback?: { (value: any): void; (value: any): void; (arg0: any): void; }){\r\n        return new Promise((resolve, reject) => {\r\n            cc.assetManager.loadRemote(url,(err, res:any) => {\r\n                if (err) {\r\n                    reject(err);\r\n                } else {\r\n                    if(callback){\r\n                        callback(res);\r\n                    }\r\n                    resolve(res);\r\n                }\r\n            });\r\n        })\r\n    }\r\n}\r\n\r\n@ccclass\r\nexport default class UIBackPanel extends UIPage {\r\n    private _panel: cc.Node = null;\r\n    private _btnClose: cc.Node = null;\r\n    public _backList : list= null;\r\n    public contentPanal : cc.Node = null;\r\n    public showPanel : cc.Node = null;\r\n    private bg:cc.Node = null;\r\n    private timeInterval = null;\r\n    private data : Array<goodData> = [];\r\n\r\n    constructor () {\r\n        super (PanelName.UIBackPanel);\r\n        this.isValid() && this.onLoad();    \r\n    }\r\n\r\n    protected onLoad(): void {\r\n        var self = this;\r\n        this._panel = this._page.getChildByName(\"Panel\");\r\n        this.bg = this._panel.getChildByName(\"bg\");\r\n        this._backList = this.bg.getChildByName('backScrollView').getComponent('list');\r\n        this.contentPanal = this.bg.getChildByName('backScrollView');\r\n        this.showPanel = this._page.getChildByName('showPanel');\r\n       \r\n        let url: string = Constant.WEB_LINE_TITLE + '/qwk/details/getGameProps/' + Constant.PERSON_TPKKEN //Constant.PERSON_TPKKEN;   //用户id与游戏id目前为1和1\r\n        utils.showLog(\"上报数据, url=\", url);\r\n        utils.commomHttpRequest(url, (ret, jsdata) => {\r\n            if (ret) {\r\n                self.changeDataToPerson(jsdata);\r\n                utils.showLog(\"数据上报成功！\");\r\n                self.updatePanel();\r\n            } else {\r\n                utils.showLog(\"数据上报失败！\");\r\n            }\r\n        });\r\n\r\n        // for(let i = 0 ; i < 1000 ; i++){\r\n        //     this.data.push(this.personData(i));\r\n        // }\r\n        // self.updatePanel();\r\n        \r\n        let btnNames: string[] = [\"BtnClose\"];\r\n        for (let i = 0; i < btnNames.length; i++) {\r\n            let btn: cc.Node = cc.find(btnNames[i], this._panel);\r\n            if (!btn) continue\r\n            btn.on(cc.Node.EventType.TOUCH_END, this._onBtnClickedHandler, this);\r\n\r\n            if (btn.name == \"BtnClose\") {\r\n                this._btnClose = btn;\r\n            }\r\n        }\r\n    }\r\n\r\n    personData (idx:number) {\r\n        let newname = 'good' + idx;\r\n        let goodurl = '';\r\n        let goodNum = parseInt((Math.random() * 100).toString());\r\n        let object = new Object();\r\n        object = {\r\n            goodName : newname,\r\n            avatar : goodurl,\r\n            goodNum : goodNum\r\n        }\r\n\r\n        return object;\r\n    }\r\n\r\n    changeDataToPerson (jsdata) {\r\n        let datajson = JSON.parse(jsdata);\r\n        console.log(datajson);\r\n        this.data = datajson.data;\r\n    }\r\n\r\n    changeItem (data:any,node:cc.Node) {\r\n        let self = this;\r\n        let goodNode : cc.Node = node.getChildByName('goodSp');\r\n        let spr_name = goodNode.getComponent(cc.Sprite);\r\n        console.log(data.goodsImage);\r\n        if(spr_name){\r\n            let headurl = data.goodsImage == \"\" ? \"\" : Constant.WEB_LINE_TITLE + data.goodsImage;\r\n            if(headurl != ''){\r\n                cc.assetManager.loadRemote(headurl,function(err,imageAsset){\r\n                    if (spr_name && spr_name.isValid) {\r\n                        let spriteFram = new cc.SpriteFrame(imageAsset);\r\n                        spr_name.spriteFrame = spriteFram;\r\n                    }\r\n                })\r\n            }else{\r\n                cocosz.resMgr.loadAndCacheRes(\"head/head\" , cc.SpriteFrame, null, (err, res) => {\r\n                    if (spr_name && spr_name.isValid) {\r\n                        spr_name.spriteFrame = res;\r\n                    }\r\n                });\r\n            }\r\n        }\r\n\r\n        var goodLabel = node.getChildByName('goodLabel').getComponent(cc.Label);\r\n        goodLabel.string = data.goodsName;\r\n\r\n        var goodNumLabel = node.getChildByName('goodNum').getComponent(cc.Label);\r\n        goodNumLabel.string = \"x\" + data.quantity;\r\n    }\r\n\r\n    itemRenderEvent (item, idx) {\r\n        this.changeItem(this.data[idx],item);\r\n    }\r\n\r\n    itemSelectEvent (item,idx) {\r\n        console.log(\"点击到了item\"+\":\"+idx);\r\n        let self = this;\r\n        let fromPos = this.showPanel.convertToNodeSpaceAR(item.convertToWorldSpaceAR(cc.Vec2.ZERO));\r\n        console.log(fromPos);\r\n        let openGoods = this.showPanel.getChildByName('openGoods');\r\n        let nameLabel = openGoods.getChildByName('nameLabel');\r\n        nameLabel.getComponent(cc.Label).string = this.data[idx].goodsName;\r\n        let introduceLabel = openGoods.getChildByName('introduceLabel');\r\n        introduceLabel.getComponent(cc.Label).string = this.data[idx].remark;\r\n        if(fromPos.x > 270){\r\n            fromPos.x -= openGoods.width/2 + item.width/2 + 10;\r\n        }else{\r\n            fromPos.x += openGoods.width/2 + item.width/2 + 10;\r\n        }\r\n        openGoods.position = cc.v3(fromPos.x,fromPos.y,0);\r\n        this.showPanel.active = true;\r\n        this.showPanel.targetOff(this.showPanel)\r\n        this.showPanel.on('touchend',function(){\r\n            console.log('关闭了！！！');\r\n            self.showPanel.active = false;\r\n        },this.showPanel);\r\n\r\n        let useBtn = openGoods.getChildByName('useBtn');\r\n        useBtn.targetOff(useBtn)\r\n        if (!useBtn.hasEventListener('click')) {\r\n            useBtn.on(\"touchend\",function() {\r\n                let url: string = Constant.WEB_LINE_TITLE + '/qwk/details/useProps/' + self.data[idx].id //Constant.PERSON_TPKKEN;   //用户id与游戏id目前为1和1\r\n                utils.showLog(\"上报数据, url=\", url);\r\n                utils.commomHttpRequest(url, (ret, jsdata) => {\r\n                    if (ret) {\r\n                        let datajson = JSON.parse(jsdata);\r\n                        console.log(datajson);\r\n                        if(!datajson.data){\r\n                            self.data.splice(idx,1); \r\n                        }else{\r\n                            self.data[idx] = datajson.data;\r\n                        }\r\n                        utils.showLog(\"数据上报成功！\");\r\n                        self.updatePanel();\r\n                    } else {\r\n                        utils.showLog(\"数据上报失败！\");\r\n                    }\r\n                });\r\n                self.showPanel.active = false;\r\n            },useBtn);\r\n        }\r\n    }\r\n\r\n    protected onOpen() {\r\n        // 上报 首页签到\r\n        utils.umaEvent(\"gamegameback\");\r\n        utils.SendEvent(\"页面-背包\");\r\n        this._initPanel();\r\n    }\r\n\r\n    private _initPanel() {\r\n        TweenEffect.panel_open_scale(this._panel);\r\n        this._backList.renderEvent = this.itemRenderEvent.bind(this);\r\n        this._backList.selectedEvent = this.itemSelectEvent.bind(this);\r\n        // this.updatePanel();\r\n    }\r\n\r\n    updatePanel () {\r\n        console.log(this.data);\r\n        this._backList.numItems = this.data.length;\r\n    }\r\n\r\n    protected _onBtnClickedHandler (event : cc.Event , data:any) {\r\n        cocosz.audioMgr.playBtnEffect();\r\n\r\n        switch (event.target.name) {\r\n            case \"BtnClose\": {\r\n                cocosz.uiMgr.closePanel(PanelName.UIBackPanel);\r\n                break;\r\n            }\r\n        }\r\n    }\r\n\r\n    protected onDestroy () {\r\n        clearInterval(this.timeInterval);\r\n    }\r\n}\r\n"]}