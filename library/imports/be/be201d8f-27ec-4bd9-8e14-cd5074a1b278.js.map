{"version":3,"sources":["assets\\scripts\\Game\\player.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import { utils } from \"../../common-plugin/Scripts/Utils\";\r\nimport { cocosz } from \"../Framework/CocosZ\";\r\nimport Constant, { PanelName, ZindexLayer } from \"../Framework/Constant\";\r\nimport Bullet from \"./bullet\";\r\nimport GameDate from \"./gameDate\";\r\nimport { gameMgr } from \"./gameMgr\";\r\nimport Person from \"./person\";\r\nimport { SkillType, upgradeMgr } from \"./UpgradeMgr\";\r\nimport Weapon from \"./weapon\";\r\n// @ts-ignore\r\nconst i18n = require('LanguageData');\r\n\r\nconst { ccclass, property } = cc._decorator;\r\n\r\n@ccclass\r\nexport default class Player extends Person {\r\n    public lucky : number = 0;\r\n\r\n    onLoad() {\r\n        this.isPlayer = true;\r\n        this.id = 1;\r\n        this.lucky = 0;\r\n        gameMgr.playerTs = this;\r\n        if (this.hpSpr) {\r\n            this.hpSpr.color = cc.Color.GREEN;\r\n        }\r\n        if (this.atkBar) {\r\n            this.atkBar.node.children[1].color = cc.Color.YELLOW;\r\n        }\r\n        this.rig = this.node.getComponent(cc.RigidBody);\r\n        if (this.rig) { this.rig.linearDamping = 0.2; }\r\n        this.playerMess = this.node.getChildByName(\"playerMess\");\r\n        this.hpNumNode = this.playerMess.getChildByName(\"hpNum\");\r\n        // 光环\r\n        this.ghAniNode = this.node.getChildByName(\"gh\");\r\n        // 烟尘\r\n        this.ycAniNode = this.node.getChildByName(\"yc\");\r\n        // 相机跟随\r\n        gameMgr.followNode = this.node;\r\n\r\n        // 防止玩家和僵尸碰撞\r\n        if (cocosz.gameMode == 6) {\r\n            if (this.rig && this.rig.isValid) {\r\n                this.rig.enabledContactListener = true;\r\n            }\r\n        }\r\n    }\r\n\r\n    start() {\r\n        super.start();\r\n        this.setProperty();\r\n        this.node.zIndex = ZindexLayer.zindex_player;\r\n        if (this.ghAniNode && this.ghAniNode.isValid) {\r\n            this.ghAniNode.setParent(this.node.parent);\r\n            this.ghAniNode.zIndex = ZindexLayer.zinedx_gh;\r\n            this.updateGhAni();\r\n        }\r\n        if (this.ycAniNode && this.ycAniNode.isValid) {\r\n            this.ycAniNode.setParent(this.node.parent);\r\n            this.ycAniNode.zIndex = ZindexLayer.zinedx_footYc;\r\n            this.updateYcAni();\r\n        }\r\n        // 血条\r\n        if (this.hpSpr) {\r\n            this.hpSpr.color = cc.Color.GREEN;\r\n        }\r\n\r\n    }\r\n\r\n    lateUpdate(dt) {\r\n        this.curTime++;\r\n        if (cocosz.isPause || this.isDeath || gameMgr.isWin || gameMgr.isFail) {\r\n            this.rig.linearVelocity = cc.v2(0, 0);\r\n            return;\r\n        };\r\n        if (this.curTime % 15 == 0) {\r\n            this.updateAni();\r\n            this.creatFootPrint();\r\n        }\r\n        this.updateAtk();\r\n        this.updatePerson();\r\n        this.udpateRBody(this.moveDir);\r\n        this.updateMess();\r\n        this.updateGhAni();\r\n        this.updateYcAni();\r\n        if (this.atkTarget && this.atkTarget.isValid) {\r\n            this.atkEnemy();\r\n        }\r\n    }\r\n\r\n    recoverEffect() {\r\n        let node = cc.instantiate(gameMgr.itemEffect[0]);\r\n        node.parent = this.node;\r\n    }\r\n\r\n    lastTime: number = 0;\r\n    checkTarget() {\r\n        if (Number(new Date()) - this.lastTime < 500) return;\r\n        this.lastTime = Number(new Date());\r\n        let num = this.atkList.indexOf(this.atkTarget);\r\n        if (num >= 0) {\r\n            if (num == this.atkList.length - 1) {\r\n                num = 0;\r\n            }\r\n            else {\r\n                num += 1;\r\n            }\r\n            this.atkTarget = this.atkList[num];\r\n        }\r\n        else {\r\n            this.atkTarget = this.atkList[0];\r\n        }\r\n    }\r\n\r\n    lastAtkTime: number = 0;\r\n    atkBulletNum: number = 1;\r\n    atkEnemy() {\r\n        if (!this.curWeapon || !this.curWeapon.isValid || this.isAtk) return;\r\n\r\n        if (this.curWeapon && this.curWeapon.isRangeWeapon) {\r\n            // 是否有子弹\r\n            if (this.curWeapon._isReload || this.curWeapon.curBullet <= 0) {\r\n                return;\r\n            } else {\r\n                if ((cocosz.gameMode == 6 || cocosz.gameMode == 8) && this.curWeapon.curBullet == 1) {\r\n                    cc.game.emit(Constant.E_GAME_LOGIC, { type: Constant.E_Bullet_Last, node: this.node });\r\n                }\r\n                this.curWeapon.curBullet--;\r\n            }\r\n            // 抖动效果\r\n            let t = (this.atkSpeed > 0.1 ? 0.1 : this.atkSpeed) / 3;\r\n            cc.tween(this.rangedWeapon.children[0])\r\n                .by(t, { x: -20, angle: 20 })\r\n                .by(t, { x: 20, angle: -20 })\r\n                .start();\r\n            // 攻击效果\r\n            let pos = this.startPosNode.getPosition();\r\n            if (this.curWeapon.atkEffect) {\r\n                let effect = cc.instantiate(this.curWeapon.atkEffect);\r\n                if (this.curWeapon.weaponNum == 9 || this.curWeapon.weaponNum == 15) {\r\n                    this.node.parent.addChild(effect, ZindexLayer.zindex_effect_fire, \"effect\");\r\n                    effect.setPosition(this.startPosNode.parent.convertToWorldSpaceAR(pos).sub(cc.v2(cc.winSize.width / 2, cc.winSize.height / 2)));\r\n                    if (this.body.scaleX > 0) {\r\n                        effect.angle = this.rangedWeapon.angle;\r\n                    }\r\n                    else {\r\n                        effect.angle = 180 - this.rangedWeapon.angle;\r\n                    }\r\n                }\r\n                else {\r\n                    this.curWeapon.node.addChild(effect, 1, \"effect\");\r\n                    effect.setPosition(pos);\r\n                }\r\n                // 升级开火特效\r\n                // if (this.curWeapon.can_effect_hit && this.curWeapon && this.curWeapon.weaponLevel > 0) {\r\n                //     let effect_fire = cc.instantiate(gameMgr.effect_fire);\r\n                //     effect_fire.parent = effect.parent;\r\n                //     effect_fire.setPosition(effect.position);\r\n                //     effect_fire.angle = effect.angle;\r\n                //     // 颜色\r\n                //     let arr = [\"\", \"y\", \"p\", \"r\"];\r\n                //     let spAni = effect_fire.children[0].getComponent(sp.Skeleton);\r\n                //     spAni && spAni.setSkin(arr[this.curWeapon.weaponLevel]);\r\n                // }\r\n            }\r\n        }\r\n        else {\r\n            gameMgr.shakeEffect(2, 1, false);//屏幕晃动\r\n            let ani = this.meleeWeapon.getComponent(cc.Animation);\r\n            ani && ani.isValid && ani.play(\"atk_dao\");\r\n            this.scheduleOnce(() => {\r\n                ani && ani.isValid && ani.play(\"daiji_dao\");\r\n            }, 0.18)\r\n        }\r\n        // 生成子弹\r\n        let dir;\r\n        if (this.atkDir && !this.atkDir.equals(cc.Vec2.ZERO)) {\r\n            dir = this.atkDir;\r\n        } else if (this.moveDir && !this.moveDir.equals(cc.Vec2.ZERO)) {\r\n            dir = this.moveDir;\r\n        } else {\r\n            dir = this.body.scaleX > 0 ? cc.Vec2.RIGHT : cc.Vec2.RIGHT.negSelf();\r\n        }\r\n        if (this.atkBulletNum > 1) {\r\n            for (let i = 0; i < this.atkBulletNum; i++) {\r\n                let angle = ((this.atkBulletNum - 1) / 2 - i) * 15;\r\n                let new_dir: cc.Vec2 = dir.rotate(cc.misc.degreesToRadians(angle));\r\n                this.createBullet(new_dir);\r\n            }\r\n        } else {\r\n            this.createBullet(dir);\r\n        }\r\n        // 攻击表情\r\n        let t = this.atkSpeed > 0.1 ? 0.1 : this.atkSpeed;\r\n        cc.tween(this.head_atk)\r\n            .set({ opacity: 255 })\r\n            .delay(t)\r\n            .set({ opacity: 0 })\r\n            .start();\r\n\r\n\r\n        this.isAtk = true;\r\n        if (this.curWeapon.isRangeWeapon && this.curWeapon.curBullet <= 0) {\r\n            cc.tween(this.node)\r\n                .delay(this.curWeapon.reload)\r\n                .call(() => {\r\n                    this.isAtk = false;\r\n                })\r\n                .start();\r\n        } else {\r\n            cc.tween(this.node)\r\n                .delay(this.atkSpeed)\r\n                .call(() => {\r\n                    this.isAtk = false;\r\n                })\r\n                .start();\r\n        }\r\n        // 攻击音效\r\n        let name = Weapon.WeaponName[this.curWeapon.weaponNum - 1];\r\n        if (GameDate.Weapon[name] && GameDate.Weapon[name].music) {\r\n            gameMgr.playEffect(\"shot_\" + GameDate.Weapon[name].music, this.node);\r\n        } else {\r\n            gameMgr.playEffect(`shot_${Weapon.WeaponName[this.curWeapon.weaponNum - 1]}`, this.node);\r\n        }\r\n    }\r\n\r\n    createBullet(dir: cc.Vec2) {\r\n        let bullet = cc.instantiate(this.curWeapon.bullet);\r\n        if (this.curWeapon.isRangeWeapon) {\r\n            bullet.parent = this.node.parent;\r\n            let fromPos = bullet.parent.convertToNodeSpaceAR(this.startPosNode.convertToWorldSpaceAR(cc.Vec2.ZERO));\r\n            bullet.setPosition(fromPos);\r\n            bullet.angle = -cc.v2(dir).signAngle(cc.v2(1, 0)) / Math.PI * 180;\r\n            if (this.curWeapon.weaponNum == 2) {\r\n                bullet.angle += (5 - Math.random() * 10);\r\n            }\r\n            if (this.curWeapon.flySpeed > 0) {\r\n                let pos1 = bullet.getPosition();\r\n                let pos2 = pos1.add(dir.mul(this.curWeapon.atkRangeNum));\r\n                cc.tween(bullet)\r\n                    .to(pos2.sub(pos1).mag() / this.curWeapon.flySpeed, { position: cc.v3(pos2) })\r\n                    .call(() => {\r\n                        let ts = bullet.getComponent(Bullet);\r\n                        if (ts.boomEffect) {\r\n                            let boom = cc.instantiate(ts.boomEffect)\r\n                            boom.parent = ts.node.parent;\r\n                            boom.setPosition(ts.node.getPosition());\r\n                            let curBullet = boom.getComponent(Bullet);\r\n                            curBullet.atk = ts.atk;\r\n                            curBullet.atker = ts.atker;\r\n                            curBullet.id = ts.id;\r\n                            gameMgr.playEffect(\"explo\", boom);\r\n                            if (ts.hitEffect) {\r\n                                let pos = bullet.getPosition();\r\n                                let node = cc.instantiate(ts.hitEffect);\r\n                                node.parent = bullet.parent;\r\n                                node.setPosition(pos);\r\n                                node.zIndex = ZindexLayer.zindex_effect_hit;\r\n                            }\r\n                        }\r\n                        bullet.destroy()\r\n                    })\r\n                    .start();\r\n                // 弹壳\r\n                if (this.curWeapon.shellCall) {\r\n                    let shellCase = cc.instantiate(this.curWeapon.shellCall);\r\n                    shellCase.setParent(gameMgr.map);\r\n                    shellCase.setPosition(this.node.position);\r\n                    shellCase.scaleX = this.body.scale;\r\n                }\r\n            } else {\r\n                cc.tween(bullet).delay(0.4).call(() => {\r\n                    bullet.destroy()\r\n                }).start();\r\n            }\r\n\r\n            let ts = bullet.getComponent(Bullet);\r\n            ts.id = this.id;\r\n            ts.atker = this.node;\r\n            ts.atk = (this.atkNum + this.personAtk) * this.atkRate;\r\n            ts.dir = dir;\r\n        }\r\n        else {\r\n            this.node.addChild(bullet, -1);\r\n            bullet.color = this.curWeapon.bulletCollor;\r\n            if (this.atkDir.x < 0) {\r\n                bullet.scaleX *= -1 / this.node.scaleX;\r\n            }\r\n            else {\r\n                bullet.scaleX /= this.node.scaleX;\r\n            }\r\n            bullet.scaleY /= this.node.scaleY;\r\n            cc.tween(bullet).delay(0.2).call(() => { bullet.destroy() }).start();\r\n\r\n            let ts = bullet.getComponent(Bullet);\r\n            ts.id = this.id;\r\n            ts.atker = this.node;\r\n            ts.atk = (this.atkNum + this.personAtk) * this.atkRate;\r\n            ts.dir = dir;\r\n        }\r\n    }\r\n\r\n    hart(atkNum: number, from: cc.Node, dir: cc.Vec2 = null, isAudio: boolean = true) {\r\n        if (cocosz.isPause || this.isDeath || this.isAvoidInjury) return;\r\n        if ((cocosz.gameMode == 6 || cocosz.gameMode == 8) && upgradeMgr) {\r\n            // 移动过程中15%的概率免伤\r\n            if (upgradeMgr.isHaveSkill(SkillType.护甲靴子) && this.moveDir.mag() > 0 && Math.random() < 0.4) {\r\n                // gameMgr.showRoleTip(this.node, \"闪避\", cc.Color.YELLOW);\r\n                return;\r\n            }\r\n            else if (upgradeMgr.isHaveSkill(SkillType.神圣守护) && upgradeMgr.hudun && upgradeMgr.hudun.active) {\r\n                upgradeMgr.updateHudun();\r\n                // gameMgr.showRoleTip(this.node, \"免伤\", cc.Color.YELLOW);\r\n                return;\r\n            }\r\n        }\r\n        // 防止dir过大\r\n        if (dir && dir.mag() > 3) dir.normalizeSelf().mulSelf(3);\r\n        // 减伤\r\n        atkNum = (1 - this.damageReduction) * atkNum;\r\n        // 护盾\r\n        if (this.Shiled > 0) {\r\n            this.Shiled -= atkNum;\r\n            if (this.Shiled < 0) {\r\n                atkNum = -this.Shiled;\r\n                this.Shiled = 0;\r\n            } else {\r\n                return;\r\n            }\r\n        }\r\n        // 数字\r\n        if (cocosz.gameMode != 6 && cocosz.gameMode != 8) {\r\n            gameMgr.showRoleTip(this.node, Math.min(this.HP, atkNum).toFixed(0));\r\n        }\r\n        this.HP -= atkNum;\r\n        // 受伤音效\r\n        if (isAudio) {\r\n            if (from) {\r\n                let ts = from.getComponent(Person);\r\n                if (ts && ts.curWeapon && ts.curWeapon.isRangeWeapon) {\r\n                    gameMgr.playEffect(\"hurt_range\", this.node);\r\n                } else {\r\n                    gameMgr.playEffect(\"hurt_melee\", this.node);\r\n                }\r\n            } else {\r\n                gameMgr.playEffect(\"hurt\", this.node);\r\n            }\r\n        }\r\n        // 屏幕闪红\r\n        if (cocosz.gameMode == 6 || cocosz.gameMode == 8) {\r\n            cc.tween(gameMgr.red)\r\n                .to(0.5, { opacity: 255 }, { easing: \"sineOut\" })\r\n                .to(0.5, { opacity: 0 }, { easing: \"sineIn\" })\r\n                .start();\r\n        }\r\n        // 震动\r\n        cocosz.vibrate(\"long\");\r\n        if (this.HP <= 0) {\r\n            if (cocosz.gameMode == 6 || cocosz.gameMode == 8) cocosz.audioMgr.playEffect(\"GameOver\");\r\n            this.death();\r\n            if (from) {\r\n                let ts = from.getComponent(Person);\r\n                ts.killNum++;\r\n                ts.curKillNum++;\r\n                // 更新最佳成绩\r\n                if (ts.curKillNum > ts.maxNum) {\r\n                    ts.maxNum = ts.curKillNum;\r\n                }\r\n                this.killer = ts;\r\n                this.curKillNum = 0;\r\n            }\r\n            // 倒飞\r\n            if (dir) {\r\n                let p1 = this.node.getPosition();\r\n                let pTo = p1.add(dir.normalizeSelf().mulSelf(200));\r\n                let p2 = cc.v2((p1.x + pTo.x) / 2, p1.y + 200);\r\n                cc.tween(this.node)\r\n                    .bezierTo(0.3, p1, p2, pTo)\r\n                    .start();\r\n            }\r\n            // 死亡事件\r\n            if (cocosz.gameMode == 6 || cocosz.gameMode == 8) {\r\n                cc.game.emit(Constant.E_GAME_LOGIC, { type: Constant.E_Player_Death })\r\n            }\r\n        } else {\r\n            // 受伤事件\r\n            if (cocosz.gameMode == 6 || cocosz.gameMode == 8) {\r\n                this.avoidInjury(2);\r\n                cc.game.emit(Constant.E_GAME_LOGIC, { type: Constant.E_Player_Hart })\r\n            }\r\n            // 效果\r\n            if (!this.isAttackedEffect) {\r\n                this.isAttackedEffect = true;\r\n                // 后退\r\n                if (this.rig.type == cc.RigidBodyType.Dynamic && dir) {\r\n                    // 控制\r\n                    this.canMove = false;\r\n                    this.scheduleOnce(() => { this.canMove = true; }, 0.1);\r\n                    // 后退\r\n                    let div = dir.mulSelf(400 * dir.mag()).addSelf(this.rig.linearVelocity);\r\n                    if (div.mag() > 500) {\r\n                        div.normalizeSelf().mulSelf(500);\r\n                    }\r\n                    this.rig.linearVelocity = div;\r\n                }\r\n                // 晃头\r\n                cc.tween(this.head)\r\n                    .call(() => { this.head_hart.opacity = 255; })\r\n                    .to(0.05, { angle: 15 })\r\n                    .to(0.05, { angle: -15 })\r\n                    .to(0.05, { angle: 15 })\r\n                    .to(0.05, { angle: 0 })\r\n                    .call(() => { this.head_hart.opacity = 0; })\r\n                    .start();\r\n                // 人物变色\r\n                let spArr = this.body.getComponentsInChildren(cc.Sprite);\r\n                cc.tween(this.body)\r\n                    .call(() => { spArr.forEach((v, i) => { v.isValid && v.setMaterial(0, this.mat_attacked) }) })\r\n                    .delay(0.1)\r\n                    .call(() => { spArr.forEach((v, i) => { v.isValid && v.setMaterial(0, this.mat_common) }) })\r\n                    .delay(0.1)\r\n                    .union()\r\n                    .repeat(cocosz.gameMode == 6 ? 5 : 2)\r\n                    .call(() => { this.isAttackedEffect = false; })\r\n                    .start();\r\n            }\r\n        }\r\n    }\r\n\r\n    creatFootPrint() {\r\n        if (this.node.opacity == 0) return;\r\n        let pos = this.node.getPosition();\r\n        if (pos.sub(this.lastPos).mag() < 5) return;\r\n\r\n        this.lastPos = cc.v2(pos);\r\n        this.footNum++;\r\n        // 脚步音效\r\n        if (this.isPlayer && this.footNum % 3 == 0) {\r\n            gameMgr.playEffect(\"footsteps\", this.node);\r\n        }\r\n        // 脚印(雪地)\r\n        if (gameMgr.map.name == \"map2\") {\r\n            let node = new cc.Node();\r\n            node.addComponent(cc.Sprite).spriteFrame = gameMgr.jiaoyin;\r\n            cc.tween(node).delay(0.5).to(0.5, { opacity: 0 }).call(() => { node.destroy() }).start();\r\n            node.parent = this.node.parent;\r\n            node.zIndex = ZindexLayer.zinedx_footPrint;\r\n            if (this.moveDir.mag() > 0) node.angle = 360 - cc.v2(this.moveDir).signAngle(cc.v2(1, 0)) / Math.PI * 180;\r\n            pos.y -= 100 * this.node.scale;\r\n            let pos2 = cc.v2(20, 0).rotate(node.angle / 180 * Math.PI).rotate(this.footNum % 2 == 0 ? Math.PI / 2 : -Math.PI / 2)\r\n            pos.addSelf(pos2);\r\n            node.setPosition(pos);\r\n        }\r\n    }\r\n\r\n    // 0:检测碰撞；1:检测子弹；2:检测在层级下，3:检测在层级上\r\n    onCollisionEnter(other: cc.Collider, self: cc.Collider) {\r\n        if (self.tag == 0) {\r\n            // 敌人\r\n            if (other.tag == 1) {\r\n                let ts = other.node.getComponent(Person);\r\n                if (ts && ts.id != this.id) {\r\n                    this.atkList.push(other.node);\r\n                    if (!cc.isValid(this.atkTarget) && other.node.isValid) {\r\n                        this.atkTarget = other.node;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    onCollisionExit(other: cc.Collider, self: cc.Collider) {\r\n        if (self.tag == 0) {\r\n            let num = this.atkList.indexOf(other.node)\r\n            if (other.tag == 1 && num >= 0) {\r\n                this.atkList.splice(num, 1);\r\n                if (this.atkList.length == 0) {\r\n                    this.atkTarget = null;\r\n                }\r\n                else {\r\n                    if (!cc.isValid(this.atkTarget) || other.node.uuid == this.atkTarget.uuid) {\r\n                        this.atkTarget = this.atkList[0];\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    // 每次将要处理碰撞体接触逻辑时被调用\r\n    onPreSolve(contact: cc.PhysicsContact, selfCollider: cc.PhysicsCollider, otherCollider: cc.PhysicsCollider) {\r\n        if (otherCollider.node.group == \"zombie\") {\r\n            contact.disabled = true;\r\n        }\r\n    }\r\n}\r\n"]}