{"version":3,"sources":["assets\\scripts\\UI\\UILoadingPage.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;AAAA,8CAAyC;AACzC,kDAA2D;AAC3D,8CAA6C;AAC7C,mEAA8D;AAExD,IAAA,KAAwB,EAAE,CAAC,UAAU,EAAnC,OAAO,aAAA,EAAE,QAAQ,cAAkB,CAAC;AAG5C;IAA2C,iCAAM;IAI7C;QAAA,YACI,kBAAM,mBAAQ,CAAC,aAAa,CAAC,SAEhC;QALO,iBAAW,GAAmB,IAAI,CAAC;QAIvC,KAAI,CAAC,OAAO,EAAE,IAAI,KAAI,CAAC,MAAM,EAAE,CAAC;;IACpC,CAAC;IAES,8BAAM,GAAhB;QACI,OAAO;QACP,IAAI,MAAM,GAAG,EAAE,CAAC,IAAI,CAAC,QAAQ,EAAE,IAAI,CAAC,KAAK,CAAC,CAAC;QAC3C,IAAI,MAAM,EAAE;YACR,IAAI,eAAM,CAAC,WAAW,IAAI,IAAI,IAAI,CAAC,mBAAS,CAAC,QAAQ,IAAI,mBAAS,CAAC,MAAM,IAAI,eAAM,CAAC,OAAO,CAAC,EAAE;gBAC1F,MAAM,CAAC,MAAM,GAAG,IAAI,CAAC;aACxB;iBAAM;gBACH,MAAM,CAAC,MAAM,GAAG,KAAK,CAAC;aACzB;SACJ;QACD,IAAI,CAAC,WAAW,GAAG,EAAE,CAAC,IAAI,CAAC,YAAY,EAAE,IAAI,CAAC,KAAK,CAAC,CAAC,YAAY,CAAC,EAAE,CAAC,WAAW,CAAC,CAAC;IACtF,CAAC;IAES,8BAAM,GAAhB;QAAA,iBAeC;QAdG,EAAE,CAAC,IAAI,CAAC,EAAE,CAAC,kBAAQ,CAAC,YAAY,EAAE,IAAI,CAAC,qBAAqB,EAAE,IAAI,CAAC,CAAC;QACpE,WAAW;QACX,IAAI,CAAC,WAAW,CAAC,QAAQ,GAAG,IAAI,CAAC;QACjC,OAAO;QACP,IAAI,CAAC,GAAG,IAAI,CAAC;QACb,EAAE,CAAC,KAAK,CAAC,IAAI,CAAC,KAAK,CAAC;aACf,KAAK,CAAC,GAAG,CAAC;aACV,IAAI,CAAC;YACF,CAAC,IAAI,IAAI,CAAC;YACV,IAAI,CAAC,GAAG,CAAC,EAAE;gBAAE,KAAI,CAAC,eAAe,CAAC,CAAC,CAAC,CAAC;aAAE;QAC3C,CAAC,CAAC;aACD,KAAK,EAAE;aACP,aAAa,EAAE;aACf,KAAK,EAAE,CAAC;IACjB,CAAC;IAES,+BAAO,GAAjB;QACI,EAAE,CAAC,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,CAAC;IAC5B,CAAC;IAED,6CAAqB,GAArB,UAAsB,KAAU;QAC5B,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC;QACpC,QAAQ,KAAK,CAAC,IAAI,EAAE;YAChB,KAAK,kBAAQ,CAAC,iBAAiB,CAAC,CAAC;gBAC7B,IAAI,CAAC,eAAe,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC;gBACjC,MAAM;aACT;SACJ;IACL,CAAC;IAED,uCAAe,GAAf,UAAgB,GAAW;QACvB,IAAI,GAAG,GAAG,IAAI,CAAC,WAAW,CAAC,QAAQ;YAC/B,IAAI,CAAC,WAAW,CAAC,QAAQ,GAAG,GAAG,CAAC;IACxC,CAAC;IAxDgB,aAAa;QADjC,OAAO;OACa,aAAa,CA0DjC;IAAD,oBAAC;CA1DD,AA0DC,CA1D0C,gBAAM,GA0DhD;kBA1DoB,aAAa","file":"","sourceRoot":"/","sourcesContent":["import UIPage from \"../Framework/UIPage\";\r\nimport Constant, { PageName } from \"../Framework/Constant\";\r\nimport { cocosz } from \"../Framework/CocosZ\";\r\nimport PlatUtils from \"../../common-plugin/Scripts/PlatUtils\";\r\n\r\nconst { ccclass, property } = cc._decorator;\r\n\r\n@ccclass\r\nexport default class UILoadingPage extends UIPage {\r\n\r\n    private _loadingBar: cc.ProgressBar = null;\r\n\r\n    constructor() {\r\n        super(PageName.UILoadingPage);\r\n        this.isValid() && this.onLoad();\r\n    }\r\n\r\n    protected onLoad() {\r\n        // 健康忠告\r\n        let health = cc.find(\"health\", this._page);\r\n        if (health) {\r\n            if (cocosz.curLanguage == \"zh\" && (PlatUtils.IsHuaWei || PlatUtils.IsOPPO || cocosz.isDeBug)) {\r\n                health.active = true;\r\n            } else {\r\n                health.active = false;\r\n            }\r\n        }\r\n        this._loadingBar = cc.find(\"LoadingBar\", this._page).getComponent(cc.ProgressBar);\r\n    }\r\n\r\n    protected onOpen() {\r\n        cc.game.on(Constant.E_GAME_LOGIC, this._onGameMassageHandler, this);\r\n        // 进度默认0.01\r\n        this._loadingBar.progress = 0.01;\r\n        // 最低进度\r\n        let r = 0.01;\r\n        cc.tween(this._page)\r\n            .delay(0.2)\r\n            .call(() => {\r\n                r += 0.01;\r\n                if (r < 1) { this._updateProgress(r); }\r\n            })\r\n            .union()\r\n            .repeatForever()\r\n            .start();\r\n    }\r\n\r\n    protected onClose() {\r\n        cc.game.targetOff(this);\r\n    }\r\n\r\n    _onGameMassageHandler(event: any) {\r\n        this._loadingBar.node.active = true;\r\n        switch (event.type) {\r\n            case Constant.E_UPDATE_PROGRESS: {\r\n                this._updateProgress(event.data);\r\n                break;\r\n            }\r\n        }\r\n    }\r\n\r\n    _updateProgress(pro: number) {\r\n        if (pro > this._loadingBar.progress)\r\n            this._loadingBar.progress = pro;\r\n    }\r\n\r\n}\r\n"]}