{"version":3,"sources":["assets\\common-plugin\\Scripts\\WechatTool.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import PlatUtils from \"./PlatUtils\";\r\nimport { utils } from \"./Utils\";\r\nimport YZ_Constant, { AttributedKey, AttributedType, AttributedValue, BannerLocationToEnum, LevelStatus } from \"./YZ_Constant\";\r\nimport YZ_LocalStorage from \"./YZ_LocalStorage\";\r\n\r\nconst { ccclass, property } = cc._decorator;\r\n\r\nconst ST_ServerUrl: string = \"https://apps.youlesp.com/gss?\";\r\n\r\n/**\r\n * 游戏盒子的请求链接\r\n */\r\nconst GB_ServerUrl: string = \"https://apps.youlesp.com/gbs?\";\r\n\r\n// 默认配置\r\nlet ST_DefaultServerConfig: string = \"\";\r\n// 默认配置\r\nlet GB_DefaultServerConfig: string = \"\";\r\nconst ST_LoadConfigInterval: number = 5000; // 毫秒\r\n\r\n\r\n@ccclass\r\nexport default class WechatTool {\r\n\r\n    /**\r\n     * 服务器配置信息\r\n     */\r\n    _serverConfig: any = null;\r\n    public get ServerConfig() {\r\n        return this._serverConfig;\r\n    }\r\n\r\n    /**\r\n     * 游戏盒子配置信息\r\n     */\r\n    _gameBoxServerConfig: any = null;\r\n    public get gameBoxServerConfig() {\r\n        return this._gameBoxServerConfig;\r\n    }\r\n\r\n    //设备UID\r\n    _uid: string = \"0\";\r\n\r\n    public get uid() {\r\n        if (this._uid != \"0\") return this._uid;\r\n        this._login();\r\n        return \"0\";\r\n    }\r\n\r\n    //服务器返回UID\r\n    _service_uid: string = \"0\";\r\n\r\n    /**\r\n     * 服务器返回UID\r\n     */\r\n    public get serviceId() {\r\n        if (this._service_uid != \"0\") return this._service_uid;\r\n        this._login();\r\n        return \"0\";\r\n    }\r\n\r\n    _sysInfo: any = null;\r\n    public get SysInfo() {\r\n        return this._sysInfo;\r\n    }\r\n\r\n\r\n    _shareCallback: Function = null;\r\n    _isShare: boolean = false;\r\n\r\n    _lastUpdateTime: number = 0;\r\n\r\n    _appIdList: string[] = [];\r\n\r\n    _jumpIds: string = \"\";\r\n\r\n    //启动来源的场景：\r\n    _luanchType: string = \"\";\r\n\r\n    clue_token: string = \"\" //字节token\r\n\r\n    wx_code: string = \"\" //登录后返回的code\r\n\r\n    //来源APPID\r\n    _source_app_id: string = \"\";\r\n\r\n    //启动参数\r\n    _luanchData: string = \"\";\r\n\r\n    /**\r\n     * \r\n     * @param data 配置数据\r\n     */\r\n    public init(data: string) {\r\n\r\n\r\n        if (PlatUtils.IsWechat) {\r\n            //@ts-ignore\r\n            try {\r\n                //@ts-ignore\r\n                this._sysInfo = wx.getSystemInfoSync()\r\n                utils.showLog(\"微信小游戏平台信息: \" + JSON.stringify(this.SysInfo));\r\n            } catch (e) {\r\n                // Do something when catch error\r\n            }\r\n\r\n            try {\r\n                this._luanchData = YZ_LocalStorage.getItem(YZ_Constant.ST_LUANCH_DATA);\r\n                this._luanchType = YZ_LocalStorage.getItem(YZ_Constant.ST_LUANCH_TYPE);\r\n                //@ts-ignore\r\n                let options = wx.getLaunchOptionsSync()\r\n                options && utils.showLog(\">>获取到小程序启动参数：\" + JSON.stringify(options));\r\n\r\n                if (this._luanchData && this._luanchType) {\r\n                    utils.showLog(\"获取到本地缓存数据启动类型：\" + this._luanchType);\r\n                    utils.showLog(\"获取到本地缓存数据启动参数：\" + this._luanchData);\r\n                } else {\r\n                    if (options) {\r\n                        if (options.scene) {\r\n                            utils.showLog(\"获取到启动场景值：\" + options.scene);\r\n                            this._luanchType = options.scene;\r\n                            YZ_LocalStorage.setItem(YZ_Constant.ST_LUANCH_TYPE, this._luanchType);\r\n                        }\r\n\r\n                        if (options.query) {\r\n                            let queryData = JSON.stringify(options.query);\r\n                            this._luanchData = queryData;\r\n                            YZ_LocalStorage.setItem(YZ_Constant.ST_LUANCH_DATA, this._luanchData);\r\n                            utils.showLog(\"获取到小程序启动参数：\" + queryData);\r\n                        }\r\n\r\n                        if (options.referrerInfo && JSON.stringify(options.referrerInfo) != \"{}\") {\r\n                            utils.showLog(\"获取到小程序来源信息：\" + JSON.stringify(options.referrerInfo));\r\n                            if (options.referrerInfo.appId) {\r\n                                utils.showLog(\"获取到小程序启动来源的appId：\" + options.referrerInfo.appId);\r\n                                this._source_app_id = options.referrerInfo.appId;\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            } catch (erro) {\r\n                utils.showLog(\"获取到小程序启动参数异常\");\r\n            }\r\n\r\n            if (data) {\r\n                let configObj: any = JSON.parse(data);\r\n                if (configObj && configObj.wechat) {\r\n                    ST_DefaultServerConfig = JSON.stringify(configObj.wechat);\r\n                }\r\n                if (configObj && configObj.gamebox) {\r\n                    GB_DefaultServerConfig = JSON.stringify(configObj.gamebox);\r\n                }\r\n            }\r\n\r\n            // 拉取服务器配置\r\n            // this.loadJumpIds().then(() => {\r\n            //     console.log(\"本地跳转ID加载成功！\");\r\n            //     this._loadConfig();\r\n            // }).catch((erro) => {\r\n            //     console.error(\"本地跳转ID加载失败：\", erro);\r\n            this._loadConfig();\r\n            // })\r\n\r\n            //加载配置的跳转ID\r\n            // this.loadAppIdList();\r\n            // 开启右上角转发\r\n            //@ts-ignore\r\n            wx.showShareMenu();\r\n            //@ts-ignore\r\n            wx.onShareAppMessage(this._getShareInfo.bind(this));\r\n            //@ts-ignore\r\n            wx.onShow((res) => {\r\n                cc.log(\"OnShow\");\r\n                if (this._isShare) {\r\n                    this._isShare = false;\r\n                    if (this._shareCallback) {\r\n                        this._shareCallback(true, \"分享成功!\");\r\n                    }\r\n                }\r\n\r\n                this._checkForUpdate();\r\n\r\n                utils.emitCommonEvent(YZ_Constant.EC_OnShow);\r\n            });\r\n            //@ts-ignore\r\n            wx.onHide(() => {\r\n                cc.log(\"onHide\");\r\n                utils.emitCommonEvent(YZ_Constant.EC_OnHide);\r\n            });\r\n\r\n            this._checkForUpdate();\r\n        }\r\n    }\r\n\r\n    _checkForUpdate() {\r\n        if (PlatUtils.IsWechat) {\r\n            if ((new Date()).getTime() - this._lastUpdateTime < ST_LoadConfigInterval) {\r\n                cc.log(\"检查更新太频繁!\");\r\n                return;\r\n            }\r\n            this._lastUpdateTime = (new Date()).getTime();\r\n\r\n            if (this.isOverMinVersion(\"1.9.90\")) {\r\n                cc.log(\"检查更新......\");\r\n                //@ts-ignore\r\n                const updateManager = wx.getUpdateManager();\r\n\r\n                updateManager.onCheckForUpdate((res) => {\r\n                    // 请求完新版本信息的回调\r\n                    if (res.hasUpdate) {\r\n                        cc.log(\"有新版本需要更新!\");\r\n                    } else {\r\n                        cc.log(\"没有新版本！\");\r\n                    }\r\n                });\r\n\r\n                updateManager.onUpdateReady(() => {\r\n                    //@ts-ignore\r\n                    wx.showModal({\r\n                        title: '更新提示',\r\n                        content: '新版本已经准备好，是否重启应用？',\r\n                        success(res) {\r\n                            if (res.confirm) {\r\n                                // 新的版本已经下载好，调用 applyUpdate 应用新版本并重启\r\n                                updateManager.applyUpdate();\r\n                            }\r\n                        }\r\n                    });\r\n                });\r\n\r\n                updateManager.onUpdateFailed(() => {\r\n                    // 新版本下载失败\r\n                    cc.log(\"新版本下载失败！\");\r\n                });\r\n            }\r\n        }\r\n    }\r\n\r\n    _buildServerUrl() {\r\n        let url: string = \"\";\r\n        if (utils.config.wechatconfig && utils.config.wechatconfig.appID) {\r\n            let appid: string = utils.config.wechatconfig.appID;\r\n            let channel: string = \"wechat\";\r\n            let jumpId: string = this._jumpIds ? this._jumpIds : utils.config.wechatconfig.jumpId;\r\n            url = ST_ServerUrl + `kyx=true&app_id=${appid}&channel=${channel}&jump_id=${jumpId}`;\r\n        } else {\r\n            cc.log(\"微信 APPID配置出错！\");\r\n        }\r\n\r\n        return url;\r\n    }\r\n\r\n    _buildGameBoxServerUrl() {\r\n        let url: string = GB_ServerUrl + `m=ghome&index=0&type=1`;\r\n        return url;\r\n    }\r\n\r\n    _loadConfig() {\r\n        if (PlatUtils.IsWechat) {\r\n            cc.log(\"加载服务器配置.......\");\r\n            let method: string = \"m=g\";\r\n            let url: string = ST_ServerUrl + method\r\n            // let jumpId: string = this._jumpIds ? this._jumpIds : utils.config.wechatconfig.jumpId;\r\n            // url += `&jump_id=${jumpId}`\r\n            utils.commomHttpRequest(url, (ret, data) => {\r\n                if (ret) {\r\n                    cc.log(\"微信服务器配置数据获取成功: data = \", data);\r\n                    if (data) {\r\n                        let result = JSON.parse(data);\r\n                        if (result) {\r\n                            if (!utils.DebugLoacalConfig) {\r\n                                this._serverConfig = result;\r\n                            } else {\r\n                                cc.warn(\"开启了本地数据测试，使用本地配置!\");\r\n                            }\r\n                        } else {\r\n                            cc.log(\"微信服务器配置数据不是合法的JSON数据, 使用本地配置!\");\r\n                        }\r\n                    }\r\n                } else {\r\n                    cc.log(\"微信服务器配置数据获取失败, 使用本地配置!\");\r\n                }\r\n\r\n                if (!this._serverConfig) {\r\n                    this._serverConfig = JSON.parse(ST_DefaultServerConfig);\r\n                } else {\r\n                    if (this._serverConfig.shares && this._serverConfig.shares.sy_title) {\r\n                        utils.config.otherconfig.shareTitle = this._serverConfig.shares.sy_title;\r\n                    }\r\n                    if (this._serverConfig.shares && this._serverConfig.shares.sy_img) {\r\n                        utils.config.otherconfig.shareImgUrl = this._serverConfig.shares.sy_img;\r\n                    }\r\n\r\n                    if (this._serverConfig.is_local_pos_id == \"false\") {\r\n                        // 使用服务器下发的广告id\r\n                        cc.log(\"使用服务器下发的广告ID\");\r\n                        utils.config.wechatconfig.insertId = this.ServerConfig.intersititia_pos_id || utils.config.wechatconfig.insertId;\r\n                        utils.config.wechatconfig.videoId = this.ServerConfig.video_pos_id || utils.config.wechatconfig.videoId;\r\n                        utils.config.wechatconfig.boxId = this._serverConfig.box_pos_id || utils.config.wechatconfig.boxId;\r\n                        utils.config.wechatconfig.bannerBoxId = this._serverConfig.banner_box_pos_id || utils.config.wechatconfig.bannerBoxId;\r\n                        utils.config.wechatconfig.nativeBannerId = this._serverConfig.native_banner_pos_id || utils.config.wechatconfig.nativeBannerId;\r\n                        utils.config.wechatconfig.nativeInsertIds = this._serverConfig.native_intersititial_pos_id || utils.config.wechatconfig.nativeInsertIds;\r\n\r\n                        let bannerLocation: string[] = [\"home\", \"game\", \"level\", \"skin\", \"pause\", \"over\"];\r\n                        for (let i = 0; i < bannerLocation.length; i++) {\r\n                            if (this.ServerConfig.banner_pos_id[bannerLocation[i]]) {\r\n                                utils.config.wechatconfig.setBannerId(BannerLocationToEnum(bannerLocation[i]), this.ServerConfig.banner_pos_id[bannerLocation[i]]);\r\n                            }\r\n                        }\r\n\r\n                        if (this.ServerConfig.native_customad_configs) {\r\n                            for (let i = 0; i < this.ServerConfig.native_customad_configs.length; i++) {\r\n                                utils.showLog(\"获取到原生模版广告配置:\" + this.ServerConfig.native_customad_configs[i].location, \">>>>\", JSON.stringify(this.ServerConfig.native_customad_configs[i]));\r\n                                utils.config.wechatconfig.setCustomAdInfo(this.ServerConfig.native_customad_configs[i].location, this.ServerConfig.native_customad_configs[i]);\r\n                            }\r\n                        }\r\n\r\n\r\n\r\n                    } else {\r\n                        cc.log(\"使用本地配置的广告ID\");\r\n                    }\r\n                }\r\n\r\n                utils.emitServerInitEvent();\r\n                if (this._serverConfig && this._serverConfig.openBox) {\r\n                    if (this._serverConfig.openBox != \"true\") {\r\n                        cc.log(\"服务器游戏盒子配置为关闭状态！\");\r\n                        return;\r\n                    }\r\n                    url = this._buildGameBoxServerUrl();\r\n                    utils.commomHttpRequest(url, (ret, data) => {\r\n                        if (ret) {\r\n                            cc.log(\"微信游戏盒子服务器配置数据获取成功: data = \", data);\r\n                            if (data) {\r\n                                let result = JSON.parse(data);\r\n                                if (result) {\r\n                                    if (!utils.DebugLoacalConfig) {\r\n                                        this._gameBoxServerConfig = result;\r\n                                    } else {\r\n                                        cc.warn(\"开启了本地数据测试，使用本地配置!\");\r\n                                    }\r\n                                } else {\r\n                                    cc.log(\"微信游戏盒子微信服务器配置数据不是合法的JSON数据, 使用本地配置!\");\r\n                                }\r\n                            }\r\n                        } else {\r\n                            cc.log(\"微信游戏盒子服务器配置数据获取失败, 使用本地配置!\");\r\n                        }\r\n\r\n                        if (!this._gameBoxServerConfig) {\r\n                            this._gameBoxServerConfig = JSON.parse(GB_DefaultServerConfig);\r\n                        }\r\n                    });\r\n                }\r\n            });\r\n\r\n\r\n\r\n        }\r\n    }\r\n\r\n    /**\r\n     * \r\n     * @param id 跳转ID\r\n     * @param callback 跳转回调\r\n     */\r\n    public navigateToMiniProgram(id: string, callback: Function, path?: string) {\r\n        if (PlatUtils.IsWechat) {\r\n            let completeCallback: Function = callback;\r\n            //@ts-ignore\r\n            wx.navigateToMiniProgram({\r\n                appId: id.indexOf(\":\") > -1 ? id.split(\":\")[0] : id,\r\n                path: path ? path : \"\",\r\n                success(res) {\r\n                    if (completeCallback) {\r\n                        completeCallback(true);\r\n                    }\r\n                },\r\n                fail(res) {\r\n                    // cc.log(\"跳转失败！\", id);\r\n                    cc.log(`跳转失败! id=${id}; res=${JSON.stringify(res)}`);\r\n                    if (completeCallback) {\r\n                        completeCallback(false);\r\n                    }\r\n                }\r\n            });\r\n        }\r\n    }\r\n\r\n    public getSystemInfo() {\r\n        if (PlatUtils.IsWechat) {\r\n            //@ts-ignore\r\n            return wx.getSystemInfoSync();\r\n        }\r\n    }\r\n\r\n    public previewImage(url: string) {\r\n        if (PlatUtils.IsWechat) {\r\n            //@ts-ignore\r\n            wx.previewImage({\r\n                urls: [url] // 需要预览的图片http链接列表\r\n            });\r\n        }\r\n    }\r\n\r\n    public share(callback: Function = null) {\r\n        if (PlatUtils.IsWechat) {\r\n            this._shareCallback = callback;\r\n            this._isShare = true;\r\n            //@ts-ignore\r\n            wx.shareAppMessage(this._getShareInfo());\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 上报数据\r\n     */\r\n    public postData(otherGameAppId: string) {\r\n        if (PlatUtils.IsWechat) {\r\n            let method = \"m=rjump\";\r\n            let url: string = ST_ServerUrl + method + `&jump_app_id=${otherGameAppId}`;\r\n            cc.log(\"上报数据, url=\", url);\r\n            utils.commomHttpRequest(url, function (ret, data) {\r\n                if (ret) {\r\n                    cc.log(\"数据上报成功！\");\r\n                } else {\r\n                    cc.log(\"数据上报失败！\");\r\n                }\r\n            });\r\n        }\r\n    }\r\n\r\n    /**\r\n    * 上报互推组件数据\r\n    * @param otherGameAppId 跳转的ID\r\n    * @param location 当前位置\r\n    * @param status 0:点击，1:跳转成功\r\n    */\r\n    public postDataByLocation(otherGameAppId: string, location: string, status: number = 0) {\r\n        if (PlatUtils.IsWechat) {\r\n            let method = \"m=rjump\";\r\n            let url: string = ST_ServerUrl + method + `&jump_app_id=${otherGameAppId}&location=${location}&status=${status}`\r\n            utils.commomHttpRequest(url, function (ret, data) {\r\n                if (ret) {\r\n                    cc.log(\"数据上报成功！\");\r\n                } else {\r\n                    cc.log(\"数据上报失败！\");\r\n                }\r\n            });\r\n        }\r\n    }\r\n\r\n    /**\r\n    * 上报互推组件显示位置\r\n    * @param otherGameAppId 跳转的ID\r\n    * @param location 当前位置\r\n    * @param status 0:点击，1:跳转成功\r\n    */\r\n    public postRecommentShowData(location: string) {\r\n        if (PlatUtils.IsWechat) {\r\n            let method = \"m=rjumpshow\";\r\n            let url: string = ST_ServerUrl + method + `&location=${location}`;\r\n            utils.commomHttpRequest(url, function (ret, data) {\r\n                if (ret) {\r\n                    cc.log(\"数据上报成功！\");\r\n                } else {\r\n                    cc.log(\"数据上报失败！\");\r\n                }\r\n            }.bind(this));\r\n        }\r\n    }\r\n\r\n    _getShareInfo() {\r\n        if (PlatUtils.IsWechat) {\r\n            return {\r\n                title: utils.config.otherconfig.shareTitle,\r\n                imageUrl: utils.config.otherconfig.shareImgUrl\r\n            };\r\n        }\r\n\r\n        return {};\r\n    }\r\n\r\n    public isOverMinVersion(minVersion: string) {\r\n        //@ts-ignore\r\n        let curVersion: string = wx.getSystemInfoSync().SDKVersion;\r\n        return this._compareVersion(curVersion, minVersion) >= 0\r\n    }\r\n\r\n\r\n    _compareVersion(v1, v2) {\r\n        v1 = v1.split('.')\r\n        v2 = v2.split('.')\r\n        const len = Math.max(v1.length, v2.length)\r\n\r\n        while (v1.length < len) {\r\n            v1.push('0')\r\n        }\r\n        while (v2.length < len) {\r\n            v2.push('0')\r\n        }\r\n\r\n        for (let i = 0; i < len; i++) {\r\n            const num1 = parseInt(v1[i])\r\n            const num2 = parseInt(v2[i])\r\n\r\n            if (num1 > num2) {\r\n                return 1\r\n            } else if (num1 < num2) {\r\n                return -1\r\n            }\r\n        }\r\n\r\n        return 0\r\n    }\r\n\r\n    /**\r\n     * 获取交叉推广数据\r\n     */\r\n    public getRecommondGameList() {\r\n        if (PlatUtils.IsWechat && utils.wechatTool && utils.wechatTool.ServerConfig) {\r\n            return utils.wechatTool.ServerConfig.jump_list;\r\n        }\r\n\r\n        return null;\r\n    }\r\n\r\n\r\n    // /**\r\n    //  * 加载游戏配置的跳转ID\r\n    //  */\r\n    // loadAppIdList() {\r\n    //     CompatibleTool.LoadResRes(\"./src/game.json\", (err, res) => {\r\n    //         if (err) {\r\n    //             cc.error('加载game.json文件出错', err);\r\n    //             return;\r\n    //         }\r\n    //         if (res && res.navigateToMiniProgramAppIdList && res.navigateToMiniProgramAppIdList.length) {\r\n    //             let taskQty = res.subpackages.length;\r\n    //             for (let i = 0; i < taskQty; i++) {\r\n    //                 this._appIdList.push(res.navigateToMiniProgramAppIdList[i].name);\r\n    //             }\r\n    //             cc.log(\"配置的跳转ID：\", this._appIdList);\r\n    //         }\r\n    //     });\r\n    // }\r\n\r\n\r\n    /**\r\n     * 验证ID 是否配置\r\n     * @param appId 应用ID\r\n     */\r\n    checkAppId(appId: string) {\r\n\r\n        if (utils.config.wechatconfig.jumpId.indexOf(appId) > -1) {\r\n            return true;\r\n        }\r\n        cc.log(\"appId :\", appId, \"不再配置列表中!\");\r\n        return false;\r\n    }\r\n\r\n\r\n    _loginTime: number = 0;\r\n    _loginInterval: number = 30;\r\n\r\n\r\n    _login() {\r\n\r\n        let curTime: number = new Date().getTime();\r\n        let interval: number = (curTime - this._loginTime) / 1000;\r\n        if (interval > 0 && interval < this._loginInterval) {\r\n            utils.showLog(`登录请求间隔小于：${this._loginInterval}秒`);\r\n            return;\r\n        }\r\n        this._loginTime = curTime;\r\n        let self = this;\r\n\r\n        this._uid = YZ_LocalStorage.getItem(YZ_Constant.ST_UID);\r\n        this._uid = this._uid ? this._uid : \"0\";\r\n\r\n        this._service_uid = YZ_LocalStorage.getItem(YZ_Constant.ST_SERVICE_UID);\r\n        this._service_uid = this._service_uid ? this._service_uid : \"0\";\r\n        utils.showLog(\"获取本地保存的uid=\" + this._uid + \"，服务器UID=\" + this._service_uid);\r\n\r\n        if (this._uid == \"0\") {\r\n            //@ts-ignore\r\n            wx.login({\r\n                success(res) {\r\n                    if (res.code) {\r\n                        self.wx_code = res.code;\r\n                        self.reportLogin(res.code);\r\n                    } else {\r\n                        utils.showLog('登录失败！' + res.errMsg)\r\n                    }\r\n                },\r\n                fail() {\r\n\r\n                },\r\n                complete() {\r\n                    self.reportLogin();\r\n                }\r\n            })\r\n        }\r\n\r\n    }\r\n    _reportLoginTime: number = 0;\r\n    _reportLoginInterval: number = 30;\r\n    isReport: boolean = false;\r\n\r\n    isReportActive: boolean = false;\r\n    /**\r\n     * 上报登录接口获取UID\r\n     */\r\n    async reportLogin(code: string = \"\") {\r\n        if (this.isReport) return;\r\n        this.isReport = true;\r\n\r\n        let self = this;\r\n        let curTime: number = new Date().getTime();\r\n        let interval: number = (curTime - this._reportLoginTime) / 1000;\r\n        if (interval > 0 && interval < this._reportLoginInterval) {\r\n            utils.showLog(`上报登录获取UID小于：${this._reportLoginInterval}秒`);\r\n            return;\r\n        }\r\n        this._reportLoginTime = curTime;\r\n        let method = \"m=login\";\r\n        let url: string = ST_ServerUrl + method + `&device_data=${encodeURI(JSON.stringify(this._sysInfo))}&code=${code}`;\r\n\r\n        utils.commomHttpRequest(url, (ret, data) => {\r\n            if (ret) {\r\n                if (data) {\r\n                    utils.showLog(\"#data=\" + data);\r\n\r\n                    let result = JSON.parse(data);\r\n                    if (result.uid) {\r\n                        self._service_uid = \"\" + result.uid;\r\n\r\n                        if (!self.isReportActive) {\r\n                            self.isReportActive = true;\r\n                            this.reportAttributedEvent(AttributedType.Active, AttributedKey.Active, AttributedValue.Active);\r\n                        }\r\n                        YZ_LocalStorage.setItem(YZ_Constant.ST_SERVICE_UID, self._service_uid);\r\n                    }\r\n                    if (result.device_uid) {\r\n                        self._uid = \"\" + result.device_uid;\r\n                        YZ_LocalStorage.setItem(YZ_Constant.ST_UID, self._uid);\r\n                    }\r\n                    utils.showLog(\"服务器请求登录成功! _service_uid=\" + self._service_uid + \" #device_id=\" + self._uid);\r\n\r\n                }\r\n            }\r\n            this.isReport = false;\r\n        })\r\n    }\r\n\r\n\r\n    passCount: number = 0; //通关数据\r\n    playCount: number = 0; //开始关卡数据\r\n    /**\r\n     * 上报关卡数据\r\n     * @param level 当前关卡ID\r\n     * @param levelName 关卡名称\r\n     * @param status 状态\r\n     */\r\n    public postLevel(level: string, status: LevelStatus, levelName?: string) {\r\n        if (PlatUtils.IsWechat) {\r\n\r\n            if (status == LevelStatus.GameWin) {\r\n                this.passCount++;\r\n                if (this.passCount === utils.getConfigByKey(\"pass_level_count_active\")) {\r\n                    this.reportAttributedEvent(AttributedType.GameAddiction, AttributedKey.GameAddiction, AttributedValue.PassLevelCountAction);\r\n                }\r\n            } else if (status === LevelStatus.GameStart) {\r\n                this.playCount++;\r\n                if (this.playCount == utils.getConfigByKey(\"play_level_count_active\")) {\r\n                    this.reportAttributedEvent(AttributedType.GameAddiction, AttributedKey.GameAddiction, AttributedValue.PlayLevelCountAction);\r\n                }\r\n            }\r\n\r\n\r\n            let method = \"m=rlevel\";\r\n            let url: string = ST_ServerUrl + method + `&level_id=${level}&level_name=${encodeURI(levelName)}&status=${status}`;\r\n            utils.commomHttpRequest(url, function (ret, data) {\r\n                if (ret) {\r\n                    utils.showLog(\"关卡数据上报成功！\");\r\n                } else {\r\n                    utils.showLog(\"关卡数据上报失败！\");\r\n                }\r\n            }.bind(this));\r\n        }\r\n    }\r\n\r\n\r\n    /**\r\n   * 上报自定义事件\r\n   * @param level 当前关卡ID\r\n   * @param levelName 关卡名称\r\n   * @param status 状态\r\n   */\r\n    public sendEvent(eventName: string) {\r\n        if (PlatUtils.IsWechat) {\r\n            let method = \"m=revent\";\r\n            let url: string = ST_ServerUrl + method + `&event=${encodeURI(eventName)}`;\r\n            utils.commomHttpRequest(url, function (ret, data) {\r\n                if (ret) {\r\n                    utils.showLog(\"上报自定义事件成功！\");\r\n                } else {\r\n                    utils.showLog(\"上报自定义事件失败！\");\r\n                }\r\n            }.bind(this));\r\n        }\r\n    }\r\n\r\n    /**\r\n      * 弹出提示框\r\n      * @param msg 消息\r\n      */\r\n    public showToast(msg: string) {\r\n        if (PlatUtils.IsWechat) {\r\n            //@ts-ignore\r\n            wx.showToast({\r\n                title: msg,\r\n                icon: \"none\",\r\n                duration: 2000,\r\n                success(res) {\r\n                    console.log(`${res}`);\r\n                },\r\n                fail(res) {\r\n                    console.log(`showToast调用失败`);\r\n                }\r\n            });\r\n        }\r\n    }\r\n\r\n\r\n    /**\r\n     * 上报归因事件\r\n     * @param eventType 事件类型 0 激活， 25:关键行为\r\n     * @param eventValue 事件描述\r\n     */\r\n    public reportAttributedEvent(eventType: AttributedType, eventKey: AttributedKey, eventValue: AttributedValue) {\r\n        if (this._luanchType != \"1069\" && this._luanchType != \"1036\" && this._luanchType != \"1065\") {\r\n            utils.showLog(\"luanchType=\" + this._luanchType + \",不进行归因上报\");\r\n            return;\r\n        }\r\n        utils.showLog(\"上报归因事件：  #eventType=\" + eventType + \"#eventKey=\" + eventKey + \"#eventValue=\" + eventValue);\r\n        if (eventType == AttributedType.Active && YZ_LocalStorage.getItem(YZ_Constant.ST_IS_REPORT_USER_ACTIVE)) {\r\n            utils.showLog(\"用户已经上报过激活，不再进行激活上报！\");\r\n            return;\r\n        } else if (eventType == AttributedType.GameAddiction && YZ_LocalStorage.getItem(YZ_Constant.ST_IS_REPORT_GAME_ADDICTION)) {\r\n            utils.showLog(\"用户已经上报过关键行为，不再进行激活上报！\");\r\n            return;\r\n        }\r\n        let xhr = new XMLHttpRequest();\r\n        xhr.timeout = 15000;    // 单位毫秒\r\n        let data: any = {};\r\n        data.app_id = utils.config.wechatconfig.appID;\r\n        data.channel = \"wechat_kyx\";\r\n        data.uid = this._service_uid;\r\n        data.event_type = eventType;\r\n        data.event_key = eventKey;\r\n        data.event_value = eventValue;\r\n        data.app_version = utils.config.wechatconfig.version;\r\n        data.code = this.wx_code;\r\n        // data.clue_token = this.clue_token;\r\n        data.luanchDate = encodeURI(this._luanchData);\r\n\r\n        utils.showLog(\"归因请求参数:\" + JSON.stringify(data));\r\n        let requestData = JSON.stringify(data);\r\n        utils.showLog(\"归因 > json_data=\" + utils.aesEncrypt(requestData));\r\n        let requestUrl: string = `https://track.youletd.com/wechatcounterpart/dockingreturn?json=${utils.aesEncrypt(requestData)}&time_stamp=${(new Date()).getTime()}`;\r\n        utils.showLog(\"归因服务器地址:\" + requestUrl);\r\n\r\n        xhr.open('GET', requestUrl);\r\n        xhr.send();\r\n        xhr.onreadystatechange = function () {\r\n            utils.showLog(\"请求状态改变, reaedyState=\", xhr.readyState, \"; status=\", xhr.status);\r\n            if (xhr.readyState == 4) {\r\n                if (xhr.status == 200) {\r\n                    if (eventType == AttributedType.Active) YZ_LocalStorage.setItem(YZ_Constant.ST_IS_REPORT_USER_ACTIVE, \"true\");\r\n                    if (eventType == AttributedType.GameAddiction) YZ_LocalStorage.setItem(YZ_Constant.ST_IS_REPORT_GAME_ADDICTION, \"true\");\r\n                    utils.showLog(\"归因上报成功：\", xhr.responseText);\r\n                } else {\r\n                    utils.showLog(\"归因上报失败！\");\r\n                }\r\n            }\r\n        }\r\n        xhr.ontimeout = function () {\r\n            utils.showLog(\"归因请求超时!\");\r\n        }\r\n        xhr.onerror = function (err) {\r\n            utils.showLog(\"归因请求失败!\");\r\n        }\r\n    }\r\n\r\n\r\n    /**\r\n       * 友盟游戏开始上报\r\n       * @param levelID \r\n       */\r\n    public umaOnStart(levelID: string) {\r\n        if (!this.checkUmeng()) return;\r\n        //@ts-ignore\r\n        wx.uma.stage.onStart({\r\n            stageId: levelID,//该字段名称不可修改，必传\r\n            stageName: `第${levelID}关`// 关卡id\r\n        })\r\n    }\r\n\r\n    /**\r\n     * \r\n     * @returns 是否开启友盟 \r\n     */\r\n    private checkUmeng(): boolean {\r\n        //@ts-ignore\r\n        if (!wx.uma) {\r\n            utils.showLog(\"未对接友盟SDK\");\r\n            return false;\r\n        }\r\n        return true;\r\n    }\r\n    /**\r\n     * 友盟结算上报\r\n     * @param levelID 关卡id\r\n     * @param stageId \r\n     * @param event \r\n     */\r\n    public umaReportedLevel(levelID: string, event: LevelStatus) {\r\n        if (!this.checkUmeng()) return;\r\n\r\n        //@ts-ignore\r\n        wx.uma.stage.onEnd({\r\n            stageId: levelID,//该字段名称不可修改，必传\r\n            stageName: `第${levelID}关`,\r\n            event: event\r\n        })\r\n    }\r\n\r\n\r\n    /**\r\n     * 友盟自定义事件\r\n     * @param eventId 事件ID，注意：事件ID必须要在后台配置\r\n     * @param params 事件内容\r\n     */\r\n    public umaTrackEvent(eventId: string, params?) {\r\n        if (!this.checkUmeng()) return;\r\n        //@ts-ignore\r\n        wx.uma.trackEvent(eventId, params);\r\n    }\r\n\r\n\r\n\r\n}\r\n"]}