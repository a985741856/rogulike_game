{"version":3,"sources":["assets\\common-plugin\\Scripts\\VerticalRecommentPanel.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import { utils } from \"./Utils\";\r\nimport RecommendGamesNode from \"./RecommendGamesNode\";\r\nimport { SubLocation } from \"./YZ_Constant\";\r\nimport PlatUtils from \"./PlatUtils\";\r\nimport GameItem from \"./GameItem\";\r\nimport CompatibleTool from \"./CompatibleTool\";\r\n\r\nconst { ccclass, property } = cc._decorator;\r\n\r\n@ccclass\r\nexport default class VerticalRecommentPanel extends cc.Component {\r\n\r\n    _recommendNode: cc.Node = null;\r\n    _isInit: boolean = false;\r\n    _gameList: Array<GameItem> = [];\r\n    _data: any = null;\r\n\r\n    onLoad() {\r\n        this._recommendNode = cc.find(\"Panel/RecommendGamesNode\", this.node);\r\n        this._recommendNode.active = false;\r\n\r\n        for (let i = 0; i < this._recommendNode.childrenCount; i++) {\r\n            let gameItem: GameItem = this._recommendNode.children[i].getComponent(\"GameItem\");\r\n            this._gameList.push(gameItem);\r\n        }\r\n    }\r\n\r\n    onEnable() {\r\n        utils.registerServerInitEvent(() => {\r\n            this._initWidget();\r\n        }, this);\r\n    }\r\n\r\n    onDisable() {\r\n        utils.unregisterServerInitEvent(this);\r\n    }\r\n\r\n    _initWidget() {\r\n        if (this._isInit) return;\r\n\r\n        let valid: boolean = true;\r\n        if (utils.isVerticalRecommentPanel()) {\r\n            if (PlatUtils.IsDouyin) {\r\n                if (!utils.Tool_Douyin.isShowMoreGamesModal()) {\r\n                    this.node.destroy();\r\n                }\r\n            }\r\n            this._data = utils.getRecommondGameList();\r\n            if (this.node.parent.getComponentsInChildren(VerticalRecommentPanel).length > 1) {\r\n                var temp = []\r\n                for (var i = this._data.length - 1; i >= 0; i--) {\r\n                    temp.push(this._data[i]);\r\n                }\r\n                this._data = temp;\r\n            }\r\n\r\n            if (this._data) {\r\n                if (this._data.length > 0) {\r\n                    this._isInit = true;\r\n                    this._initData();\r\n                    this._recommendNode.active = true;\r\n                    this.schedule(this._initData, 3)\r\n                } else {\r\n                    console.warn(\"交叉推广数据长度为0\");\r\n                    valid = false;\r\n                }\r\n            } else {\r\n                console.warn(\"交叉推广数据为null!\");\r\n                valid = false;\r\n            }\r\n        }\r\n\r\n        if (!valid) {\r\n            this.node.destroy();\r\n        }\r\n    }\r\n\r\n\r\n    _curIndex: number = 0;\r\n    _initData() {\r\n        this._gameList.forEach(gameItem => {\r\n            if (this._curIndex > this._data.length - 1) {\r\n                this._curIndex = 0;\r\n            }\r\n            gameItem.init(this._data[this._curIndex], SubLocation.isVerticalPanel);\r\n            let duration = 0.03;\r\n            if (CompatibleTool.engineVersion >= 220) {\r\n                // let action = cc.repeat(cc.sequence(cc.rotateTo(duration, 85), cc.rotateTo(duration, 90), cc.rotateTo(duration, 95), cc.rotateTo(duration, 90)), 5);\r\n                // gameItem.node.runAction(action);\r\n                //@ts-ignore\r\n                cc.tween(gameItem.node)\r\n                    //@ts-ignore\r\n                    .repeat(5, cc.tween()\r\n                        .to(duration, { angle: 85 })\r\n                        .to(duration, { angle: 90 })\r\n                        .to(duration, { angle: 95 })\r\n                        .to(duration, { angle: 90 })\r\n                    )\r\n                    .start();\r\n            } else {\r\n                let action = cc.repeat(cc.sequence(cc.rotateTo(duration, -85), cc.rotateTo(duration, -90), cc.rotateTo(duration, -95), cc.rotateTo(duration, -90)), 5);\r\n                gameItem.node.runAction(action);\r\n            }\r\n            this._curIndex++;\r\n        });\r\n    }\r\n}\r\n"]}