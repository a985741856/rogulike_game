{"version":3,"sources":["assets\\scripts\\UI\\UIRevivePanel.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import UIPage from \"../Framework/UIPage\";\r\nimport Msg from \"../Framework/Msg\";\r\nimport { PanelName } from \"../Framework/Constant\";\r\nimport { cocosz } from \"../Framework/CocosZ\";\r\nimport { utils } from \"../../common-plugin/Scripts/Utils\";\r\nimport { gameMgr } from \"../Game/gameMgr\";\r\nimport PlatUtils from \"../../common-plugin/Scripts/PlatUtils\";\r\n// @ts-ignore\r\nconst i18n = require('LanguageData');\r\n\r\nconst { ccclass, property } = cc._decorator;\r\n\r\n@ccclass\r\nexport default class UIRevivePanel extends UIPage {\r\n\r\n\r\n    private _mask: cc.Node = null;\r\n    private _panel: cc.Node = null;\r\n    private _timeLabel: cc.Label = null;\r\n    private _proIcon: cc.Sprite = null;\r\n\r\n    private _btnVideo: cc.Node = null;\r\n    private _btnPass: cc.Node = null;\r\n\r\n    constructor() {\r\n        super(PanelName.UIRevivePanel);\r\n        this.isValid() && this.onLoad();\r\n    }\r\n\r\n    protected onLoad() {\r\n        this._mask = this._page.getChildByName(\"Mask\");\r\n\r\n        this._panel = this._page.getChildByName(\"Panel\");\r\n        this._timeLabel = this._panel.getChildByName(\"time\").getComponent(cc.Label);\r\n        this._proIcon = this._panel.getChildByName(\"shangquan\").getComponent(cc.Sprite);\r\n\r\n        this._btnVideo = this._panel.getChildByName(\"BtnVideo\");\r\n        this._btnVideo.on(cc.Node.EventType.TOUCH_END, this._onBtnClickedHandler, this);\r\n        this._btnPass = this._panel.getChildByName(\"BtnPass\");\r\n        this._btnPass.on(cc.Node.EventType.TOUCH_END, this._onBtnClickedHandler, this);\r\n    }\r\n\r\n    protected onOpen() {\r\n        utils.SendEvent(\"页面-复活\");\r\n        this.showAd();\r\n        this._initPanel();\r\n        cocosz.pauseCount++;\r\n    }\r\n\r\n    protected onClose(): void {\r\n        cocosz.pauseCount--;\r\n\r\n    }\r\n\r\n    showAd() { }\r\n\r\n    _tw1: cc.Tween = null;\r\n    _tw2: cc.Tween = null;\r\n    private _initPanel() {\r\n        let opacityBack = this._mask.opacity;\r\n        this._mask.opacity = 0;\r\n        cc.tween(this._mask).to(0.2, { opacity: opacityBack }).start();\r\n        this._panel.scale = 0;\r\n        cc.tween(this._panel)\r\n            .to(0.3, { scale: 1 }, { easing: \"backOut\" })\r\n            .start();\r\n\r\n        let count = 9;\r\n        this._tw1 = cc.tween(this._timeLabel)\r\n            .delay(1)\r\n            .call(() => {\r\n                this._timeLabel.string = (--count).toString();\r\n            })\r\n            .union()\r\n            .repeat(9)\r\n            .call(() => {\r\n                cocosz.uiMgr.closePanel(PanelName.UIRevivePanel);\r\n                gameMgr.fail();\r\n            })\r\n            .start();\r\n\r\n        this._tw2 = cc.tween(this._proIcon)\r\n            .to(9, { fillRange: 0 })\r\n            .start();\r\n    }\r\n\r\n    stopTween() {\r\n        if (cocosz.gameMode == 6 || cocosz.gameMode == 8) {\r\n            this._tw1 && this._tw1.stop();\r\n            this._tw2 && this._tw2.stop();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 所有按钮点击事件\r\n     * @param event \r\n     * @param data \r\n     */\r\n    private async _onBtnClickedHandler(event: cc.Event, data: any) {\r\n        cocosz.audioMgr.playBtnEffect();\r\n        this.stopTween();\r\n        switch (event.target.name) {\r\n            case \"BtnVideo\": {\r\n                utils.umaEvent(\"gamefuhuo\");\r\n                // 分享\r\n                if (this._btnVideo.getChildByName(\"share\") && this._btnVideo.getChildByName(\"share\").active) {\r\n                    utils.SendEvent(\"分享-复活\");\r\n                    cocosz.share(() => {\r\n                        utils.SendEvent(\"分享-复活-成功\")\r\n                        this._reLive();\r\n                    }, () => {\r\n                        utils.SendEvent(\"分享-复活-失败\")\r\n                        cocosz.uiMgr.closePanel(PanelName.UIRevivePanel);\r\n                        gameMgr.fail();\r\n                    })\r\n                }\r\n                // 视频\r\n                else if (this._btnVideo.getChildByName(\"video\") && this._btnVideo.getChildByName(\"video\").active) {\r\n                    utils.SendEvent(\"视频-复活-播放\");\r\n                    cocosz.watchAD(() => {\r\n                        utils.SendEvent(\"视频-复活-成功\")\r\n                        this._reLive();\r\n                    }, () => {\r\n                        utils.SendEvent(\"视频-复活-失败\")\r\n                        cocosz.uiMgr.closePanel(PanelName.UIRevivePanel);\r\n                        gameMgr.fail();\r\n                    });\r\n                }\r\n                // 失败\r\n                else {\r\n                    cocosz.uiMgr.closePanel(PanelName.UIRevivePanel);\r\n                    gameMgr.fail();\r\n                }\r\n                break;\r\n            }\r\n            case \"BtnPass\": {\r\n                utils.umaEvent(\"gamesurr\");\r\n                cocosz.uiMgr.closePanel(PanelName.UIRevivePanel);\r\n                gameMgr.fail();\r\n                break;\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 复活事件 \r\n     */\r\n    private _reLive() {\r\n        Msg.Show(i18n.t(\"msg.fhcg\"));//复活成功\r\n        cocosz.uiMgr.closePanel(PanelName.UIRevivePanel);\r\n        gameMgr.revive();\r\n    }\r\n\r\n}\r\n"]}