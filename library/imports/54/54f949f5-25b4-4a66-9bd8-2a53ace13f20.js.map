{"version":3,"sources":["assets\\common-plugin\\Scripts\\RewardShortCutPanel.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import { utils } from \"./Utils\";\r\nimport { YZ_Reward, BannerLocation } from \"./YZ_Constant\";\r\nimport PlatUtils from \"./PlatUtils\";\r\n\r\nconst { ccclass, property } = cc._decorator;\r\n\r\n/**\r\n * 分享录屏面板\r\n */\r\n@ccclass\r\nexport default class RewardShortCutPanel extends cc.Component {\r\n\r\n    bg: cc.Node = null;\r\n    btnOk: cc.Node = null;\r\n    btnCancel: cc.Node = null;\r\n    glodNode: cc.Node = null;\r\n    glodLabel: cc.Label = null;\r\n\r\n    /**\r\n     * 奖励回调\r\n     */\r\n    rewardCallFunc: Function = null;\r\n\r\n    /**\r\n     * 奖励值\r\n     */\r\n    rewardValue: number = 0;\r\n\r\n    _showBanner: boolean = false;\r\n\r\n\r\n    onLoad() {\r\n\r\n\r\n        utils.SendEvent(\"结算前广告-创建快捷桌面-展示成功！\");\r\n\r\n        let shortcutCreated = false;\r\n        if (PlatUtils.IsOPPO) {\r\n            shortcutCreated = utils.oppoTool._shortcutCreated;\r\n        } else if (PlatUtils.IsVIVO) {\r\n            shortcutCreated = utils.Tool_Vivo._shortcutCreated;\r\n        }\r\n\r\n        if (shortcutCreated) {\r\n            utils.showLog(\"已经存在桌面快捷方式，当前窗口直接销毁！\");\r\n            utils.SendEvent(\"结算前广告-创建快捷桌面-已经存在桌面快捷方式！\");\r\n            this.node.destroy();\r\n            return;\r\n        }\r\n        // cc.log(`utils.ServerConfig.auto_desktop>${utils.ServerConfig.auto_desktop === 0},${utils.ServerConfig.auto_desktop == 0}<`);\r\n        if (utils.ServerConfig.auto_desktop != undefined && utils.ServerConfig.auto_desktop === 0) {\r\n            utils.showLog(\"服务器配置直接创建桌面，不显示弹窗，当前窗口直接销毁！\");\r\n            utils.SendEvent(\"结算前广告-创建快捷桌面-服务器配置直接创建桌面，不显示弹窗！\");\r\n            utils.cur_tool && utils.cur_tool.createShortcut && utils.cur_tool.createShortcut((res) => {\r\n                utils.SendEvent(\"结算前广告-直接创建快捷桌面-创建成功！\");\r\n            })\r\n            this.node.destroy();\r\n            return;\r\n        }\r\n        this.rewardValue = utils.rewardValue;\r\n        this.rewardCallFunc = utils.rewardCallFunc;\r\n\r\n        this.initUi();\r\n        this.initListener();\r\n\r\n        if (cc.winSize.height < cc.winSize.width) {\r\n            utils.adManager.HideBanner(BannerLocation.Game);\r\n        } else {\r\n            this._showBanner = true;\r\n            utils.adManager.ShowBanner(BannerLocation.Game);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 初始化UI\r\n     */\r\n    protected initUi(): void {\r\n        if (utils.otherConfig && utils.otherConfig.group) {\r\n            this.node.group = utils.otherConfig.group;\r\n        }\r\n        this.bg = this.node.getChildByName(\"Panel\").children[0];\r\n\r\n        this.btnCancel = this.bg.getChildByName(\"btnClose\");\r\n        this.btnOk = this.bg.getChildByName(\"btnOk\");\r\n        this.glodNode = this.bg.getChildByName(\"rewardLabel\");\r\n        this.glodLabel = this.glodNode.getComponent(cc.Label);\r\n\r\n\r\n        this.glodLabel.string = \"奖励+\" + this.rewardValue;\r\n        if (this.rewardValue == 0) {\r\n            this.glodNode.active = false;\r\n        }\r\n        utils.showSkipBtn(this.btnCancel);\r\n    }\r\n\r\n\r\n\r\n    onDestroy() {\r\n        this._showBanner && utils.adManager.HideBanner(BannerLocation.Game)\r\n        if (utils.rewardShortCutPanelCloseFunc) {\r\n            utils.rewardShortCutPanelCloseFunc();\r\n            utils.rewardShortCutPanelCloseFunc = null;;\r\n        } else {\r\n            utils.rewardCloseFunc && utils.rewardCloseFunc();\r\n            utils.rewardCloseFunc = null;\r\n        }\r\n\r\n        utils.cur_tool && utils.cur_tool.checkHasShortCut && utils.cur_tool.checkHasShortCut()\r\n\r\n    }\r\n\r\n    onClose() {\r\n        this.bg.runAction(cc.sequence(cc.scaleTo(0.3, 0).easing(cc.easeBackIn()), cc.callFunc(() => {\r\n            this.node.destroy();\r\n        })));\r\n    }\r\n\r\n    onEnable() {\r\n        this.bg.scale = 0;\r\n        let ratio: number = 1;\r\n        if (cc.winSize.height < cc.winSize.width) {\r\n            // 横屏游戏\r\n            ratio = cc.winSize.width / 1920 * 0.6;\r\n        } else {\r\n            ratio = cc.winSize.width / 1080;\r\n        }\r\n        this.bg.runAction(cc.sequence(cc.scaleTo(0.3, ratio).easing(cc.easeBackOut()), cc.callFunc(() => {\r\n            this.btnOk.runAction(cc.sequence(\r\n                cc.scaleTo(0.5, 1.15),\r\n                cc.scaleTo(0.5, 1)\r\n            ).repeatForever());\r\n        })));\r\n    }\r\n\r\n\r\n    protected onCreateShortCut() {\r\n        if (PlatUtils.IsOPPO) {\r\n\r\n            utils.oppoTool.createShortcut((res) => {\r\n                utils.SendEvent(\"结算前广告-创建快捷桌面-创建成功！\");\r\n                this.rewardFunc(res)\r\n            })\r\n        } else if (PlatUtils.IsVIVO) {\r\n            utils.Tool_Vivo.createShortcut((res) => {\r\n                utils.SendEvent(\"结算前广告-创建快捷桌面-创建成功！\");\r\n                this.rewardFunc(res)\r\n            })\r\n        }\r\n    }\r\n\r\n\r\n\r\n\r\n    /**\r\n     * 初始化监听事件\r\n     */\r\n    protected initListener(): void {\r\n\r\n    }\r\n\r\n\r\n    /**\r\n     * 分享回调\r\n     * @param ret \r\n     * @param msg \r\n     */\r\n    rewardFunc(ret) {\r\n        if (ret) {\r\n            let result: YZ_Reward = new YZ_Reward();\r\n            result.rewardValue = this.rewardValue;\r\n            utils.showMsg(\"添加成功！奖励：+\" + this.rewardValue);\r\n            if (this.rewardCallFunc) {\r\n                this.rewardCallFunc(result);\r\n            }\r\n            this.onClose();\r\n        } else {\r\n            utils.showMsg(\"添加失败！\");\r\n            this.onClose();\r\n        }\r\n    }\r\n\r\n\r\n    /**\r\n     * 初始化数据\r\n     */\r\n    protected initData(): void {\r\n\r\n    }\r\n\r\n    // update (dt) {}\r\n}\r\n"]}