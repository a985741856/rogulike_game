{"version":3,"sources":["assets\\common-plugin\\Scripts\\YZ_GameExitDialog.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import { utils } from \"./Utils\";\r\nimport QCrossWidgetItem from \"./QCrossWidgetItem\";\r\nimport { SubLocation } from \"./YZ_Constant\";\r\n\r\nconst { ccclass, property } = cc._decorator;\r\n\r\n@ccclass\r\nexport default class YZ_GameExitDialog extends cc.Component {\r\n\r\n    private _jumpList: any = null;\r\n    private _items: QCrossWidgetItem[] = [];\r\n\r\n\r\n    _pageView: cc.PageView = null;\r\n    _pageItem: cc.Node = null;\r\n    _pageRecItem: cc.Node = null;\r\n    _btnCanel: cc.Node = null;\r\n    _btnOk: cc.Node = null;\r\n    _panel: cc.Node = null;\r\n    public nativeData: any = null;\r\n    _nativeIsShow: boolean = false;\r\n\r\n\r\n\r\n    onLoad() {\r\n        this._panel = this.node.getChildByName(\"Panel\");\r\n        this._pageView = this._panel.getChildByName(\"PageView\").getComponent(cc.PageView);\r\n        this._pageItem = this._pageView.content.getChildByName(\"Panel\");\r\n        this._pageRecItem = this._pageItem.children[0];\r\n        this._pageView.content.removeAllChildren();\r\n\r\n        this._btnCanel = this._panel.getChildByName(\"btnCancel\");\r\n        this._btnOk = this._panel.getChildByName(\"btnOk\");\r\n\r\n        if (utils.otherConfig && utils.otherConfig.group) {\r\n            this.node.group = utils.otherConfig.group;\r\n        }\r\n        let ratio: number = 1;\r\n        if (cc.winSize.height < cc.winSize.width) {\r\n            // 横屏游戏\r\n            ratio = cc.winSize.width / 1920 * 0.7;\r\n        } else {\r\n            ratio = cc.winSize.width / 1080;\r\n        }\r\n\r\n        this._panel.scale = ratio;\r\n\r\n    }\r\n\r\n    start() {\r\n        this._jumpList = utils.getRecommondGameList();\r\n        if (this._jumpList && this._jumpList.length > 0) {\r\n            this._initWidget();\r\n        }\r\n\r\n    }\r\n\r\n    hideLastNode() {\r\n        for (let i = 5; i > 2; i--) {\r\n            this._items[i].node.active = false;\r\n        }\r\n    }\r\n\r\n    onBtnCanelHandler(event: cc.Event, data: any) {\r\n        utils.showLog(\"点击取消按钮！\");\r\n        this.node.destroy();\r\n    }\r\n\r\n    onBtnOkHandler(event: cc.Event, data: any) {\r\n        utils.showLog(\"点击确定按钮！\");\r\n        utils.Tool_Native.GameExit();\r\n    }\r\n\r\n    private _initWidget() {\r\n\r\n        \r\n        utils.postRecommentShowData(SubLocation.isGameExitDialog);\r\n\r\n\r\n        let totalPage: number = Math.floor(this._jumpList.length / 6);\r\n        // utils.showLog(`qcrosswidget >>> totalPage = ${totalPage}`);\r\n        utils.showLog(`qcrosswidget >>> totalPage = ${totalPage}`);\r\n        let indx: number = 0;\r\n        for (let i = 0; i < totalPage; i++) {\r\n            let page = cc.instantiate(this._pageItem);\r\n            page.removeAllChildren();\r\n            this._pageView.addPage(page);\r\n            for (let j = 0; j < 6; j++) {\r\n                if (!this._jumpList[indx]) break;\r\n                let tempNode = cc.instantiate(this._pageRecItem);\r\n                page.addChild(tempNode);\r\n\r\n                let qcrossWidgetItem: QCrossWidgetItem = tempNode.getComponent(\"QCrossWidgetItem\");\r\n                qcrossWidgetItem._location = SubLocation.isStatement;\r\n                let data = this._jumpList[indx];\r\n                tempNode.getComponent(\"QCrossWidgetItem\").init(data);\r\n                indx++;\r\n            }\r\n        }\r\n\r\n        this.autoRefrshPageView();\r\n        // let idx: number = 0;\r\n        // for (let i = 0; i < this._jumpList.length; i++) {\r\n        //     let data: any = this._jumpList[i];\r\n        //     if (data && data.logo) {\r\n        //         let itemIdx: number = idx;\r\n        //         if (itemIdx >= this._items.length) {\r\n        //             return;\r\n        //         }\r\n        //         idx++;\r\n        //         this._items[itemIdx].init(data);\r\n        //     }\r\n        // }\r\n    }\r\n\r\n    autoRefrshPageView() {\r\n        this.unscheduleAllCallbacks();\r\n        // utils.showLog(\">>>>>>> autoRefrshPageView\");\r\n\r\n        let interval = 3;\r\n        if (utils.ServerConfig && utils.ServerConfig.statement_auto_refresh) {\r\n            interval = utils.ServerConfig.statement_auto_refresh;\r\n        }\r\n\r\n        utils.showLog(`退出弹窗组件${interval}秒自动刷新`);\r\n        this.schedule(() => {\r\n            let count = this._pageView.getPages().length;\r\n            let index = this._pageView.getCurrentPageIndex();\r\n            index = ((index < count) && (index + 1 !== count)) ? (index + 1) : 0;\r\n            if (index == 0) {\r\n                this._pageView.scrollToPage(index, 0);\r\n            } else {\r\n                this._pageView.scrollToPage(index, 2);\r\n            }\r\n        }, interval); //10秒一换\r\n    }\r\n}\r\n"]}