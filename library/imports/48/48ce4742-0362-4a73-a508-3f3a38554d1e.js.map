{"version":3,"sources":["assets\\common-plugin\\Scripts\\YzRealNameAuthPanel.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;AAAA,iCAAgC;AAG1B,IAAA,KAAwB,EAAE,CAAC,UAAU,EAAnC,OAAO,aAAA,EAAE,QAAQ,cAAkB,CAAC;AAG5C;IAAiD,uCAAY;IAA7D;QAAA,qEAyKC;QAtKG,oBAAc,GAAe,IAAI,CAAC;QAClC,kBAAY,GAAe,IAAI,CAAC;QAChC,uBAAiB,GAAY,IAAI,CAAC;QAClC,aAAO,GAAY,IAAI,CAAC;QACxB,eAAS,GAAY,IAAI,CAAC;QAC1B,mBAAa,GAAY,IAAI,CAAC;QAC9B,kBAAY,GAAY,IAAI,CAAC;QAC7B,wBAAkB,GAAG,IAAI,CAAC;QAE1B,gBAAU,GAAY,KAAK,CAAC;QAC5B,gCAA0B,GAAW,IAAI,CAAC;QA4E1C,aAAO,GAAG,wBAAwB,CAAC;QACnC,aAAO,GAAG,0CAA0C,CAAC;QAGrD,gBAAU,GAAW,CAAC,CAAC;;IA4E3B,CAAC;IA1JG,oCAAM,GAAN;QACI,IAAI,aAAK,CAAC,WAAW,IAAI,aAAK,CAAC,WAAW,CAAC,KAAK,EAAE;YAC9C,IAAI,CAAC,IAAI,CAAC,KAAK,GAAG,aAAK,CAAC,WAAW,CAAC,KAAK,CAAC;SAC7C;QACD,IAAI,KAAK,GAAG,CAAC,CAAC;QACd,IAAI,EAAE,CAAC,OAAO,CAAC,MAAM,GAAG,EAAE,CAAC,OAAO,CAAC,KAAK,EAAE;YACtC,IAAI,CAAC,iBAAiB,GAAG,EAAE,CAAC,IAAI,CAAC,kCAAkC,EAAE,IAAI,CAAC,IAAI,CAAC,CAAA;YAC/E,OAAO;YACP,KAAK,GAAG,EAAE,CAAC,OAAO,CAAC,KAAK,GAAG,IAAI,GAAG,IAAI,CAAC;SAC1C;aAAM;YACH,IAAI,CAAC,iBAAiB,GAAG,EAAE,CAAC,IAAI,CAAC,yBAAyB,EAAE,IAAI,CAAC,IAAI,CAAC,CAAA;YACtE,KAAK,GAAG,EAAE,CAAC,OAAO,CAAC,KAAK,GAAG,IAAI,CAAC;SACnC;QAGD,IAAI,CAAC,SAAS,GAAG,EAAE,CAAC,IAAI,CAAC,iBAAiB,EAAE,IAAI,CAAC,IAAI,CAAC,CAAC;QACvD,IAAI,CAAC,aAAa,GAAG,EAAE,CAAC,IAAI,CAAC,qBAAqB,EAAE,IAAI,CAAC,IAAI,CAAC,CAAC;QAC/D,IAAI,CAAC,YAAY,GAAG,EAAE,CAAC,IAAI,CAAC,oBAAoB,EAAE,IAAI,CAAC,IAAI,CAAC,CAAC;QAE7D,IAAI,CAAC,YAAY,GAAG,IAAI,CAAC,iBAAiB,CAAC,cAAc,CAAC,YAAY,CAAC,CAAC,YAAY,CAAC,EAAE,CAAC,OAAO,CAAC,CAAC;QACjG,IAAI,CAAC,cAAc,GAAG,IAAI,CAAC,iBAAiB,CAAC,cAAc,CAAC,cAAc,CAAC,CAAC,YAAY,CAAC,EAAE,CAAC,OAAO,CAAC,CAAC;QACrG,IAAI,CAAC,OAAO,GAAG,EAAE,CAAC,IAAI,CAAC,eAAe,EAAE,IAAI,CAAC,IAAI,CAAC,CAAC;QACnD,IAAI,CAAC,kBAAkB,GAAG,IAAI,CAAC,cAAc,CAAC,SAAS,CAAC;QACxD,IAAI,IAAI,CAAC,kBAAkB,IAAI,IAAI,EAAE;YACjC,IAAI,CAAC,kBAAkB,GAAG,IAAI,EAAE,CAAC,KAAK,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,EAAE,CAAC,CAAC;SACvD;QACD,EAAE,CAAC,IAAI,CAAC,OAAO,EAAE,IAAI,CAAC,IAAI,CAAC,CAAC,KAAK,GAAG,KAAK,CAAC;QAE1C,IAAI,IAAI,CAAC,UAAU,EAAE;YACjB,IAAI,CAAC,aAAa,EAAE,CAAC;SACxB;aAAM;YACH,IAAI,CAAC,iBAAiB,CAAC,MAAM,GAAG,IAAI,CAAC;SACxC;IACL,CAAC;IAED,mCAAK,GAAL;QACI,8CAA8C;QAC1C,mDAAmD;QACvD,IAAI;IACR,CAAC;IAED,uCAAS,GAAT;QACI,aAAK,CAAC,0BAA0B,EAAE,CAAC;IACvC,CAAC;IAGD,oDAAsB,GAAtB;QACI,aAAK,CAAC,OAAO,CAAC,OAAO,CAAC,CAAC;QACvB,aAAK,CAAC,QAAQ,EAAE,CAAC;IACrB,CAAC;IAGD,wDAA0B,GAA1B;QACI,IAAI,CAAC,aAAa,CAAC,MAAM,GAAG,KAAK,CAAC;QAClC,IAAI,CAAC,SAAS,CAAC,MAAM,GAAG,KAAK,CAAC;QAC9B,IAAI,CAAC,iBAAiB,CAAC,MAAM,GAAG,IAAI,CAAC;IACzC,CAAC;IAGD,2CAAa,GAAb;QACI,IAAI,CAAC,aAAa,CAAC,MAAM,GAAG,KAAK,CAAC;QAClC,IAAI,CAAC,iBAAiB,CAAC,MAAM,GAAG,KAAK,CAAC;QACtC,IAAI,CAAC,YAAY,CAAC,MAAM,GAAG,KAAK,CAAC;QACjC,IAAI,CAAC,SAAS,CAAC,MAAM,GAAG,IAAI,CAAC;IACjC,CAAC;IAGD,2CAAa,GAAb;QACI,IAAI,CAAC,aAAa,CAAC,MAAM,GAAG,KAAK,CAAC;QAClC,IAAI,CAAC,SAAS,CAAC,MAAM,GAAG,KAAK,CAAC;QAC9B,IAAI,CAAC,iBAAiB,CAAC,MAAM,GAAG,KAAK,CAAC;QACtC,IAAI,CAAC,YAAY,CAAC,MAAM,GAAG,IAAI,CAAC;IACpC,CAAC;IAQD,oDAAsB,GAAtB;QAAA,iBA4DC;QA3DG,IAAI,OAAO,GAAG,IAAI,IAAI,EAAE,CAAC,OAAO,EAAE,CAAC;QACnC,IAAI,CAAC,OAAO,GAAG,IAAI,CAAC,UAAU,CAAC,GAAG,IAAI,GAAG,CAAC,EAAE;YACxC,IAAI,CAAC,OAAO,CAAC,SAAS,CAAC,CAAC;YACxB,OAAO;SACV;QAED,IAAI,CAAC,UAAU,GAAG,OAAO,CAAC;QAC1B,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,IAAI,CAAC,cAAc,CAAC,MAAM,CAAC,EAAE;YAChD,IAAI,CAAC,OAAO,CAAC,WAAW,CAAC,CAAC;YAC1B,IAAI,CAAC,cAAc,CAAC,SAAS,GAAG,EAAE,CAAC,KAAK,CAAC,GAAG,CAAC;YAC7C,IAAI,CAAC,cAAc,CAAC,QAAQ,EAAE,CAAC;YAC/B,OAAO,KAAK,CAAC;SAChB;QACD,IAAI,CAAC,cAAc,CAAC,SAAS,GAAG,IAAI,CAAC,kBAAkB,CAAC;QACxD,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,IAAI,CAAC,YAAY,CAAC,MAAM,CAAC,EAAE;YAC9C,IAAI,CAAC,YAAY,CAAC,SAAS,GAAG,EAAE,CAAC,KAAK,CAAC,GAAG,CAAC;YAC3C,IAAI,CAAC,OAAO,CAAC,WAAW,CAAC,CAAC;YAC1B,IAAI,CAAC,YAAY,CAAC,QAAQ,EAAE,CAAC;YAC7B,OAAO,KAAK,CAAC;SAChB;QACD,IAAI,CAAC,YAAY,CAAC,SAAS,GAAG,IAAI,CAAC,kBAAkB,CAAC;QAEtD,aAAK,CAAC,YAAY,CAAC,IAAI,CAAC,YAAY,CAAC,MAAM,EAAE,IAAI,CAAC,cAAc,CAAC,MAAM,EAAE,UAAC,GAAG,EAAE,MAAM;YACjF,aAAK,CAAC,OAAO,CAAC,iBAAiB,GAAG,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC,CAAC,CAAC;YAC1D,IAAI,GAAG,EAAE;gBACL,IAAI,MAAM,EAAE;oBACR,IAAI,KAAG,GAAG,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,CAAC;oBAC7B,QAAQ,KAAG,CAAC,IAAI,EAAE;wBACd,KAAK,CAAC;4BACF,KAAI,CAAC,OAAO,CAAC,KAAG,CAAC,GAAG,CAAC,CAAA;4BACrB,MAAM;wBACV,KAAK,CAAC;4BACF,IAAI,KAAG,CAAC,MAAM,IAAI,GAAG,EAAE;gCACnB,aAAK,CAAC,wBAAwB,CAAC,GAAG,CAAC,CAAA;6BACtC;iCAAM;gCACH,aAAK,CAAC,wBAAwB,CAAC,GAAG,CAAC,CAAA;6BACtC;4BACD,aAAK,CAAC,eAAe,GAAG,IAAI,CAAC;4BAC7B,IAAI,KAAG,CAAC,GAAG,EAAE;gCACT,KAAI,CAAC,OAAO,CAAC,KAAG,CAAC,GAAG,CAAC,CAAC;6BACzB;4BACD,KAAI,CAAC,YAAY,CAAC;gCACd,KAAI,CAAC,IAAI,CAAC,OAAO,EAAE,CAAC;4BACxB,CAAC,EAAE,GAAG,CAAC,CAAC;4BACR,MAAM;wBACV,KAAK,CAAC;4BACF,aAAK,CAAC,wBAAwB,CAAC,GAAG,CAAC,CAAA;4BACnC,KAAI,CAAC,aAAa,EAAE,CAAC;4BACrB,MAAM;qBACb;iBACJ;qBAAM;oBACH,KAAI,CAAC,OAAO,CAAC,eAAe,CAAC,CAAA;iBAChC;aACJ;iBAAM;gBACH,KAAI,CAAC,OAAO,CAAC,eAAe,CAAC,CAAA;aAChC;QACL,CAAC,CAAC,CAAA;IAGN,CAAC;IAED,qCAAO,GAAP,UAAQ,GAAW;QACf,IAAI,OAAO,GAAG,EAAE,CAAC,WAAW,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;QAC3C,OAAO,CAAC,cAAc,CAAC,UAAU,CAAC,CAAC,YAAY,CAAC,EAAE,CAAC,KAAK,CAAC,CAAC,MAAM,GAAG,KAAG,GAAK,CAAC;QAC5E,IAAI,CAAC,IAAI,CAAC,QAAQ,CAAC,OAAO,EAAE,EAAE,CAAC,KAAK,CAAC,UAAU,CAAC,CAAC;QACjD,OAAO,CAAC,MAAM,GAAG,IAAI,CAAC;QACtB,OAAO,CAAC,SAAS,CAAC,EAAE,CAAC,QAAQ,CAAC,EAAE,CAAC,SAAS,CAAC,GAAG,CAAC,EAAE,EAAE,CAAC,MAAM,CAAC,GAAG,EAAE,EAAE,CAAC,EAAE,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,EAAE,EAAE,CAAC,QAAQ,CAAC;YACxF,OAAO,CAAC,OAAO,EAAE,CAAC;QACtB,CAAC,CAAC,CAAC,CAAC,CAAA;IACR,CAAC;IArKgB,mBAAmB;QADvC,OAAO;OACa,mBAAmB,CAyKvC;IAAD,0BAAC;CAzKD,AAyKC,CAzKgD,EAAE,CAAC,SAAS,GAyK5D;kBAzKoB,mBAAmB","file":"","sourceRoot":"/","sourcesContent":["import { utils } from \"./Utils\";\nimport { BannerLocation } from \"./YZ_Constant\";\n\nconst { ccclass, property } = cc._decorator;\n\n@ccclass\nexport default class YzRealNameAuthPanel extends cc.Component {\n\n\n    edit_real_name: cc.EditBox = null;\n    edit_id_card: cc.EditBox = null;\n    realNameAuthPanel: cc.Node = null;\n    msgNode: cc.Node = null;\n    exitPanel: cc.Node = null;\n    toVerifyPanel: cc.Node = null;\n    offLinePanel: cc.Node = null;\n    edit_default_color = null;\n\n    _isOffLine: boolean = false;\n    realNameAuthLandscapePanel:cc.Node = null;\n\n    onLoad() {\n        if (utils.otherConfig && utils.otherConfig.group) {\n            this.node.group = utils.otherConfig.group;\n        }\n        let ratio = 0;\n        if (cc.winSize.height < cc.winSize.width) {\n            this.realNameAuthPanel = cc.find(\"Panel/RealNameAuthLandscapePanel\", this.node)\n            // 横屏游戏\n            ratio = cc.winSize.width / 1920 * 0.75;\n        } else {\n            this.realNameAuthPanel = cc.find(\"Panel/RealNameAuthPanel\", this.node)\n            ratio = cc.winSize.width / 1080;\n        }\n\n \n        this.exitPanel = cc.find(\"Panel/ExitPanel\", this.node);\n        this.toVerifyPanel = cc.find(\"Panel/ToVerifyPanel\", this.node);\n        this.offLinePanel = cc.find(\"Panel/OfflinePanel\", this.node);\n\n        this.edit_id_card = this.realNameAuthPanel.getChildByName(\"editIdCard\").getComponent(cc.EditBox);\n        this.edit_real_name = this.realNameAuthPanel.getChildByName(\"editRealName\").getComponent(cc.EditBox);\n        this.msgNode = cc.find(\"Panel/MsgNode\", this.node);\n        this.edit_default_color = this.edit_real_name.fontColor;\n        if (this.edit_default_color == null) {\n            this.edit_default_color = new cc.Color(0, 0, 0, 63);\n        }\n        cc.find(\"Panel\", this.node).scale = ratio;\n\n        if (this._isOffLine) {\n            this.showOfferLine();\n        } else {\n            this.realNameAuthPanel.active = true;\n        }\n    }\n\n    start() {\n        // if (cc.winSize.height < cc.winSize.width) {\n            // utils.adManager.HideBanner(BannerLocation.Home);\n        // }\n    }\n\n    onDestroy() {\n        utils.emitRealNameAuthCloseEvent();\n    }\n\n\n    onExitBtnClickListener() {\n        utils.showLog(\"退出游戏！\");\n        utils.GameExit();\n    }\n\n\n    onBackAuthBtnClickListener() {\n        this.toVerifyPanel.active = false;\n        this.exitPanel.active = false;\n        this.realNameAuthPanel.active = true;\n    }\n\n\n    showExitPanel() {\n        this.toVerifyPanel.active = false;\n        this.realNameAuthPanel.active = false;\n        this.offLinePanel.active = false;\n        this.exitPanel.active = true;\n    }\n\n\n    showOfferLine() {\n        this.toVerifyPanel.active = false;\n        this.exitPanel.active = false;\n        this.realNameAuthPanel.active = false;\n        this.offLinePanel.active = true;\n    }\n\n    regName = /^[\\u4e00-\\u9fa5]{2,4}$/;\n    regIdNo = /(^\\d{15}$)|(^\\d{18}$)|(^\\d{17}(\\d|X|x)$)/;\n\n\n    _clickTime: number = 0;\n\n    onPostBtnClickListener() {\n        let nowTime = new Date().getTime();\n        if ((nowTime - this._clickTime) / 1000 < 2) {\n            this.showMsg('请勿频繁提交！');\n            return;\n        }\n\n        this._clickTime = nowTime;\n        if (!this.regName.test(this.edit_real_name.string)) {\n            this.showMsg('真实姓名填写有误!');\n            this.edit_real_name.fontColor = cc.Color.RED;\n            this.edit_real_name.setFocus();\n            return false;\n        }\n        this.edit_real_name.fontColor = this.edit_default_color;\n        if (!this.regIdNo.test(this.edit_id_card.string)) {\n            this.edit_id_card.fontColor = cc.Color.RED;\n            this.showMsg('身份证号填写有误!');\n            this.edit_id_card.setFocus();\n            return false;\n        }\n        this.edit_id_card.fontColor = this.edit_default_color;\n\n        utils.realNameAuth(this.edit_id_card.string, this.edit_real_name.string, (res, result) => {\n            utils.showLog(\"实名认证结束：#result=\" + JSON.stringify(result));\n            if (res) {\n                if (result) {\n                    let res = JSON.parse(result);\n                    switch (res.code) {\n                        case 1:\n                            this.showMsg(res.msg)\n                            break;\n                        case 0:\n                            if (res.nonage == \"0\") {\n                                utils.setRealNameAuthLocalData(\"2\")\n                            } else {\n                                utils.setRealNameAuthLocalData(\"1\")\n                            }\n                            utils._isRealNameAuth = true;\n                            if (res.msg) {\n                                this.showMsg(res.msg);\n                            }\n                            this.scheduleOnce(() => {\n                                this.node.destroy();\n                            }, 0.5);\n                            break;\n                        case 2:\n                            utils.setRealNameAuthLocalData(\"2\")\n                            this.showOfferLine();\n                            break;\n                    }\n                } else {\n                    this.showMsg(\"请求失败，请重新提交验证！\")\n                }\n            } else {\n                this.showMsg(\"请求失败，请重新提交验证！\")\n            }\n        })\n\n\n    }\n\n    showMsg(str: string) {\n        let msgNode = cc.instantiate(this.msgNode);\n        msgNode.getChildByName(\"msgLabel\").getComponent(cc.Label).string = `${str}`;\n        this.node.addChild(msgNode, cc.macro.MAX_ZINDEX);\n        msgNode.active = true;\n        msgNode.runAction(cc.sequence(cc.delayTime(0.8), cc.moveBy(0.3, cc.v2(0, +80)), cc.callFunc(() => {\n            msgNode.destroy();\n        })))\n    }\n\n\n\n}\n"]}