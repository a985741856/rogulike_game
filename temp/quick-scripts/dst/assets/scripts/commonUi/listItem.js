
                (function() {
                    var nodeEnv = typeof require !== 'undefined' && typeof process !== 'undefined';
                    var __module = nodeEnv ? module : {exports:{}};
                    var __filename = 'preview-scripts/assets/scripts/commonUi/listItem.js';
                    var __require = nodeEnv ? function (request) {
                        return cc.require(request);
                    } : function (request) {
                        return __quick_compile_project__.require(request, __filename);
                    };
                    function __define (exports, require, module) {
                        if (!nodeEnv) {__quick_compile_project__.registerModule(__filename, module);}"use strict";
cc._RF.push(module, 'a9fb9LTyU1DZathDbRN8oF1', 'listItem');
// scripts/commonUi/listItem.js

"use strict";

/******************************************
 * @author kL <klk0@qq.com>
 * @date 2019/5/15
 * @doc 列表Item组件.
 * 说明：
 *      1、此组件须配合list组件使用。（配套的配套的..）
 * @end
 ******************************************/
var SelectedType = cc.Enum({
  NONE: 0,
  TOGGLE: 1,
  //单一（单个Node显示/隐藏）
  SWITCH: 2 //切换(单个Sprite切换SpriteFrame)

});
cc.Class({
  editor: {
    disallowMultiple: false,
    menu: '自定义组件/list Item',
    executionOrder: -5001 //先于list

  },
  "extends": cc.Component,
  properties: {
    icon: {
      "default": null,
      type: cc.Sprite
    },
    title: cc.Node,
    selectedMode: {
      "default": SelectedType.NONE,
      type: SelectedType,
      tooltip: CC_DEV && '选择模式' // get: function () {
      //     return this._slideType;
      // },
      // set: function (val) {
      //     if (val != null)
      //         this._slideType = val;
      // }

    },
    selectedFlag: {
      "default": null,
      type: cc.Node,
      visible: function visible() {
        var bool = this.selectedMode > 0;
        if (!bool) this.selectedFlag = null;
        return bool;
      }
    },
    selectedSpriteFrame: {
      "default": null,
      type: cc.SpriteFrame,
      visible: function visible() {
        var bool = this.selectedMode == SelectedType.SWITCH;
        if (!bool) this.selectedSpriteFrame = null;
        return bool;
      }
    },
    adaptiveSize: {
      "default": false,
      tooltip: CC_DEV && '自适应尺寸（宽或高）'
    },
    _selected: false,
    selected: {
      visible: false,
      get: function get() {
        return this._selected;
      },
      set: function set(val) {
        this._selected = val;
        if (!this.selectedFlag) return;

        switch (this.selectedMode) {
          case SelectedType.TOGGLE:
            this.selectedFlag.active = val;
            break;

          case SelectedType.SWITCH:
            this.selectedFlag.spriteFrame = val ? this.selectedSpriteFrame : this._unselectedSpriteFrame;
            break;
        }
      }
    },
    _btnCom: null,
    btnCom: {
      visible: false,
      get: function get() {
        if (!this._btnCom) this._btnCom = this.node.getComponent(cc.Button);
        return this._btnCom;
      }
    }
  },
  onLoad: function onLoad() {
    //强行把文字组件转换给title...方便使用
    if (this.title) {
      var com = this.title.getComponent(cc.Label);
      if (!com) com = this.title.getComponent(cc.RichText);
      this.title = com;
    } // //没有按钮组件的话，selectedFlag无效
    // if (!this.btnCom)
    //     this.selectedMode == SelectedType.NONE;
    //有选择模式时，保存相应的东西


    if (this.selectedMode == SelectedType.SWITCH) {
      var _com = this.selectedFlag.getComponent(cc.Sprite);

      this.selectedFlag = _com;
      this._unselectedSpriteFrame = _com.spriteFrame;
    }
  },
  onDestroy: function onDestroy() {
    this.node.off(cc.Node.EventType.SIZE_CHANGED, this._onSizeChange, this);
  },
  _registerEvent: function _registerEvent() {
    if (!this.eventReg) {
      if (this.btnCom && this._list.selectedMode > 0) {
        this.btnCom.clickEvents.unshift(this.createEvt(this, 'onClickThis'));
      }

      if (this.adaptiveSize) {
        this.node.on(cc.Node.EventType.SIZE_CHANGED, this._onSizeChange, this);
      }

      this.eventReg = true;
    }
  },
  _onSizeChange: function _onSizeChange() {
    this._list._onItemAdaptive(this.node);
  },

  /**
   * 创建事件
   * @param {cc.Component} component 组件脚本
   * @param {string} handlerName 触发函数名称
   * @param {cc.Node} node 组件所在node（不传的情况下取component.node）
   * @returns cc.Component.EventHandler
   */
  createEvt: function createEvt(component, handlerName, node) {
    if (!component.isValid) return; //有些异步加载的，节点以及销毁了。

    component.comName = component.comName || component.name.match(/\<(.*?)\>/g).pop().replace(/\<|>/g, '');
    var evt = new cc.Component.EventHandler();
    evt.target = node || component.node;
    evt.component = component.comName;
    evt.handler = handlerName;
    return evt;
  },
  showAni: function showAni(aniType, callFunc, del) {
    var t = this;
    var tween;

    switch (aniType) {
      case 0:
        //向上消失
        tween = cc.tween(t.node).to(.2, {
          scale: .7
        }).by(.3, {
          y: t.node.height * 2
        });
        break;

      case 1:
        //向右消失
        tween = cc.tween(t.node).to(.2, {
          scale: .7
        }).by(.3, {
          x: t.node.width * 2
        });
        break;

      case 2:
        //向下消失
        tween = cc.tween(t.node).to(.2, {
          scale: .7
        }).by(.3, {
          y: t.node.height * -2
        });
        break;

      case 3:
        //向左消失
        tween = cc.tween(t.node).to(.2, {
          scale: .7
        }).by(.3, {
          x: t.node.width * -2
        });
        break;

      default:
        //默认：缩小消失
        tween = cc.tween(t.node).to(.3, {
          scale: .1
        });
        break;
    }

    if (callFunc || del) {
      tween.call(function () {
        if (del) {
          t._list._delSingleItem(t.node);

          for (var n = t._list.displayData.length - 1; n >= 0; n--) {
            if (t._list.displayData[n].listId == t.node._listId) {
              t._list.displayData.splice(n, 1);

              break;
            }
          }
        }

        callFunc();
      });
    }

    tween.start();
  },
  onClickThis: function onClickThis() {
    this._list.selectedId = this.node._listId;
  }
});

cc._RF.pop();
                    }
                    if (nodeEnv) {
                        __define(__module.exports, __require, __module);
                    }
                    else {
                        __quick_compile_project__.registerModuleFunc(__filename, function () {
                            __define(__module.exports, __require, __module);
                        });
                    }
                })();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFzc2V0c1xcc2NyaXB0c1xcY29tbW9uVWlcXGxpc3RJdGVtLmpzIl0sIm5hbWVzIjpbIlNlbGVjdGVkVHlwZSIsImNjIiwiRW51bSIsIk5PTkUiLCJUT0dHTEUiLCJTV0lUQ0giLCJDbGFzcyIsImVkaXRvciIsImRpc2FsbG93TXVsdGlwbGUiLCJtZW51IiwiZXhlY3V0aW9uT3JkZXIiLCJDb21wb25lbnQiLCJwcm9wZXJ0aWVzIiwiaWNvbiIsInR5cGUiLCJTcHJpdGUiLCJ0aXRsZSIsIk5vZGUiLCJzZWxlY3RlZE1vZGUiLCJ0b29sdGlwIiwiQ0NfREVWIiwic2VsZWN0ZWRGbGFnIiwidmlzaWJsZSIsImJvb2wiLCJzZWxlY3RlZFNwcml0ZUZyYW1lIiwiU3ByaXRlRnJhbWUiLCJhZGFwdGl2ZVNpemUiLCJfc2VsZWN0ZWQiLCJzZWxlY3RlZCIsImdldCIsInNldCIsInZhbCIsImFjdGl2ZSIsInNwcml0ZUZyYW1lIiwiX3Vuc2VsZWN0ZWRTcHJpdGVGcmFtZSIsIl9idG5Db20iLCJidG5Db20iLCJub2RlIiwiZ2V0Q29tcG9uZW50IiwiQnV0dG9uIiwib25Mb2FkIiwiY29tIiwiTGFiZWwiLCJSaWNoVGV4dCIsIm9uRGVzdHJveSIsIm9mZiIsIkV2ZW50VHlwZSIsIlNJWkVfQ0hBTkdFRCIsIl9vblNpemVDaGFuZ2UiLCJfcmVnaXN0ZXJFdmVudCIsImV2ZW50UmVnIiwiX2xpc3QiLCJjbGlja0V2ZW50cyIsInVuc2hpZnQiLCJjcmVhdGVFdnQiLCJvbiIsIl9vbkl0ZW1BZGFwdGl2ZSIsImNvbXBvbmVudCIsImhhbmRsZXJOYW1lIiwiaXNWYWxpZCIsImNvbU5hbWUiLCJuYW1lIiwibWF0Y2giLCJwb3AiLCJyZXBsYWNlIiwiZXZ0IiwiRXZlbnRIYW5kbGVyIiwidGFyZ2V0IiwiaGFuZGxlciIsInNob3dBbmkiLCJhbmlUeXBlIiwiY2FsbEZ1bmMiLCJkZWwiLCJ0IiwidHdlZW4iLCJ0byIsInNjYWxlIiwiYnkiLCJ5IiwiaGVpZ2h0IiwieCIsIndpZHRoIiwiY2FsbCIsIl9kZWxTaW5nbGVJdGVtIiwibiIsImRpc3BsYXlEYXRhIiwibGVuZ3RoIiwibGlzdElkIiwiX2xpc3RJZCIsInNwbGljZSIsInN0YXJ0Iiwib25DbGlja1RoaXMiLCJzZWxlY3RlZElkIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7OztBQUFBOzs7Ozs7OztBQVFBLElBQU1BLFlBQVksR0FBR0MsRUFBRSxDQUFDQyxJQUFILENBQVE7QUFDekJDLEVBQUFBLElBQUksRUFBRSxDQURtQjtBQUV6QkMsRUFBQUEsTUFBTSxFQUFFLENBRmlCO0FBRWQ7QUFDWEMsRUFBQUEsTUFBTSxFQUFFLENBSGlCLENBR2Q7O0FBSGMsQ0FBUixDQUFyQjtBQU1BSixFQUFFLENBQUNLLEtBQUgsQ0FBUztBQUNMQyxFQUFBQSxNQUFNLEVBQUU7QUFDSkMsSUFBQUEsZ0JBQWdCLEVBQUUsS0FEZDtBQUVKQyxJQUFBQSxJQUFJLEVBQUUsaUJBRkY7QUFHSkMsSUFBQUEsY0FBYyxFQUFFLENBQUMsSUFIYixDQUc0Qjs7QUFINUIsR0FESDtBQU9MLGFBQVNULEVBQUUsQ0FBQ1UsU0FQUDtBQVNMQyxFQUFBQSxVQUFVLEVBQUU7QUFDUkMsSUFBQUEsSUFBSSxFQUFFO0FBQ0YsaUJBQVMsSUFEUDtBQUVGQyxNQUFBQSxJQUFJLEVBQUViLEVBQUUsQ0FBQ2M7QUFGUCxLQURFO0FBS1JDLElBQUFBLEtBQUssRUFBRWYsRUFBRSxDQUFDZ0IsSUFMRjtBQU1SQyxJQUFBQSxZQUFZLEVBQUU7QUFDVixpQkFBU2xCLFlBQVksQ0FBQ0csSUFEWjtBQUVWVyxNQUFBQSxJQUFJLEVBQUVkLFlBRkk7QUFHVm1CLE1BQUFBLE9BQU8sRUFBRUMsTUFBTSxJQUFJLE1BSFQsQ0FJVjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFWVSxLQU5OO0FBa0JSQyxJQUFBQSxZQUFZLEVBQUU7QUFDVixpQkFBUyxJQURDO0FBRVZQLE1BQUFBLElBQUksRUFBRWIsRUFBRSxDQUFDZ0IsSUFGQztBQUdWSyxNQUFBQSxP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TUFBdkIsSUFBaUNkLENBQUMsQ0FBQ3BDLElBQUYsQ0FBT21ELE9BQTVDLEVBQXFEO0FBQ2pEZixjQUFBQSxDQUFDLENBQUN0QixLQUFGLENBQVFrQyxXQUFSLENBQW9CSSxNQUFwQixDQUEyQkwsQ0FBM0IsRUFBOEIsQ0FBOUI7O0FBQ0E7QUFDSDtBQUNKO0FBQ0o7O0FBQ0RiLFFBQUFBLFFBQVE7QUFDWCxPQVhEO0FBWUg7O0FBQ0RHLElBQUFBLEtBQUssQ0FBQ2dCLEtBQU47QUFDSCxHQXRMSTtBQXdMTEMsRUFBQUEsV0F4TEsseUJBd0xTO0FBQ1YsU0FBS3hDLEtBQUwsQ0FBV3lDLFVBQVgsR0FBd0IsS0FBS3ZELElBQUwsQ0FBVW1ELE9BQWxDO0FBQ0g7QUExTEksQ0FBVCIsInNvdXJjZVJvb3QiOiIvIiwic291cmNlc0NvbnRlbnQiOlsiLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxyXG4gKiBAYXV0aG9yIGtMIDxrbGswQHFxLmNvbT5cclxuICogQGRhdGUgMjAxOS81LzE1XHJcbiAqIEBkb2Mg5YiX6KGoSXRlbee7hOS7ti5cclxuICog6K+05piO77yaXHJcbiAqICAgICAgMeOAgeatpOe7hOS7tumhu+mFjeWQiGxpc3Tnu4Tku7bkvb/nlKjjgILvvIjphY3lpZfnmoTphY3lpZfnmoQuLu+8iVxyXG4gKiBAZW5kXHJcbiAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXHJcbmNvbnN0IFNlbGVjdGVkVHlwZSA9IGNjLkVudW0oe1xyXG4gICAgTk9ORTogMCxcclxuICAgIFRPR0dMRTogMSwgLy/ljZXkuIDvvIjljZXkuKpOb2Rl5pi+56S6L+makOiXj++8iVxyXG4gICAgU1dJVENIOiAyLCAvL+WIh+aNoijljZXkuKpTcHJpdGXliIfmjaJTcHJpdGVGcmFtZSlcclxufSk7XHJcblxyXG5jYy5DbGFzcyh7XHJcbiAgICBlZGl0b3I6IHtcclxuICAgICAgICBkaXNhbGxvd011bHRpcGxlOiBmYWxzZSxcclxuICAgICAgICBtZW51OiAn6Ieq5a6a5LmJ57uE5Lu2L2xpc3QgSXRlbScsXHJcbiAgICAgICAgZXhlY3V0aW9uT3JkZXI6IC01MDAxLCAgICAgICAgICAvL+WFiOS6jmxpc3RcclxuICAgIH0sXHJcblxyXG4gICAgZXh0ZW5kczogY2MuQ29tcG9uZW50LFxyXG5cclxuICAgIHByb3BlcnRpZXM6IHtcclxuICAgICAgICBpY29uOiB7XHJcbiAgICAgICAgICAgIGRlZmF1bHQ6IG51bGwsXHJcbiAgICAgICAgICAgIHR5cGU6IGNjLlNwcml0ZSxcclxuICAgICAgICB9LFxyXG4gICAgICAgIHRpdGxlOiBjYy5Ob2RlLFxyXG4gICAgICAgIHNlbGVjdGVkTW9kZToge1xyXG4gICAgICAgICAgICBkZWZhdWx0OiBTZWxlY3RlZFR5cGUuTk9ORSxcclxuICAgICAgICAgICAgdHlwZTogU2VsZWN0ZWRUeXBlLFxyXG4gICAgICAgICAgICB0b29sdGlwOiBDQ19ERVYgJiYgJ+mAieaLqeaooeW8jycsXHJcbiAgICAgICAgICAgIC8vIGdldDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAvLyAgICAgcmV0dXJuIHRoaXMuX3NsaWRlVHlwZTtcclxuICAgICAgICAgICAgLy8gfSxcclxuICAgICAgICAgICAgLy8gc2V0OiBmdW5jdGlvbiAodmFsKSB7XHJcbiAgICAgICAgICAgIC8vICAgICBpZiAodmFsICE9IG51bGwpXHJcbiAgICAgICAgICAgIC8vICAgICAgICAgdGhpcy5fc2xpZGVUeXBlID0gdmFsO1xyXG4gICAgICAgICAgICAvLyB9XHJcbiAgICAgICAgfSxcclxuICAgICAgICBzZWxlY3RlZEZsYWc6IHtcclxuICAgICAgICAgICAgZGVmYXVsdDogbnVsbCxcclxuICAgICAgICAgICAgdHlwZTogY2MuTm9kZSxcclxuICAgICAgICAgICAgdmlzaWJsZTogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgbGV0IGJvb2wgPSB0aGlzLnNlbGVjdGVkTW9kZSA+IDA7XHJcbiAgICAgICAgICAgICAgICBpZiAoIWJvb2wpXHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zZWxlY3RlZEZsYWcgPSBudWxsO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGJvb2w7XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgfSxcclxuICAgICAgICBzZWxlY3RlZFNwcml0ZUZyYW1lOiB7XHJcbiAgICAgICAgICAgIGRlZmF1bHQ6IG51bGwsXHJcbiAgICAgICAgICAgIHR5cGU6IGNjLlNwcml0ZUZyYW1lLFxyXG4gICAgICAgICAgICB2aXNpYmxlOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICBsZXQgYm9vbCA9IHRoaXMuc2VsZWN0ZWRNb2RlID09IFNlbGVjdGVkVHlwZS5TV0lUQ0g7XHJcbiAgICAgICAgICAgICAgICBpZiAoIWJvb2wpXHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zZWxlY3RlZFNwcml0ZUZyYW1lID0gbnVsbDtcclxuICAgICAgICAgICAgICAgIHJldHVybiBib29sO1xyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgYWRhcHRpdmVTaXplOiB7XHJcbiAgICAgICAgICAgIGRlZmF1bHQ6IGZhbHNlLFxyXG4gICAgICAgICAgICB0b29sdGlwOiBDQ19ERVYgJiYgJ+iHqumAguW6lOWwuuWvuO+8iOWuveaIlumrmO+8iScsXHJcbiAgICAgICAgfSxcclxuICAgICAgICBfc2VsZWN0ZWQ6IGZhbHNlLFxyXG4gICAgICAgIHNlbGVjdGVkOiB7XHJcbiAgICAgICAgICAgIHZpc2libGU6IGZhbHNlLFxyXG4gICAgICAgICAgICBnZXQoKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fc2VsZWN0ZWQ7XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIHNldCh2YWwpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuX3NlbGVjdGVkID0gdmFsO1xyXG4gICAgICAgICAgICAgICAgaWYgKCF0aGlzLnNlbGVjdGVkRmxhZylcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKHRoaXMuc2VsZWN0ZWRNb2RlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSBTZWxlY3RlZFR5cGUuVE9HR0xFOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdGVkRmxhZy5hY3RpdmUgPSB2YWw7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgU2VsZWN0ZWRUeXBlLlNXSVRDSDpcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zZWxlY3RlZEZsYWcuc3ByaXRlRnJhbWUgPSB2YWwgPyB0aGlzLnNlbGVjdGVkU3ByaXRlRnJhbWUgOiB0aGlzLl91bnNlbGVjdGVkU3ByaXRlRnJhbWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSxcclxuICAgICAgICBfYnRuQ29tOiBudWxsLFxyXG4gICAgICAgIGJ0bkNvbToge1xyXG4gICAgICAgICAgICB2aXNpYmxlOiBmYWxzZSxcclxuICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoIXRoaXMuX2J0bkNvbSlcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9idG5Db20gPSB0aGlzLm5vZGUuZ2V0Q29tcG9uZW50KGNjLkJ1dHRvbik7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fYnRuQ29tO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSxcclxuICAgIH0sXHJcblxyXG4gICAgb25Mb2FkKCkge1xyXG4gICAgICAgIC8v5by66KGM5oqK5paH5a2X57uE5Lu26L2s5o2i57uZdGl0bGUuLi7mlrnkvr/kvb/nlKhcclxuICAgICAgICBpZiAodGhpcy50aXRsZSkge1xyXG4gICAgICAgICAgICBsZXQgY29tID0gdGhpcy50aXRsZS5nZXRDb21wb25lbnQoY2MuTGFiZWwpO1xyXG4gICAgICAgICAgICBpZiAoIWNvbSlcclxuICAgICAgICAgICAgICAgIGNvbSA9IHRoaXMudGl0bGUuZ2V0Q29tcG9uZW50KGNjLlJpY2hUZXh0KTtcclxuICAgICAgICAgICAgdGhpcy50aXRsZSA9IGNvbTtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8gLy/msqHmnInmjInpkq7nu4Tku7bnmoTor53vvIxzZWxlY3RlZEZsYWfml6DmlYhcclxuICAgICAgICAvLyBpZiAoIXRoaXMuYnRuQ29tKVxyXG4gICAgICAgIC8vICAgICB0aGlzLnNlbGVjdGVkTW9kZSA9PSBTZWxlY3RlZFR5cGUuTk9ORTtcclxuICAgICAgICAvL+aciemAieaLqeaooeW8j+aXtu+8jOS/neWtmOebuOW6lOeahOS4nOilv1xyXG4gICAgICAgIGlmICh0aGlzLnNlbGVjdGVkTW9kZSA9PSBTZWxlY3RlZFR5cGUuU1dJVENIKSB7XHJcbiAgICAgICAgICAgIGxldCBjb20gPSB0aGlzLnNlbGVjdGVkRmxhZy5nZXRDb21wb25lbnQoY2MuU3ByaXRlKTtcclxuICAgICAgICAgICAgdGhpcy5zZWxlY3RlZEZsYWcgPSBjb207XHJcbiAgICAgICAgICAgIHRoaXMuX3Vuc2VsZWN0ZWRTcHJpdGVGcmFtZSA9IGNvbS5zcHJpdGVGcmFtZTtcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG5cclxuICAgIG9uRGVzdHJveSgpIHtcclxuICAgICAgICB0aGlzLm5vZGUub2ZmKGNjLk5vZGUuRXZlbnRUeXBlLlNJWkVfQ0hBTkdFRCwgdGhpcy5fb25TaXplQ2hhbmdlLCB0aGlzKTtcclxuICAgIH0sXHJcblxyXG4gICAgX3JlZ2lzdGVyRXZlbnQoKSB7XHJcbiAgICAgICAgaWYgKCF0aGlzLmV2ZW50UmVnKSB7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLmJ0bkNvbSAmJiB0aGlzLl9saXN0LnNlbGVjdGVkTW9kZSA+IDApIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuYnRuQ29tLmNsaWNrRXZlbnRzLnVuc2hpZnQodGhpcy5jcmVhdGVFdnQodGhpcywgJ29uQ2xpY2tUaGlzJykpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmICh0aGlzLmFkYXB0aXZlU2l6ZSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5ub2RlLm9uKGNjLk5vZGUuRXZlbnRUeXBlLlNJWkVfQ0hBTkdFRCwgdGhpcy5fb25TaXplQ2hhbmdlLCB0aGlzKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB0aGlzLmV2ZW50UmVnID0gdHJ1ZTtcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG5cclxuICAgIF9vblNpemVDaGFuZ2UoKSB7XHJcbiAgICAgICAgdGhpcy5fbGlzdC5fb25JdGVtQWRhcHRpdmUodGhpcy5ub2RlKTtcclxuICAgIH0sXHJcbiAgICAvKipcclxuICAgICAqIOWIm+W7uuS6i+S7tlxyXG4gICAgICogQHBhcmFtIHtjYy5Db21wb25lbnR9IGNvbXBvbmVudCDnu4Tku7bohJrmnKxcclxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBoYW5kbGVyTmFtZSDop6blj5Hlh73mlbDlkI3np7BcclxuICAgICAqIEBwYXJhbSB7Y2MuTm9kZX0gbm9kZSDnu4Tku7bmiYDlnKhub2Rl77yI5LiN5Lyg55qE5oOF5Ya15LiL5Y+WY29tcG9uZW50Lm5vZGXvvIlcclxuICAgICAqIEByZXR1cm5zIGNjLkNvbXBvbmVudC5FdmVudEhhbmRsZXJcclxuICAgICAqL1xyXG4gICAgY3JlYXRlRXZ0KGNvbXBvbmVudCwgaGFuZGxlck5hbWUsIG5vZGUpIHtcclxuICAgICAgICBpZiAoIWNvbXBvbmVudC5pc1ZhbGlkKVxyXG4gICAgICAgICAgICByZXR1cm47Ly/mnInkupvlvILmraXliqDovb3nmoTvvIzoioLngrnku6Xlj4rplIDmr4HkuobjgIJcclxuICAgICAgICBjb21wb25lbnQuY29tTmFtZSA9IGNvbXBvbmVudC5jb21OYW1lIHx8IGNvbXBvbmVudC5uYW1lLm1hdGNoKC9cXDwoLio/KVxcPi9nKS5wb3AoKS5yZXBsYWNlKC9cXDx8Pi9nLCAnJyk7XHJcbiAgICAgICAgbGV0IGV2dCA9IG5ldyBjYy5Db21wb25lbnQuRXZlbnRIYW5kbGVyKCk7XHJcbiAgICAgICAgZXZ0LnRhcmdldCA9IG5vZGUgfHwgY29tcG9uZW50Lm5vZGU7XHJcbiAgICAgICAgZXZ0LmNvbXBvbmVudCA9IGNvbXBvbmVudC5jb21OYW1lO1xyXG4gICAgICAgIGV2dC5oYW5kbGVyID0gaGFuZGxlck5hbWU7XHJcbiAgICAgICAgcmV0dXJuIGV2dDtcclxuICAgIH0sXHJcblxyXG4gICAgc2hvd0FuaShhbmlUeXBlLCBjYWxsRnVuYywgZGVsKSB7XHJcbiAgICAgICAgbGV0IHQgPSB0aGlzO1xyXG4gICAgICAgIGxldCB0d2VlbjtcclxuICAgICAgICBzd2l0Y2ggKGFuaVR5cGUpIHtcclxuICAgICAgICAgICAgY2FzZSAwOiAvL+WQkeS4iua2iOWksVxyXG4gICAgICAgICAgICAgICAgdHdlZW4gPSBjYy50d2Vlbih0Lm5vZGUpXHJcbiAgICAgICAgICAgICAgICAgICAgLnRvKC4yLCB7IHNjYWxlOiAuNyB9KVxyXG4gICAgICAgICAgICAgICAgICAgIC5ieSguMywgeyB5OiB0Lm5vZGUuaGVpZ2h0ICogMiB9KTtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlIDE6IC8v5ZCR5Y+z5raI5aSxXHJcbiAgICAgICAgICAgICAgICB0d2VlbiA9IGNjLnR3ZWVuKHQubm9kZSlcclxuICAgICAgICAgICAgICAgICAgICAudG8oLjIsIHsgc2NhbGU6IC43IH0pXHJcbiAgICAgICAgICAgICAgICAgICAgLmJ5KC4zLCB7IHg6IHQubm9kZS53aWR0aCAqIDIgfSk7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgY2FzZSAyOiAvL+WQkeS4i+a2iOWksVxyXG4gICAgICAgICAgICAgICAgdHdlZW4gPSBjYy50d2Vlbih0Lm5vZGUpXHJcbiAgICAgICAgICAgICAgICAgICAgLnRvKC4yLCB7IHNjYWxlOiAuNyB9KVxyXG4gICAgICAgICAgICAgICAgICAgIC5ieSguMywgeyB5OiB0Lm5vZGUuaGVpZ2h0ICogLTIgfSk7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgY2FzZSAzOiAvL+WQkeW3pua2iOWksVxyXG4gICAgICAgICAgICAgICAgdHdlZW4gPSBjYy50d2Vlbih0Lm5vZGUpXHJcbiAgICAgICAgICAgICAgICAgICAgLnRvKC4yLCB7IHNjYWxlOiAuNyB9KVxyXG4gICAgICAgICAgICAgICAgICAgIC5ieSguMywgeyB4OiB0Lm5vZGUud2lkdGggKiAtMiB9KTtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBkZWZhdWx0OiAvL+m7mOiupO+8mue8qeWwj+a2iOWksVxyXG4gICAgICAgICAgICAgICAgdHdlZW4gPSBjYy50d2Vlbih0Lm5vZGUpXHJcbiAgICAgICAgICAgICAgICAgICAgLnRvKC4zLCB7IHNjYWxlOiAuMSB9KTtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoY2FsbEZ1bmMgfHwgZGVsKSB7XHJcbiAgICAgICAgICAgIHR3ZWVuLmNhbGwoKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgaWYgKGRlbCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHQuX2xpc3QuX2RlbFNpbmdsZUl0ZW0odC5ub2RlKTtcclxuICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCBuID0gdC5fbGlzdC5kaXNwbGF5RGF0YS5sZW5ndGggLSAxOyBuID49IDA7IG4tLSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodC5fbGlzdC5kaXNwbGF5RGF0YVtuXS5saXN0SWQgPT0gdC5ub2RlLl9saXN0SWQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHQuX2xpc3QuZGlzcGxheURhdGEuc3BsaWNlKG4sIDEpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBjYWxsRnVuYygpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdHdlZW4uc3RhcnQoKTtcclxuICAgIH0sXHJcblxyXG4gICAgb25DbGlja1RoaXMoKSB7XHJcbiAgICAgICAgdGhpcy5fbGlzdC5zZWxlY3RlZElkID0gdGhpcy5ub2RlLl9saXN0SWQ7XHJcbiAgICB9LFxyXG5cclxufSk7Il19