{"version":3,"sources":["assets\\scripts\\commonUi\\list.js"],"names":["TemplateType","cc","Enum","SlideType","SelectedType","listItem","require","Class","Component","editor","disallowMultiple","menu","requireComponent","ScrollView","executionOrder","properties","templateType","NODE","type","tmpNode","Node","tooltip","CC_DEV","visible","bool","tmpPrefab","Prefab","PREFAB","_slideMode","slideMode","get","set","val","pageDistance","Float","range","slide","PAGE","pageChangeEvent","EventHandler","_virtual","virtual","_numItems","_onScrolling","cyclic","NORMAL","lackCenter","lackSlide","_updateRate","updateRate","Integer","frameByFrameRenderNum","renderEvent","Function","selectedMode","NONE","repeatEventSingle","SINGLE","selectedEvent","_selectedId","selectedId","t","item","getItemBylistId","_lastSelectedId","selected","lastItem","_actualNumItems","MULT","sub","multSelected","indexOf","push","splice","serializable","numItems","checkInited","error","_forceUpdate","_resizeContent","_cyclicNum","curPageNum","nearestlistId","layout","content","getComponent","Layout","enabled","_delRedundantItem","firstlistId","len","n","_createOrUpdateItem2","_updateCounter","_updateDone","displayItemNum","onLoad","_init","onDestroy","isValid","_itemTmp","destroy","_pool","clear","onEnable","_registerEvent","_aniDelRuning","_aniDelItem","_aniDelBeforePos","position","_aniDelBeforeScale","scale","_aniDelCB","onDisable","_unregisterEvent","node","on","EventType","TOUCH_START","_onTouchStart","_onTouchUp","TOUCH_CANCEL","_onTouchCancelled","_onScrollBegan","_onScrollEnded","SIZE_CHANGED","_onSizeChanged","off","_inited","_scrollView","name","_layout","_align","_resizeMode","resizeMode","_startAxis","startAxis","_topGap","paddingTop","_rightGap","paddingRight","_bottomGap","paddingBottom","_leftGap","paddingLeft","_columnGap","spacingX","_lineGap","spacingY","_colLineNum","_verticalDir","verticalDirection","_horizontalDir","horizontalDirection","setTemplateItem","instantiate","ADHERING","inertia","_onMouseWheel","_lastDisplayData","displayData","NodePool","_processAutoScrolling","bind","_startBounceBackIfNeeded","Type","HORIZONTAL","HorizontalDirection","LEFT_TO_RIGHT","_alignCalcType","RIGHT_TO_LEFT","VERTICAL","VerticalDirection","TOP_TO_BOTTOM","BOTTOM_TO_TOP","GRID","AxisDirection","removeAllChildren","dt","brakingFactor","_autoScrollAccumulatedTime","percentage","Math","min","_autoScrollTotalTime","_autoScrollAttenuate","time","newPosition","_autoScrollStartPosition","add","_autoScrollTargetDelta","mul","EPSILON","getScrollEndedEventTiming","reachedEnd","abs","fireEvent","_isScrollEndedWithThresholdEventFired","_dispatchEvent","_autoScrolling","deltaMove","getContentPosition","_moveContent","_clampDelta","_isBouncing","_scrolling","ResizeMode","CHILDREN","_itemSize","cellSize","size","width","height","com","remove","Widget","_needUpdateWidget","_sizeType","trimW","floor","trimH","printLog","result","_customSize","fixed","_getFixedSize","count","lineNum","ceil","colNum","_allItemSize","_allItemSizeNoEdge","totalSize","_cyclicPos1","spacing","_cyclicPos2","_cyclicAllItemSize","_cycilcAllItemSizeNoEdge","_lack","slideOffset","targetWH","ev","frameCount","scrollPos","getPosition","y","x","addVal","v2","isAutoScrolling","_calcViewPos","vTop","vRight","vBottom","vLeft","viewTop","viewBottom","viewRight","viewLeft","itemPos","curId","endId","breakFor","_calcItemPos","right","left","length","bottom","top","ww","hh","id","haveDataChange","sort","a","b","_doneAfterUpdate","c","_createOrUpdateItem","_calcNearestItem","elasticLeft","elasticRight","elasticTop","elasticBottom","itemX","itemY","cs","offset","anchorX","anchorY","colLine","_calcExistItemPos","data","getItemPos","listId","parseInt","_beganPos","curScrollistouch","scrollTolistId","tween","to","start","adhering","adhere","_pageAdhere","capturelisteners","_hasNestedViewGroup","isMe","eventPhase","Event","AT_TARGET","target","itemNode","_listId","parent","_scrollItem","_scrollPos","_adheringBarrier","simulate","_onItemAdaptive","updateAll","_scrollTolistId","unschedule","_scrollToSo","scrollTo","max","_scrollToEndTime","Date","getTime","curPos","dis","canSkip","timeInSecond","prePage","nextPage","update","canGet","setContentSize","setPosition","_resetItemSize","addChild","widget","updateAlignment","setSiblingIndex","childrenCount","_list","_updatelistItem","children","_updateItemPos","listIdOrItem","isNaN","pos","setMultSelected","args","Array","isArray","getMultSelected","hasMultSelected","updateItem","_getOutsideItem","find","d","arr","isCached","put","m","_delSingleItem","removeFromParent","aniDelItem","callFunc","aniType","warn","curLastId","resetSelectedId","showAni","newId","newData","newCustomSize","sec","haveCB","posData","call","overStress","updateLayout","targetX","targetY","viewPos","comparePos","runScroll","scrollToOffset","scheduleOnce","center","skipPage","pageNum","emitEvents","calcCustomSize","temp","Object","keys"],"mappings":"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","sourceRoot":"/","sourcesContent":["/******************************************\r\n * @author kL <klk0@qq.com>\r\n * @date 2019/1/5\r\n * @doc 列表组件.\r\n * @end\r\n ******************************************/\r\nconst TemplateType = cc.Enum({\r\n    'NODE': 1,\r\n    'PREFAB': 2,\r\n});\r\nconst SlideType = cc.Enum({\r\n    'NORMAL': 1, //普通\r\n    'ADHERING': 2, //粘附模式，将强制关闭滚动惯性\r\n    'PAGE': 3,   //页面模式，将强制关闭滚动惯性\r\n});\r\nconst SelectedType = cc.Enum({\r\n    'NONE': 0,\r\n    'SINGLE': 1, //单选\r\n    'MULT': 2, //多选\r\n});\r\n\r\nconst listItem = require('listItem');\r\n\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    editor: {\r\n        disallowMultiple: false,\r\n        menu: '自定义组件/list',\r\n        requireComponent: cc.ScrollView,\r\n        //脚本生命周期回调的执行优先级。小于 0 的脚本将优先执行，大于 0 的脚本将最后执行。该优先级只对 onLoad, onEnable, start, update 和 lateUpdate 有效，对 onDisable 和 onDestroy 无效。\r\n        executionOrder: -5000,\r\n    },\r\n\r\n    properties: {\r\n        templateType: {\r\n            default: TemplateType.NODE,\r\n            type: TemplateType,\r\n        },\r\n        tmpNode: {\r\n            default: null,\r\n            type: cc.Node,\r\n            tooltip: CC_DEV && 'Item模版，type:cc.Node',\r\n            visible: function () {\r\n                let bool = this.templateType == TemplateType.NODE;\r\n                if (!bool)\r\n                    this.tmpNode = null;\r\n                return bool;\r\n            }\r\n        },\r\n        tmpPrefab: {\r\n            default: null,\r\n            type: cc.Prefab,\r\n            tooltip: CC_DEV && 'Item模版，type:cc.Prefab',\r\n            visible: function () {\r\n                let bool = this.templateType == TemplateType.PREFAB;\r\n                if (!bool)\r\n                    this.tmpPrefab = null;\r\n                return bool;\r\n            }\r\n        },\r\n        _slideMode: 1,\r\n        slideMode: {\r\n            type: SlideType,\r\n            tooltip: CC_DEV && '滑动模式',\r\n            get: function () {\r\n                return this._slideMode;\r\n            },\r\n            set: function (val) {\r\n                if (val != null)\r\n                    this._slideMode = val;\r\n            }\r\n        },\r\n        pageDistance: {\r\n            default: .3,\r\n            type: cc.Float,\r\n            range: [0, 1, .1],\r\n            tooltip: CC_DEV && '翻页作用距离',\r\n            slide: true,\r\n            visible: function () {\r\n                return this._slideMode == SlideType.PAGE;\r\n            },\r\n        },\r\n        pageChangeEvent: {\r\n            default: null,\r\n            type: cc.Component.EventHandler,\r\n            tooltip: CC_DEV && '页面改变事件',\r\n            visible: function () {\r\n                let bool = this._slideMode == SlideType.PAGE;\r\n                if (!bool)\r\n                    this.pageChangeEvent = null;\r\n                return bool;\r\n            },\r\n        },\r\n        _virtual: true,\r\n        virtual: {\r\n            tooltip: CC_DEV && '是否为虚拟列表（动态列表）',\r\n            get() {\r\n                return this._virtual;\r\n            },\r\n            set(val) {\r\n                if (val != null)\r\n                    this._virtual = val;\r\n                if (!CC_DEV && this._numItems != 0) {\r\n                    this._onScrolling();\r\n                }\r\n            }\r\n        },\r\n        cyclic: {\r\n            default: false,\r\n            tooltip: CC_DEV && '是否为循环列表',\r\n            visible: function () {\r\n                let val = /*this.virtual &&*/ this.slideMode == SlideType.NORMAL;\r\n                if (!val)\r\n                    this.cyclic = false;\r\n                return val;\r\n            },\r\n        },\r\n        lackCenter: {\r\n            default: false,\r\n            tooltip: CC_DEV && 'Item数量不足以填满Content时，是否居中显示Item（不支持Grid布局）',\r\n            visible: function () {\r\n                return this.virtual;\r\n            }\r\n        },\r\n        lackSlide: {\r\n            default: false,\r\n            tooltip: CC_DEV && 'Item数量不足以填满Content时，是否可滑动',\r\n            visible: function () {\r\n                let val = this.virtual && !this.lackCenter;\r\n                if (!val)\r\n                    this.lackSlide = false;\r\n                return val;\r\n            }\r\n        },\r\n        _updateRate: 0,\r\n        updateRate: {\r\n            type: cc.Integer,\r\n            range: [0, 6, 1],\r\n            tooltip: CC_DEV && '刷新频率（值越大刷新频率越低、性能越高）',\r\n            slide: true,\r\n            get() {\r\n                return this._updateRate;\r\n            },\r\n            set(val) {\r\n                if (val >= 0 && val <= 6) {\r\n                    this._updateRate = val;\r\n                }\r\n            }\r\n        },\r\n        frameByFrameRenderNum: {\r\n            default: 0,\r\n            type: cc.Integer,\r\n            range: [0, 12, 1],\r\n            tooltip: CC_DEV && '逐帧渲染时，每帧渲染的Item数量（<=0时关闭分帧渲染）',\r\n            slide: true,\r\n        },\r\n        renderEvent: {\r\n            default: null,\r\n            type: Function,\r\n            tooltip: CC_DEV && '渲染事件（渲染器）',\r\n        },\r\n        selectedMode: {\r\n            default: SelectedType.NONE,\r\n            type: SelectedType,\r\n            tooltip: CC_DEV && '选择模式',\r\n        },\r\n        repeatEventSingle: {\r\n            default: false,\r\n            tooltip: CC_DEV && '是否重复响应单选事件',\r\n            visible: function () {\r\n                return this.selectedMode == SelectedType.SINGLE;\r\n            }\r\n        },\r\n        selectedEvent: {\r\n            default: null,\r\n            type: Function,\r\n            tooltip: CC_DEV && '触发选择事件',\r\n            visible: function () {\r\n                let bool = this.selectedMode > 0;\r\n                if (!bool)\r\n                    this.selectedEvent = null;\r\n                return bool;\r\n            },\r\n        },\r\n        _selectedId: -1,\r\n        selectedId: {\r\n            visible: false,\r\n            get: function () {\r\n                return this._selectedId;\r\n            },\r\n            set: function (val) {\r\n                let t = this;\r\n                let item;\r\n                switch (t.selectedMode) {\r\n                    case SelectedType.SINGLE: {\r\n                        if (!t.repeatEventSingle && val == t._selectedId)\r\n                            return;\r\n                        item = t.getItemBylistId(val);\r\n                        // if (!item && val >= 0)\r\n                        //     return;\r\n                        if (t._selectedId >= 0)\r\n                            t._lastSelectedId = t._selectedId;\r\n                        else //如果＜0则取消选择，把_lastSelectedId也置空吧，如果以后有特殊需求再改吧。\r\n                            t._lastSelectedId = null;\r\n                        t._selectedId = val;\r\n                        if (item)\r\n                            item.listItem.selected = true;\r\n                        if (t._lastSelectedId >= 0 && t._lastSelectedId != t._selectedId) {\r\n                            let lastItem = t.getItemBylistId(t._lastSelectedId);\r\n                            if (lastItem) {\r\n                                lastItem.listItem.selected = false;\r\n                            }\r\n                        }\r\n                        if (t.selectedEvent) {\r\n                            t.selectedEvent(item, val % this._actualNumItems, t._lastSelectedId == null ? null : (t._lastSelectedId % this._actualNumItems));\r\n                            // cc.Component.EventHandler.emitEvents([t.selectedEvent], item, val % this._actualNumItems, t._lastSelectedId == null ? null : (t._lastSelectedId % this._actualNumItems));\r\n                        }\r\n                        break;\r\n                    }\r\n                    case SelectedType.MULT: {\r\n                        item = t.getItemBylistId(val);\r\n                        if (!item)\r\n                            return;\r\n                        if (t._selectedId >= 0)\r\n                            t._lastSelectedId = t._selectedId;\r\n                        t._selectedId = val;\r\n                        let bool = !item.listItem.selected;\r\n                        item.listItem.selected = bool;\r\n                        let sub = t.multSelected.indexOf(val);\r\n                        if (bool && sub < 0) {\r\n                            t.multSelected.push(val);\r\n                        } else if (!bool && sub >= 0) {\r\n                            t.multSelected.splice(sub, 1);\r\n                        }\r\n                        if (t.selectedEvent) {\r\n                            t.selectedEvent(item, val % this._actualNumItems, t._lastSelectedId == null ? null : (t._lastSelectedId % this._actualNumItems));\r\n                            // cc.Component.EventHandler.emitEvents([t.selectedEvent], item, val % this._actualNumItems, t._lastSelectedId == null ? null : (t._lastSelectedId % this._actualNumItems), bool);\r\n                        }\r\n                        break;\r\n                    }\r\n                }\r\n            },\r\n        },\r\n        _numItems: {\r\n            default: 0,\r\n            serializable: false,\r\n        },\r\n        numItems: {\r\n            visible: false,\r\n            get() {\r\n                return this._actualNumItems;\r\n            },\r\n            set(val) {\r\n                let t = this;\r\n                if (!t.checkInited())\r\n                    return;\r\n                if (val == null || val < 0) {\r\n                    cc.error('numItems set the wrong::', val);\r\n                    return;\r\n                }\r\n                t._actualNumItems = t._numItems = val;\r\n                t._forceUpdate = true;\r\n\r\n                if (t._virtual) {\r\n                    t._resizeContent();\r\n                    if (t.cyclic) {\r\n                        t._numItems = t._cyclicNum * t._numItems;\r\n                    }\r\n                    t._onScrolling();\r\n                    if (!t.frameByFrameRenderNum && t.slideMode == SlideType.PAGE)\r\n                        t.curPageNum = t.nearestlistId;\r\n                } else {\r\n                    if (t.cyclic) {\r\n                        t._resizeContent();\r\n                        t._numItems = t._cyclicNum * t._numItems;\r\n                    }\r\n                    let layout = t.content.getComponent(cc.Layout);\r\n                    if (layout) {\r\n                        layout.enabled = true;\r\n                    }\r\n                    t._delRedundantItem();\r\n\r\n                    t.firstlistId = 0;\r\n                    if (t.frameByFrameRenderNum > 0) {\r\n                        //先渲染几个出来\r\n                        let len = t.frameByFrameRenderNum > t._numItems ? t._numItems : t.frameByFrameRenderNum;\r\n                        for (let n = 0; n < len; n++) {\r\n                            t._createOrUpdateItem2(n);\r\n                        }\r\n                        if (t.frameByFrameRenderNum < t._numItems) {\r\n                            t._updateCounter = t.frameByFrameRenderNum;\r\n                            t._updateDone = false;\r\n                        }\r\n                    } else {\r\n                        for (let n = 0; n < t._numItems; n++) {\r\n                            t._createOrUpdateItem2(n);\r\n                        }\r\n                        t.displayItemNum = t._numItems;\r\n                    }\r\n                }\r\n            }\r\n        },\r\n    },\r\n\r\n    onLoad() {\r\n        this._init();\r\n    },\r\n\r\n    onDestroy() {\r\n        let t = this;\r\n        if (cc.isValid(t._itemTmp))\r\n            t._itemTmp.destroy();\r\n        if (cc.isValid(t.tmpNode))\r\n            t.tmpNode.destroy();\r\n        t._pool && t._pool.clear();\r\n    },\r\n\r\n    onEnable() {\r\n        // if (!CC_EDITOR)\r\n        this._registerEvent();\r\n        this._init();\r\n        // 处理重新显示后，有可能上一次的动画移除还未播放完毕，导致动画卡住的问题\r\n        if (this._aniDelRuning) {\r\n            this._aniDelRuning = false;\r\n            if (this._aniDelItem) {\r\n                if (this._aniDelBeforePos) {\r\n                    this._aniDelItem.position = this._aniDelBeforePos;\r\n                    delete this._aniDelBeforePos;\r\n                }\r\n                if (this._aniDelBeforeScale) {\r\n                    this._aniDelItem.scale = this._aniDelBeforeScale;\r\n                    delete this._aniDelBeforeScale;\r\n                }\r\n                delete this._aniDelItem;\r\n            }\r\n            if (this._aniDelCB) {\r\n                this._aniDelCB();\r\n                delete this._aniDelCB;\r\n            }\r\n        }\r\n    },\r\n\r\n    onDisable() {\r\n        // if (!CC_EDITOR)\r\n        this._unregisterEvent();\r\n    },\r\n    //注册事件\r\n    _registerEvent() {\r\n        let t = this;\r\n        t.node.on(cc.Node.EventType.TOUCH_START, t._onTouchStart, t, true);\r\n        t.node.on('touch-up', t._onTouchUp, t, true);\r\n        t.node.on(cc.Node.EventType.TOUCH_CANCEL, t._onTouchCancelled, t, true);\r\n        t.node.on('scroll-began', t._onScrollBegan, t, true);\r\n        t.node.on('scroll-ended', t._onScrollEnded, t, true);\r\n        t.node.on('scrolling', t._onScrolling, t, true);\r\n        t.node.on(cc.Node.EventType.SIZE_CHANGED, t._onSizeChanged, t);\r\n    },\r\n    //卸载事件\r\n    _unregisterEvent() {\r\n        let t = this;\r\n        t.node.off(cc.Node.EventType.TOUCH_START, t._onTouchStart, t, true);\r\n        t.node.off('touch-up', t._onTouchUp, t, true);\r\n        t.node.off(cc.Node.EventType.TOUCH_CANCEL, t._onTouchCancelled, t, true);\r\n        t.node.off('scroll-began', t._onScrollBegan, t, true);\r\n        t.node.off('scroll-ended', t._onScrollEnded, t, true);\r\n        t.node.off('scrolling', t._onScrolling, t, true);\r\n        t.node.off(cc.Node.EventType.SIZE_CHANGED, t._onSizeChanged, t);\r\n    },\r\n    //初始化各种..\r\n    _init() {\r\n        let t = this;\r\n        if (t._inited)\r\n            return;\r\n\r\n        t._scrollView = t.node.getComponent(cc.ScrollView);\r\n\r\n        t.content = t._scrollView.content;\r\n        if (!t.content) {\r\n            cc.error(t.node.name + \"'s cc.ScrollView unset content!\");\r\n            return;\r\n        }\r\n\r\n        t._layout = t.content.getComponent(cc.Layout);\r\n\r\n        t._align = t._layout.type; //排列模式\r\n        t._resizeMode = t._layout.resizeMode; //自适应模式\r\n        t._startAxis = t._layout.startAxis;\r\n\r\n        t._topGap = t._layout.paddingTop;       //顶边距\r\n        t._rightGap = t._layout.paddingRight;   //右边距\r\n        t._bottomGap = t._layout.paddingBottom; //底边距\r\n        t._leftGap = t._layout.paddingLeft;     //左边距\r\n\r\n        t._columnGap = t._layout.spacingX;      //列距\r\n        t._lineGap = t._layout.spacingY;        //行距\r\n\r\n        t._colLineNum; //列数或行数（非GRID模式则=1，表示单列或单行）;\r\n\r\n        t._verticalDir = t._layout.verticalDirection; //垂直排列子节点的方向\r\n        t._horizontalDir = t._layout.horizontalDirection; //水平排列子节点的方向\r\n\r\n        t.setTemplateItem(cc.instantiate(t.templateType == TemplateType.PREFAB ? t.tmpPrefab : t.tmpNode));\r\n\r\n        // 特定的滑动模式处理\r\n        if (t._slideMode == SlideType.ADHERING || t._slideMode == SlideType.PAGE) {\r\n            t._scrollView.inertia = false;\r\n            t._scrollView._onMouseWheel = function () {\r\n                return;\r\n            };\r\n        }\r\n        if (!t.virtual)         // lackCenter 仅支持 Virtual 模式\r\n            t.lackCenter = false;\r\n\r\n        t._lastDisplayData = [];//最后一次刷新的数据\r\n        t.displayData = [];     //当前数据\r\n        t._pool = new cc.NodePool();    //这是个池子..\r\n        t._forceUpdate = false; //是否强制更新\r\n        t._updateCounter = 0;   //当前分帧渲染帧数\r\n        t._updateDone = true;   //分帧渲染是否完成\r\n\r\n        t.curPageNum = 0;   //当前页数\r\n\r\n        if (t.cyclic) { // 如果是循环列表，覆写一些cc.ScrollView的函数\r\n            t._scrollView._processAutoScrolling = this._processAutoScrolling.bind(t);\r\n            t._scrollView._startBounceBackIfNeeded = function () {\r\n                return false;\r\n            }\r\n        }\r\n\r\n        switch (t._align) {\r\n            case cc.Layout.Type.HORIZONTAL: {\r\n                switch (t._horizontalDir) {\r\n                    case cc.Layout.HorizontalDirection.LEFT_TO_RIGHT:\r\n                        t._alignCalcType = 1;\r\n                        break;\r\n                    case cc.Layout.HorizontalDirection.RIGHT_TO_LEFT:\r\n                        t._alignCalcType = 2;\r\n                        break;\r\n                }\r\n                break;\r\n            }\r\n            case cc.Layout.Type.VERTICAL: {\r\n                switch (t._verticalDir) {\r\n                    case cc.Layout.VerticalDirection.TOP_TO_BOTTOM:\r\n                        t._alignCalcType = 3;\r\n                        break;\r\n                    case cc.Layout.VerticalDirection.BOTTOM_TO_TOP:\r\n                        t._alignCalcType = 4;\r\n                        break;\r\n                }\r\n                break;\r\n            }\r\n            case cc.Layout.Type.GRID: {\r\n                switch (t._startAxis) {\r\n                    case cc.Layout.AxisDirection.HORIZONTAL:\r\n                        switch (t._verticalDir) {\r\n                            case cc.Layout.VerticalDirection.TOP_TO_BOTTOM:\r\n                                t._alignCalcType = 3;\r\n                                break;\r\n                            case cc.Layout.VerticalDirection.BOTTOM_TO_TOP:\r\n                                t._alignCalcType = 4;\r\n                                break;\r\n                        }\r\n                        break;\r\n                    case cc.Layout.AxisDirection.VERTICAL:\r\n                        switch (t._horizontalDir) {\r\n                            case cc.Layout.HorizontalDirection.LEFT_TO_RIGHT:\r\n                                t._alignCalcType = 1;\r\n                                break;\r\n                            case cc.Layout.HorizontalDirection.RIGHT_TO_LEFT:\r\n                                t._alignCalcType = 2;\r\n                                break;\r\n                        }\r\n                        break;\r\n                }\r\n                break;\r\n            }\r\n        }\r\n        // 清空 content\r\n        // t.content.children.forEach(child => {\r\n        //     child.removeFromParent();\r\n        //     if (child.isValid)\r\n        //         child.destroy();\r\n        // });\r\n        t.content.removeAllChildren();\r\n        t._inited = true;\r\n    },\r\n    /**\r\n     * 为了实现循环列表，必须覆写cc.ScrollView的某些函数\r\n     * @param {Number} dt\r\n     */\r\n    _processAutoScrolling(dt) {\r\n        // let isAutoScrollBrake = this._scrollView._isNecessaryAutoScrollBrake();\r\n        let brakingFactor = 1;\r\n        this._scrollView._autoScrollAccumulatedTime += dt * (1 / brakingFactor);\r\n\r\n        let percentage = Math.min(1, this._scrollView._autoScrollAccumulatedTime / this._scrollView._autoScrollTotalTime);\r\n        if (this._scrollView._autoScrollAttenuate) {\r\n            let time = percentage - 1;\r\n            percentage = time * time * time * time * time + 1;\r\n        }\r\n\r\n        let newPosition = this._scrollView._autoScrollStartPosition.add(this._scrollView._autoScrollTargetDelta.mul(percentage));\r\n        let EPSILON = this._scrollView.getScrollEndedEventTiming();\r\n        let reachedEnd = Math.abs(percentage - 1) <= EPSILON;\r\n        // cc.log(reachedEnd, Math.abs(percentage - 1), EPSILON)\r\n\r\n        let fireEvent = Math.abs(percentage - 1) <= this._scrollView.getScrollEndedEventTiming();\r\n        if (fireEvent && !this._scrollView._isScrollEndedWithThresholdEventFired) {\r\n            this._scrollView._dispatchEvent('scroll-ended-with-threshold');\r\n            this._scrollView._isScrollEndedWithThresholdEventFired = true;\r\n        }\r\n\r\n        // if (this._scrollView.elastic && !reachedEnd) {\r\n        //     let brakeOffsetPosition = newPosition.sub(this._scrollView._autoScrollBrakingStartPosition);\r\n        //     if (isAutoScrollBrake) {\r\n        //         brakeOffsetPosition = brakeOffsetPosition.mul(brakingFactor);\r\n        //     }\r\n        //     newPosition = this._scrollView._autoScrollBrakingStartPosition.add(brakeOffsetPosition);\r\n        // } else {\r\n        //     let moveDelta = newPosition.sub(this._scrollView.getContentPosition());\r\n        //     let outOfBoundary = this._scrollView._getHowMuchOutOfBoundary(moveDelta);\r\n        //     if (!outOfBoundary.fuzzyEquals(cc.v2(0, 0), EPSILON)) {\r\n        //         newPosition = newPosition.add(outOfBoundary);\r\n        //         reachedEnd = true;\r\n        //     }\r\n        // }\r\n\r\n        if (reachedEnd) {\r\n            this._scrollView._autoScrolling = false;\r\n        }\r\n\r\n        let deltaMove = newPosition.sub(this._scrollView.getContentPosition());\r\n        // cc.log(deltaMove)\r\n        this._scrollView._moveContent(this._scrollView._clampDelta(deltaMove), reachedEnd);\r\n        this._scrollView._dispatchEvent('scrolling');\r\n\r\n        // scollTo API controll move\r\n        if (!this._scrollView._autoScrolling) {\r\n            this._scrollView._isBouncing = false;\r\n            this._scrollView._scrolling = false;\r\n            this._scrollView._dispatchEvent('scroll-ended');\r\n        }\r\n    },\r\n    //设置模板Item\r\n    setTemplateItem(item) {\r\n        if (!item)\r\n            return;\r\n        let t = this;\r\n        t._itemTmp = item;\r\n\r\n        if (t._resizeMode == cc.Layout.ResizeMode.CHILDREN)\r\n            t._itemSize = t._layout.cellSize;\r\n        else\r\n            t._itemSize = new cc.size(item.width, item.height);\r\n\r\n        //获取listItem，如果没有就取消选择模式\r\n        let com = item.getComponent('listItem');\r\n        let remove = false;\r\n        if (!com)\r\n            remove = true;\r\n        // if (com) {\r\n        //     if (!com._btnCom && !item.getComponent(cc.Button)) {\r\n        //         remove = true;\r\n        //     }\r\n        // }\r\n        if (remove) {\r\n            t.selectedMode = SelectedType.NONE;\r\n        }\r\n        com = item.getComponent(cc.Widget);\r\n        if (com && com.enabled) {\r\n            t._needUpdateWidget = true;\r\n        }\r\n        if (t.selectedMode == SelectedType.MULT)\r\n            t.multSelected = [];\r\n\r\n        switch (t._align) {\r\n            case cc.Layout.Type.HORIZONTAL:\r\n                t._colLineNum = 1;\r\n                t._sizeType = false;\r\n                break;\r\n            case cc.Layout.Type.VERTICAL:\r\n                t._colLineNum = 1;\r\n                t._sizeType = true;\r\n                break;\r\n            case cc.Layout.Type.GRID:\r\n                switch (t._startAxis) {\r\n                    case cc.Layout.AxisDirection.HORIZONTAL:\r\n                        //计算列数\r\n                        let trimW = t.content.width - t._leftGap - t._rightGap;\r\n                        t._colLineNum = Math.floor((trimW + t._columnGap) / (t._itemSize.width + t._columnGap));\r\n                        t._sizeType = true;\r\n                        break;\r\n                    case cc.Layout.AxisDirection.VERTICAL:\r\n                        //计算行数\r\n                        let trimH = t.content.height - t._topGap - t._bottomGap;\r\n                        t._colLineNum = Math.floor((trimH + t._lineGap) / (t._itemSize.height + t._lineGap));\r\n                        t._sizeType = false;\r\n                        break;\r\n                }\r\n                break;\r\n        }\r\n    },\r\n    /**\r\n     * 检查是否初始化\r\n     * @param {Boolean} printLog 是否打印错误信息\r\n     * @returns\r\n     */\r\n    checkInited(printLog) {\r\n        printLog = printLog == null ? true : printLog;\r\n        if (!this._inited) {\r\n            if (printLog) {\r\n                cc.error('list initialization not completed!');\r\n            }\r\n            return false;\r\n        }\r\n        return true;\r\n    },\r\n    //禁用 Layout 组件，自行计算 Content Size\r\n    _resizeContent() {\r\n        let t = this;\r\n        let result;\r\n        switch (t._align) {\r\n            case cc.Layout.Type.HORIZONTAL: {\r\n                if (t._customSize) {\r\n                    let fixed = t._getFixedSize();\r\n                    result = t._leftGap + fixed.val + (t._itemSize.width * (t._numItems - fixed.count)) + (t._columnGap * (t._numItems - 1)) + t._rightGap;\r\n                } else {\r\n                    result = t._leftGap + (t._itemSize.width * t._numItems) + (t._columnGap * (t._numItems - 1)) + t._rightGap;\r\n                }\r\n                break;\r\n            }\r\n            case cc.Layout.Type.VERTICAL: {\r\n                if (t._customSize) {\r\n                    let fixed = t._getFixedSize();\r\n                    result = t._topGap + fixed.val + (t._itemSize.height * (t._numItems - fixed.count)) + (t._lineGap * (t._numItems - 1)) + t._bottomGap;\r\n                } else {\r\n                    result = t._topGap + (t._itemSize.height * t._numItems) + (t._lineGap * (t._numItems - 1)) + t._bottomGap;\r\n                }\r\n                break;\r\n            }\r\n            case cc.Layout.Type.GRID: {\r\n                //网格模式不支持居中\r\n                if (t.lackCenter)\r\n                    t.lackCenter = false;\r\n                switch (t._startAxis) {\r\n                    case cc.Layout.AxisDirection.HORIZONTAL:\r\n                        let lineNum = Math.ceil(t._numItems / t._colLineNum);\r\n                        result = t._topGap + (t._itemSize.height * lineNum) + (t._lineGap * (lineNum - 1)) + t._bottomGap;\r\n                        break;\r\n                    case cc.Layout.AxisDirection.VERTICAL:\r\n                        let colNum = Math.ceil(t._numItems / t._colLineNum);\r\n                        result = t._leftGap + (t._itemSize.width * colNum) + (t._columnGap * (colNum - 1)) + t._rightGap;\r\n                        break;\r\n                }\r\n                break;\r\n            }\r\n        }\r\n\r\n        let layout = t.content.getComponent(cc.Layout);\r\n        if (layout)\r\n            layout.enabled = false;\r\n\r\n        t._allItemSize = result;\r\n        t._allItemSizeNoEdge = t._allItemSize - (t._sizeType ? (t._topGap + t._bottomGap) : (t._leftGap + t._rightGap));\r\n\r\n        if (t.cyclic) {\r\n            let totalSize = (t._sizeType ? t.node.height : t.node.width);\r\n\r\n            t._cyclicPos1 = 0;\r\n            totalSize -= t._cyclicPos1;\r\n            t._cyclicNum = Math.ceil(totalSize / t._allItemSizeNoEdge) + 1;\r\n            let spacing = t._sizeType ? t._lineGap : t._columnGap;\r\n            t._cyclicPos2 = t._cyclicPos1 + t._allItemSizeNoEdge + spacing;\r\n            t._cyclicAllItemSize = t._allItemSize + (t._allItemSizeNoEdge * (t._cyclicNum - 1)) + (spacing * (t._cyclicNum - 1));\r\n            t._cycilcAllItemSizeNoEdge = t._allItemSizeNoEdge * t._cyclicNum;\r\n            t._cycilcAllItemSizeNoEdge += spacing * (t._cyclicNum - 1);\r\n            // cc.log('_cyclicNum ->', t._cyclicNum, t._allItemSizeNoEdge, t._allItemSize, t._cyclicPos1, t._cyclicPos2);\r\n        }\r\n\r\n        t._lack = !t.cyclic && t._allItemSize < (t._sizeType ? t.node.height : t.node.width);\r\n        let slideOffset = ((!t._lack || !t.lackCenter) && t.lackSlide) ? 0 : .1;\r\n\r\n        let targetWH = t._lack ? ((t._sizeType ? t.node.height : t.node.width) - slideOffset) : (t.cyclic ? t._cyclicAllItemSize : t._allItemSize);\r\n        if (targetWH < 0)\r\n            targetWH = 0;\r\n\r\n        if (t._sizeType) {\r\n            t.content.height = targetWH;\r\n        } else {\r\n            t.content.width = targetWH;\r\n        }\r\n        // cc.log('_resizeContent()  numItems =', t._numItems, '，content =', t.content);\r\n    },\r\n    //滚动进行时...\r\n    _onScrolling(ev) {\r\n        if (this.frameCount == null)\r\n            this.frameCount = this._updateRate;\r\n        if (!this._forceUpdate && (ev && ev.type != 'scroll-ended') && this.frameCount > 0) {\r\n            this.frameCount--;\r\n            return;\r\n        } else\r\n            this.frameCount = this._updateRate;\r\n\r\n        if (this._aniDelRuning)\r\n            return;\r\n\r\n        //循环列表处理\r\n        if (this.cyclic) {\r\n            let scrollPos = this.content.getPosition();\r\n            scrollPos = this._sizeType ? scrollPos.y : scrollPos.x;\r\n\r\n            let addVal = this._allItemSizeNoEdge + (this._sizeType ? this._lineGap : this._columnGap);\r\n            let add = this._sizeType ? cc.v2(0, addVal) : cc.v2(addVal, 0);\r\n\r\n            switch (this._alignCalcType) {\r\n                case 1://单行HORIZONTAL（LEFT_TO_RIGHT）、网格VERTICAL（LEFT_TO_RIGHT）\r\n                    if (scrollPos > -this._cyclicPos1) {\r\n                        this.content.x = -this._cyclicPos2;\r\n                        if (this._scrollView.isAutoScrolling()) {\r\n                            this._scrollView._autoScrollStartPosition = this._scrollView._autoScrollStartPosition.sub(add);\r\n                        }\r\n                        // if (this._beganPos) {\r\n                        //     this._beganPos += add;\r\n                        // }\r\n                    } else if (scrollPos < -this._cyclicPos2) {\r\n                        this.content.x = -this._cyclicPos1;\r\n                        if (this._scrollView.isAutoScrolling()) {\r\n                            this._scrollView._autoScrollStartPosition = this._scrollView._autoScrollStartPosition.add(add);\r\n                        }\r\n                        // if (this._beganPos) {\r\n                        //     this._beganPos -= add;\r\n                        // }\r\n                    }\r\n                    break;\r\n                case 2://单行HORIZONTAL（RIGHT_TO_LEFT）、网格VERTICAL（RIGHT_TO_LEFT）\r\n                    if (scrollPos < this._cyclicPos1) {\r\n                        this.content.x = this._cyclicPos2;\r\n                        if (this._scrollView.isAutoScrolling()) {\r\n                            this._scrollView._autoScrollStartPosition = this._scrollView._autoScrollStartPosition.add(add);\r\n                        }\r\n                    } else if (scrollPos > this._cyclicPos2) {\r\n                        this.content.x = this._cyclicPos1;\r\n                        if (this._scrollView.isAutoScrolling()) {\r\n                            this._scrollView._autoScrollStartPosition = this._scrollView._autoScrollStartPosition.sub(add);\r\n                        }\r\n                    }\r\n                    break;\r\n                case 3://单列VERTICAL（TOP_TO_BOTTOM）、网格HORIZONTAL（TOP_TO_BOTTOM）\r\n                    if (scrollPos < this._cyclicPos1) {\r\n                        this.content.y = this._cyclicPos2;\r\n                        if (this._scrollView.isAutoScrolling()) {\r\n                            this._scrollView._autoScrollStartPosition = this._scrollView._autoScrollStartPosition.add(add);\r\n                        }\r\n                    } else if (scrollPos > this._cyclicPos2) {\r\n                        this.content.y = this._cyclicPos1;\r\n                        if (this._scrollView.isAutoScrolling()) {\r\n                            this._scrollView._autoScrollStartPosition = this._scrollView._autoScrollStartPosition.sub(add);\r\n                        }\r\n                    }\r\n                    break;\r\n                case 4://单列VERTICAL（BOTTOM_TO_TOP）、网格HORIZONTAL（BOTTOM_TO_TOP）\r\n                    if (scrollPos > -this._cyclicPos1) {\r\n                        this.content.y = -this._cyclicPos2;\r\n                        if (this._scrollView.isAutoScrolling()) {\r\n                            this._scrollView._autoScrollStartPosition = this._scrollView._autoScrollStartPosition.sub(add);\r\n                        }\r\n                    } else if (scrollPos < -this._cyclicPos2) {\r\n                        this.content.y = -this._cyclicPos1;\r\n                        if (this._scrollView.isAutoScrolling()) {\r\n                            this._scrollView._autoScrollStartPosition = this._scrollView._autoScrollStartPosition.add(add);\r\n                        }\r\n                    }\r\n                    break;\r\n            }\r\n        }\r\n\r\n        this._calcViewPos();\r\n\r\n        let vTop, vRight, vBottom, vLeft;\r\n        if (this._sizeType) {\r\n            vTop = this.viewTop;\r\n            vBottom = this.viewBottom;\r\n        } else {\r\n            vRight = this.viewRight;\r\n            vLeft = this.viewLeft;\r\n        }\r\n\r\n        if (this._virtual) {\r\n            this.displayData = [];\r\n            let itemPos;\r\n\r\n            let curId = 0;\r\n            let endId = this._numItems - 1;\r\n\r\n            if (this._customSize) {\r\n                let breakFor = false;\r\n                //如果该item的位置在可视区域内，就推入displayData\r\n                for (; curId <= endId && !breakFor; curId++) {\r\n                    itemPos = this._calcItemPos(curId);\r\n                    switch (this._align) {\r\n                        case cc.Layout.Type.HORIZONTAL:\r\n                            if (itemPos.right >= vLeft && itemPos.left <= vRight) {\r\n                                this.displayData.push(itemPos);\r\n                            } else if (curId != 0 && this.displayData.length > 0) {\r\n                                breakFor = true;\r\n                            }\r\n                            break;\r\n                        case cc.Layout.Type.VERTICAL:\r\n                            if (itemPos.bottom <= vTop && itemPos.top >= vBottom) {\r\n                                this.displayData.push(itemPos);\r\n                            } else if (curId != 0 && this.displayData.length > 0) {\r\n                                breakFor = true;\r\n                            }\r\n                            break;\r\n                        case cc.Layout.Type.GRID:\r\n                            switch (this._startAxis) {\r\n                                case cc.Layout.AxisDirection.HORIZONTAL:\r\n                                    if (itemPos.bottom <= vTop && itemPos.top >= vBottom) {\r\n                                        this.displayData.push(itemPos);\r\n                                    } else if (curId != 0 && this.displayData.length > 0) {\r\n                                        breakFor = true;\r\n                                    }\r\n                                    break;\r\n                                case cc.Layout.AxisDirection.VERTICAL:\r\n                                    if (itemPos.right >= vLeft && itemPos.left <= vRight) {\r\n                                        this.displayData.push(itemPos);\r\n                                    } else if (curId != 0 && this.displayData.length > 0) {\r\n                                        breakFor = true;\r\n                                    }\r\n                                    break;\r\n                            }\r\n                            break;\r\n                    }\r\n                }\r\n            } else {\r\n                let ww = this._itemSize.width + this._columnGap;\r\n                let hh = this._itemSize.height + this._lineGap;\r\n                switch (this._alignCalcType) {\r\n                    case 1://单行HORIZONTAL（LEFT_TO_RIGHT）、网格VERTICAL（LEFT_TO_RIGHT）\r\n                        curId = (vLeft - this._leftGap) / ww;\r\n                        endId = (vRight - this._leftGap) / ww;\r\n                        break;\r\n                    case 2://单行HORIZONTAL（RIGHT_TO_LEFT）、网格VERTICAL（RIGHT_TO_LEFT）\r\n                        curId = (-vRight - this._rightGap) / ww;\r\n                        endId = (-vLeft - this._rightGap) / ww;\r\n                        break;\r\n                    case 3://单列VERTICAL（TOP_TO_BOTTOM）、网格HORIZONTAL（TOP_TO_BOTTOM）\r\n                        curId = (-vTop - this._topGap) / hh;\r\n                        endId = (-vBottom - this._topGap) / hh;\r\n                        break;\r\n                    case 4://单列VERTICAL（BOTTOM_TO_TOP）、网格HORIZONTAL（BOTTOM_TO_TOP）\r\n                        curId = (vBottom - this._bottomGap) / hh;\r\n                        endId = (vTop - this._bottomGap) / hh;\r\n                        break;\r\n                }\r\n                curId = Math.floor(curId) * this._colLineNum;\r\n                endId = Math.ceil(endId) * this._colLineNum;\r\n                endId--;\r\n                if (curId < 0)\r\n                    curId = 0;\r\n                if (endId >= this._numItems)\r\n                    endId = this._numItems - 1;\r\n                for (; curId <= endId; curId++) {\r\n                    this.displayData.push(this._calcItemPos(curId));\r\n                }\r\n            }\r\n            this._delRedundantItem();\r\n            if (this.displayData.length <= 0 || !this._numItems) { //if none, delete all.\r\n                this._lastDisplayData = [];\r\n                return;\r\n            }\r\n            this.firstlistId = this.displayData[0].id;\r\n            this.displayItemNum = this.displayData.length;\r\n\r\n            let len = this._lastDisplayData.length;\r\n            let haveDataChange = this.displayItemNum != len;\r\n            if (haveDataChange) {\r\n                // 如果是逐帧渲染，需要排序\r\n                if (this.frameByFrameRenderNum > 0) {\r\n                    this._lastDisplayData.sort((a, b) => { return a - b });\r\n                }\r\n                // 因list的显示数据是有序的，所以只需要判断数组长度是否相等，以及头、尾两个元素是否相等即可。\r\n                haveDataChange = this.firstlistId != this._lastDisplayData[0] || this.displayData[this.displayItemNum - 1].id != this._lastDisplayData[len - 1];\r\n            }\r\n\r\n            if (this._forceUpdate || haveDataChange) {    //如果是强制更新\r\n                if (this.frameByFrameRenderNum > 0) {\r\n                    // if (this._updateDone) {\r\n                    // this._lastDisplayData = [];\r\n                    //逐帧渲染\r\n                    if (this._numItems > 0) {\r\n                        if (!this._updateDone) {\r\n                            this._doneAfterUpdate = true;\r\n\r\n                        } else {\r\n                            this._updateCounter = 0;\r\n                        }\r\n                        this._updateDone = false;\r\n                    } else {\r\n                        this._updateCounter = 0;\r\n                        this._updateDone = true;\r\n                    }\r\n                    // }\r\n                } else {\r\n                    //直接渲染\r\n                    this._lastDisplayData = [];\r\n                    // cc.log('list Display Data II::', this.displayData);\r\n                    for (let c = 0; c < this.displayItemNum; c++) {\r\n                        this._createOrUpdateItem(this.displayData[c]);\r\n                    }\r\n                    this._forceUpdate = false;\r\n                }\r\n            }\r\n            this._calcNearestItem();\r\n        }\r\n    },\r\n    //计算View位置\r\n    _calcViewPos() {\r\n        let scrollPos = this.content.getPosition();\r\n        switch (this._alignCalcType) {\r\n            case 1://单行HORIZONTAL（LEFT_TO_RIGHT）、网格VERTICAL（LEFT_TO_RIGHT）\r\n                this.elasticLeft = scrollPos.x > 0 ? scrollPos.x : 0;\r\n                this.viewLeft = (scrollPos.x < 0 ? -scrollPos.x : 0) - this.elasticLeft;\r\n                this.viewRight = this.viewLeft + this.node.width;\r\n                this.elasticRight = this.viewRight > this.content.width ? Math.abs(this.viewRight - this.content.width) : 0;\r\n                this.viewRight += this.elasticRight;\r\n                // cc.log(this.elasticLeft, this.elasticRight, this.viewLeft, this.viewRight);\r\n                break;\r\n            case 2://单行HORIZONTAL（RIGHT_TO_LEFT）、网格VERTICAL（RIGHT_TO_LEFT）\r\n                this.elasticRight = scrollPos.x < 0 ? -scrollPos.x : 0;\r\n                this.viewRight = (scrollPos.x > 0 ? -scrollPos.x : 0) + this.elasticRight;\r\n                this.viewLeft = this.viewRight - this.node.width;\r\n                this.elasticLeft = this.viewLeft < -this.content.width ? Math.abs(this.viewLeft + this.content.width) : 0;\r\n                this.viewLeft -= this.elasticLeft;\r\n                // cc.log(this.elasticLeft, this.elasticRight, this.viewLeft, this.viewRight);\r\n                break;\r\n            case 3://单列VERTICAL（TOP_TO_BOTTOM）、网格HORIZONTAL（TOP_TO_BOTTOM）\r\n                this.elasticTop = scrollPos.y < 0 ? Math.abs(scrollPos.y) : 0;\r\n                this.viewTop = (scrollPos.y > 0 ? -scrollPos.y : 0) + this.elasticTop;\r\n                this.viewBottom = this.viewTop - this.node.height;\r\n                this.elasticBottom = this.viewBottom < -this.content.height ? Math.abs(this.viewBottom + this.content.height) : 0;\r\n                this.viewBottom += this.elasticBottom;\r\n                // cc.log(this.elasticTop, this.elasticBottom, this.viewTop, this.viewBottom);\r\n                break;\r\n            case 4://单列VERTICAL（BOTTOM_TO_TOP）、网格HORIZONTAL（BOTTOM_TO_TOP）\r\n                this.elasticBottom = scrollPos.y > 0 ? Math.abs(scrollPos.y) : 0;\r\n                this.viewBottom = (scrollPos.y < 0 ? -scrollPos.y : 0) - this.elasticBottom;\r\n                this.viewTop = this.viewBottom + this.node.height;\r\n                this.elasticTop = this.viewTop > this.content.height ? Math.abs(this.viewTop - this.content.height) : 0;\r\n                this.viewTop -= this.elasticTop;\r\n                // cc.log(this.elasticTop, this.elasticBottom, this.viewTop, this.viewBottom);\r\n                break;\r\n        }\r\n    },\r\n    //计算位置 根据id\r\n    _calcItemPos(id) {\r\n        let width, height, top, bottom, left, right, itemX, itemY;\r\n        switch (this._align) {\r\n            case cc.Layout.Type.HORIZONTAL:\r\n                switch (this._horizontalDir) {\r\n                    case cc.Layout.HorizontalDirection.LEFT_TO_RIGHT: {\r\n                        if (this._customSize) {\r\n                            let fixed = this._getFixedSize(id);\r\n                            left = this._leftGap + ((this._itemSize.width + this._columnGap) * (id - fixed.count)) + (fixed.val + (this._columnGap * fixed.count));\r\n                            let cs = this._customSize[id];\r\n                            width = (cs > 0 ? cs : this._itemSize.width);\r\n                        } else {\r\n                            left = this._leftGap + ((this._itemSize.width + this._columnGap) * id);\r\n                            width = this._itemSize.width;\r\n                        }\r\n                        if (this.lackCenter) {\r\n                            left -= this._leftGap;\r\n                            let offset = (this.content.width / 2) - (this._allItemSizeNoEdge / 2);\r\n                            left += offset;\r\n                        }\r\n                        right = left + width;\r\n                        return {\r\n                            id: id,\r\n                            left: left,\r\n                            right: right,\r\n                            x: left + (this._itemTmp.anchorX * width),\r\n                            y: this._itemTmp.y,\r\n                        };\r\n                    }\r\n                    case cc.Layout.HorizontalDirection.RIGHT_TO_LEFT: {\r\n                        if (this._customSize) {\r\n                            let fixed = this._getFixedSize(id);\r\n                            right = -this._rightGap - ((this._itemSize.width + this._columnGap) * (id - fixed.count)) - (fixed.val + (this._columnGap * fixed.count));\r\n                            let cs = this._customSize[id];\r\n                            width = (cs > 0 ? cs : this._itemSize.width);\r\n                        } else {\r\n                            right = -this._rightGap - ((this._itemSize.width + this._columnGap) * id);\r\n                            width = this._itemSize.width;\r\n                        }\r\n                        if (this.lackCenter) {\r\n                            right += this._rightGap;\r\n                            let offset = (this.content.width / 2) - (this._allItemSizeNoEdge / 2);\r\n                            right -= offset;\r\n                        }\r\n                        left = right - width;\r\n                        return {\r\n                            id: id,\r\n                            right: right,\r\n                            left: left,\r\n                            x: left + (this._itemTmp.anchorX * width),\r\n                            y: this._itemTmp.y,\r\n                        };\r\n                    }\r\n                }\r\n                break;\r\n            case cc.Layout.Type.VERTICAL: {\r\n                switch (this._verticalDir) {\r\n                    case cc.Layout.VerticalDirection.TOP_TO_BOTTOM: {\r\n                        if (this._customSize) {\r\n                            let fixed = this._getFixedSize(id);\r\n                            top = -this._topGap - ((this._itemSize.height + this._lineGap) * (id - fixed.count)) - (fixed.val + (this._lineGap * fixed.count));\r\n                            let cs = this._customSize[id];\r\n                            height = (cs > 0 ? cs : this._itemSize.height);\r\n                            bottom = top - height;\r\n                        } else {\r\n                            top = -this._topGap - ((this._itemSize.height + this._lineGap) * id);\r\n                            height = this._itemSize.height;\r\n                        }\r\n                        if (this.lackCenter) {\r\n                            top += this._topGap;\r\n                            let offset = (this.content.height / 2) - (this._allItemSizeNoEdge / 2);\r\n                            top -= offset;\r\n                        }\r\n                        bottom = top - height;\r\n                        return {\r\n                            id: id,\r\n                            top: top,\r\n                            bottom: bottom,\r\n                            x: this._itemTmp.x,\r\n                            y: bottom + (this._itemTmp.anchorY * height),\r\n                        };\r\n                    }\r\n                    case cc.Layout.VerticalDirection.BOTTOM_TO_TOP: {\r\n                        if (this._customSize) {\r\n                            let fixed = this._getFixedSize(id);\r\n                            bottom = this._bottomGap + ((this._itemSize.height + this._lineGap) * (id - fixed.count)) + (fixed.val + (this._lineGap * fixed.count));\r\n                            let cs = this._customSize[id];\r\n                            height = (cs > 0 ? cs : this._itemSize.height);\r\n                        } else {\r\n                            bottom = this._bottomGap + ((this._itemSize.height + this._lineGap) * id);\r\n                            height = this._itemSize.height;\r\n                        }\r\n                        if (this.lackCenter) {\r\n                            bottom -= this._bottomGap;\r\n                            let offset = (this.content.height / 2) - (this._allItemSizeNoEdge / 2);\r\n                            bottom += offset;\r\n                        }\r\n                        top = bottom + height;\r\n                        return {\r\n                            id: id,\r\n                            top: top,\r\n                            bottom: bottom,\r\n                            x: this._itemTmp.x,\r\n                            y: bottom + (this._itemTmp.anchorY * height),\r\n                        };\r\n                        break;\r\n                    }\r\n                }\r\n            }\r\n            case cc.Layout.Type.GRID: {\r\n                let colLine = Math.floor(id / this._colLineNum);\r\n                switch (this._startAxis) {\r\n                    case cc.Layout.AxisDirection.HORIZONTAL: {\r\n                        switch (this._verticalDir) {\r\n                            case cc.Layout.VerticalDirection.TOP_TO_BOTTOM: {\r\n                                top = -this._topGap - ((this._itemSize.height + this._lineGap) * colLine);\r\n                                bottom = top - this._itemSize.height;\r\n                                itemY = bottom + (this._itemTmp.anchorY * this._itemSize.height);\r\n                                break;\r\n                            }\r\n                            case cc.Layout.VerticalDirection.BOTTOM_TO_TOP: {\r\n                                bottom = this._bottomGap + ((this._itemSize.height + this._lineGap) * colLine);\r\n                                top = bottom + this._itemSize.height;\r\n                                itemY = bottom + (this._itemTmp.anchorY * this._itemSize.height);\r\n                                break;\r\n                            }\r\n                        }\r\n                        itemX = this._leftGap + ((id % this._colLineNum) * (this._itemSize.width + this._columnGap));\r\n                        switch (this._horizontalDir) {\r\n                            case cc.Layout.HorizontalDirection.LEFT_TO_RIGHT: {\r\n                                itemX += (this._itemTmp.anchorX * this._itemSize.width);\r\n                                itemX -= (this.content.anchorX * this.content.width);\r\n                                break;\r\n                            }\r\n                            case cc.Layout.HorizontalDirection.RIGHT_TO_LEFT: {\r\n                                itemX += ((1 - this._itemTmp.anchorX) * this._itemSize.width);\r\n                                itemX -= ((1 - this.content.anchorX) * this.content.width);\r\n                                itemX *= -1;\r\n                                break;\r\n                            }\r\n                        }\r\n                        return {\r\n                            id: id,\r\n                            top: top,\r\n                            bottom: bottom,\r\n                            x: itemX,\r\n                            y: itemY,\r\n                        };\r\n                    }\r\n                    case cc.Layout.AxisDirection.VERTICAL: {\r\n                        switch (this._horizontalDir) {\r\n                            case cc.Layout.HorizontalDirection.LEFT_TO_RIGHT: {\r\n                                left = this._leftGap + ((this._itemSize.width + this._columnGap) * colLine);\r\n                                right = left + this._itemSize.width;\r\n                                itemX = left + (this._itemTmp.anchorX * this._itemSize.width);\r\n                                itemX -= (this.content.anchorX * this.content.width);\r\n                                break;\r\n                            }\r\n                            case cc.Layout.HorizontalDirection.RIGHT_TO_LEFT: {\r\n                                right = -this._rightGap - ((this._itemSize.width + this._columnGap) * colLine);\r\n                                left = right - this._itemSize.width;\r\n                                itemX = left + (this._itemTmp.anchorX * this._itemSize.width);\r\n                                itemX += ((1 - this.content.anchorX) * this.content.width);\r\n                                break;\r\n                            }\r\n                        }\r\n                        itemY = -this._topGap - ((id % this._colLineNum) * (this._itemSize.height + this._lineGap));\r\n                        switch (this._verticalDir) {\r\n                            case cc.Layout.VerticalDirection.TOP_TO_BOTTOM: {\r\n                                itemY -= ((1 - this._itemTmp.anchorY) * this._itemSize.height);\r\n                                itemY += ((1 - this.content.anchorY) * this.content.height);\r\n                                break;\r\n                            }\r\n                            case cc.Layout.VerticalDirection.BOTTOM_TO_TOP: {\r\n                                itemY -= ((this._itemTmp.anchorY) * this._itemSize.height);\r\n                                itemY += (this.content.anchorY * this.content.height);\r\n                                itemY *= -1;\r\n                                break;\r\n                            }\r\n                        }\r\n                        return {\r\n                            id: id,\r\n                            left: left,\r\n                            right: right,\r\n                            x: itemX,\r\n                            y: itemY,\r\n                        };\r\n                    }\r\n                }\r\n                break;\r\n            }\r\n        }\r\n    },\r\n    //计算已存在的Item的位置\r\n    _calcExistItemPos(id) {\r\n        let item = this.getItemBylistId(id);\r\n        if (!item)\r\n            return null;\r\n        let data = {\r\n            id: id,\r\n            x: item.x,\r\n            y: item.y,\r\n        }\r\n        if (this._sizeType) {\r\n            data.top = item.y + (item.height * (1 - item.anchorY));\r\n            data.bottom = item.y - (item.height * item.anchorY);\r\n        } else {\r\n            data.left = item.x - (item.width * item.anchorX);\r\n            data.right = item.x + (item.width * (1 - item.anchorX));\r\n        }\r\n        return data;\r\n    },\r\n    //获取Item位置\r\n    getItemPos(id) {\r\n        if (this._virtual)\r\n            return this._calcItemPos(id);\r\n        else {\r\n            if (this.frameByFrameRenderNum)\r\n                return this._calcItemPos(id);\r\n            else\r\n                return this._calcExistItemPos(id);\r\n        }\r\n    },\r\n    //获取固定尺寸\r\n    _getFixedSize(listId) {\r\n        if (!this._customSize)\r\n            return null;\r\n        if (listId == null)\r\n            listId = this._numItems;\r\n        let fixed = 0;\r\n        let count = 0;\r\n        for (let id in this._customSize) {\r\n            if (parseInt(id) < listId) {\r\n                fixed += this._customSize[id];\r\n                count++;\r\n            }\r\n        }\r\n        return {\r\n            val: fixed,\r\n            count: count,\r\n        }\r\n    },\r\n    //滚动开始时..\r\n    _onScrollBegan() {\r\n        this._beganPos = this._sizeType ? this.viewTop : this.viewLeft;\r\n    },\r\n    //滚动结束时..\r\n    _onScrollEnded() {\r\n        let t = this;\r\n        t.curScrollistouch = false;\r\n        if (t.scrollTolistId != null) {\r\n            let item = t.getItemBylistId(t.scrollTolistId);\r\n            t.scrollTolistId = null;\r\n            if (item) {\r\n                cc.tween(item)\r\n                    .to(.1, { scale: 1.06 })\r\n                    .to(.1, { scale: 1 })\r\n                    .start();\r\n            }\r\n        }\r\n        t._onScrolling();\r\n\r\n        if (t._slideMode == SlideType.ADHERING &&\r\n            !t.adhering\r\n        ) {\r\n            //cc.log(t.adhering, t._scrollView.isAutoScrolling(), t._scrollView.isScrolling());\r\n            t.adhere();\r\n        } else if (t._slideMode == SlideType.PAGE) {\r\n            if (t._beganPos != null && t.curScrollistouch) {\r\n                this._pageAdhere();\r\n            } else {\r\n                t.adhere();\r\n            }\r\n        }\r\n    },\r\n    // 触摸时\r\n    _onTouchStart(ev, capturelisteners) {\r\n        if (this._scrollView._hasNestedViewGroup(ev, capturelisteners))\r\n            return;\r\n        this.curScrollistouch = true;\r\n        let isMe = ev.eventPhase === cc.Event.AT_TARGET && ev.target === this.node;\r\n        if (!isMe) {\r\n            let itemNode = ev.target;\r\n            while (itemNode._listId == null && itemNode.parent)\r\n                itemNode = itemNode.parent;\r\n            this._scrollItem = itemNode._listId != null ? itemNode : ev.target;\r\n        }\r\n    },\r\n    //触摸抬起时..\r\n    _onTouchUp() {\r\n        let t = this;\r\n        t._scrollPos = null;\r\n        if (t._slideMode == SlideType.ADHERING) {\r\n            if (t.adhering)\r\n                t._adheringBarrier = true;\r\n            t.adhere();\r\n        } else if (t._slideMode == SlideType.PAGE) {\r\n            if (t._beganPos != null) {\r\n                t._pageAdhere();\r\n            } else {\r\n                t.adhere();\r\n            }\r\n        }\r\n        this._scrollItem = null;\r\n    },\r\n\r\n    _onTouchCancelled(ev, capturelisteners) {\r\n        let t = this;\r\n        if (t._scrollView._hasNestedViewGroup(ev, capturelisteners) || ev.simulate)\r\n            return;\r\n\r\n        t._scrollPos = null;\r\n        if (t._slideMode == SlideType.ADHERING) {\r\n            if (t.adhering)\r\n                t._adheringBarrier = true;\r\n            t.adhere();\r\n        } else if (t._slideMode == SlideType.PAGE) {\r\n            if (t._beganPos != null) {\r\n                t._pageAdhere();\r\n            } else {\r\n                t.adhere();\r\n            }\r\n        }\r\n        this._scrollItem = null;\r\n    },\r\n    //当尺寸改变\r\n    _onSizeChanged() {\r\n        if (this.checkInited(false))\r\n            this._onScrolling();\r\n    },\r\n    //当Item自适应\r\n    _onItemAdaptive(item) {\r\n        if (\r\n            (!this._sizeType && item.width != this._itemSize.width)\r\n            || (this._sizeType && item.height != this._itemSize.height)\r\n        ) {\r\n            if (!this._customSize)\r\n                this._customSize = {};\r\n            let val = this._sizeType ? item.height : item.width;\r\n            if (this._customSize[item._listId] != val) {\r\n                this._customSize[item._listId] = val;\r\n                this._resizeContent();\r\n                // this.content.children.forEach(child => {\r\n                //     this._updateItemPos(child);\r\n                // });\r\n                this.updateAll();\r\n                // 如果当前正在运行 scrollTo，肯定会不准确，在这里做修正\r\n                if (this._scrollTolistId != null) {\r\n                    this._scrollPos = null;\r\n                    this.unschedule(this._scrollToSo);\r\n                    this.scrollTo(this._scrollTolistId, Math.max(0, this._scrollToEndTime - ((new Date()).getTime() / 1000)));\r\n                }\r\n            }\r\n        }\r\n        // else {\r\n        //     if (this._customSize) {\r\n        //         delete this._customSize[item._listId];\r\n        //     }\r\n        //     this.updateAll();\r\n        //     this._delRedundantItem();\r\n        // }\r\n    },\r\n    //PAGE粘附\r\n    _pageAdhere() {\r\n        let t = this;\r\n        if (!t.cyclic && (t.elasticTop > 0 || t.elasticRight > 0 || t.elasticBottom > 0 || t.elasticLeft > 0))\r\n            return;\r\n        let curPos = t._sizeType ? t.viewTop : t.viewLeft;\r\n        let dis = (t._sizeType ? t.node.height : t.node.width) * t.pageDistance;\r\n        let canSkip = Math.abs(t._beganPos - curPos) > dis;\r\n        if (canSkip) {\r\n            let timeInSecond = .5;\r\n            switch (t._alignCalcType) {\r\n                case 1://单行HORIZONTAL（LEFT_TO_RIGHT）、网格VERTICAL（LEFT_TO_RIGHT）\r\n                case 4://单列VERTICAL（BOTTOM_TO_TOP）、网格HORIZONTAL（BOTTOM_TO_TOP）\r\n                    if (t._beganPos > curPos) {\r\n                        t.prePage(timeInSecond);\r\n                        // cc.log('_pageAdhere   PPPPPPPPPPPPPPP');\r\n                    } else {\r\n                        t.nextPage(timeInSecond);\r\n                        // cc.log('_pageAdhere   NNNNNNNNNNNNNNN')\r\n                    }\r\n                    break;\r\n                case 2://单行HORIZONTAL（RIGHT_TO_LEFT）、网格VERTICAL（RIGHT_TO_LEFT）\r\n                case 3://单列VERTICAL（TOP_TO_BOTTOM）、网格HORIZONTAL（TOP_TO_BOTTOM）\r\n                    if (t._beganPos < curPos) {\r\n                        t.prePage(timeInSecond);\r\n                    } else {\r\n                        t.nextPage(timeInSecond);\r\n                    }\r\n                    break;\r\n            }\r\n        } else if (t.elasticTop <= 0 && t.elasticRight <= 0 && t.elasticBottom <= 0 && t.elasticLeft <= 0) {\r\n            t.adhere();\r\n        }\r\n        t._beganPos = null;\r\n    },\r\n    //粘附\r\n    adhere() {\r\n        let t = this;\r\n        if (!t.checkInited())\r\n            return;\r\n        if (t.elasticTop > 0 || t.elasticRight > 0 || t.elasticBottom > 0 || t.elasticLeft > 0)\r\n            return;\r\n        t.adhering = true;\r\n        // if (!t._virtual)\r\n        t._calcNearestItem();\r\n        let offset = (t._sizeType ? t._topGap : t._leftGap) / (t._sizeType ? t.node.height : t.node.width);\r\n        let timeInSecond = .7;\r\n        t.scrollTo(t.nearestlistId, timeInSecond, offset);\r\n    },\r\n    //Update..\r\n    update() {\r\n        if (this.frameByFrameRenderNum <= 0 || this._updateDone)\r\n            return;\r\n        // cc.log(this.displayData.length, this._updateCounter, this.displayData[this._updateCounter]);\r\n        if (this._virtual) {\r\n            // let len = Math.min(this._updateCounter + this.frameByFrameRenderNum,this.displayItemNum)\r\n            let len = (this._updateCounter + this.frameByFrameRenderNum) > this.displayItemNum ? this.displayItemNum : (this._updateCounter + this.frameByFrameRenderNum);\r\n            for (let n = this._updateCounter; n < len; n++) {\r\n                let data = this.displayData[n];\r\n                if (data) {\r\n                    // cc.log(data.id);\r\n                    this._createOrUpdateItem(data);\r\n                }\r\n            }\r\n            if (this._updateCounter >= this.displayItemNum - 1) { //最后一个\r\n                // this._updateDone = true;\r\n                // this._delRedundantItem();\r\n                // this._forceUpdate = false;\r\n                // this._calcNearestItem();\r\n                // if (this.slideMode == SlideType.PAGE)\r\n                //     this.curPageNum = this.nearestlistId;\r\n                if (this._doneAfterUpdate) {\r\n                    this._updateCounter = 0;\r\n                    this._updateDone = false;\r\n                    // if (!this._scrollView.isScrolling())  \r\n                    this._doneAfterUpdate = false;\r\n                } else {\r\n                    this._updateDone = true;\r\n                    this._delRedundantItem();\r\n                    this._forceUpdate = false;\r\n                    this._calcNearestItem();\r\n                    if (this.slideMode == SlideType.PAGE)\r\n                        this.curPageNum = this.nearestlistId;\r\n                }\r\n            } else {\r\n                this._updateCounter += this.frameByFrameRenderNum;\r\n            }\r\n\r\n        } else {\r\n            if (this._updateCounter < this._numItems) {\r\n                let len = (this._updateCounter + this.frameByFrameRenderNum) > this._numItems ? this._numItems : (this._updateCounter + this.frameByFrameRenderNum);\r\n                for (let n = this._updateCounter; n < len; n++) {\r\n                    this._createOrUpdateItem2(n);\r\n                }\r\n                this._updateCounter += this.frameByFrameRenderNum;\r\n            } else {\r\n                this._updateDone = true;\r\n                this._calcNearestItem();\r\n                if (this.slideMode == SlideType.PAGE)\r\n                    this.curPageNum = this.nearestlistId;\r\n            }\r\n        }\r\n    },\r\n    /**\r\n     * 创建或更新Item（虚拟列表用）\r\n     * @param {Object} data 数据\r\n     */\r\n    _createOrUpdateItem(data) {\r\n        let item = this.getItemBylistId(data.id);\r\n        if (!item) { //如果不存在\r\n            let canGet = this._pool.size() > 0;\r\n            if (canGet) {\r\n                item = this._pool.get();\r\n                // cc.log('从池中取出::   旧id =', item._listId, '，新id =', data.id, item);\r\n            } else {\r\n                item = cc.instantiate(this._itemTmp);\r\n                // cc.log('新建::', data.id, item);\r\n            }\r\n            if (!canGet || !cc.isValid(item)) {\r\n                item = cc.instantiate(this._itemTmp);\r\n                canGet = false;\r\n            }\r\n            if (item._listId != data.id) {\r\n                item._listId = data.id;\r\n                item.setContentSize(this._itemSize);\r\n            }\r\n            item.setPosition(new cc.v2(data.x, data.y));\r\n            this._resetItemSize(item);\r\n            this.content.addChild(item);\r\n            if (canGet && this._needUpdateWidget) {\r\n                let widget = item.getComponent(cc.Widget);\r\n                if (widget)\r\n                    widget.updateAlignment();\r\n            }\r\n            item.setSiblingIndex(this.content.childrenCount - 1);\r\n\r\n            // console.log(item);\r\n            let listItem = item.getComponent('listItem');\r\n            item.listItem = listItem;\r\n            if (listItem) {\r\n                listItem._list = this;\r\n                listItem._registerEvent();\r\n            }\r\n            if (this.renderEvent) {\r\n                this.renderEvent(item, data.id % this._actualNumItems);\r\n                // cc.Component.EventHandler.emitEvents([this.renderEvent], item, data.id % this._actualNumItems);\r\n            }\r\n        } else if (this._forceUpdate && this.renderEvent) { //强制更新\r\n            item.setPosition(new cc.v2(data.x, data.y));\r\n            this._resetItemSize(item);\r\n            // cc.log('ADD::', data.id);\r\n            if (this.renderEvent) {\r\n                this.renderEvent(item, data.id % this._actualNumItems);\r\n                // cc.Component.EventHandler.emitEvents([this.renderEvent], item, data.id % this._actualNumItems);\r\n            }\r\n        }\r\n        this._resetItemSize(item);\r\n\r\n        this._updatelistItem(item.listItem);\r\n        if (this._lastDisplayData.indexOf(data.id) < 0) {\r\n            this._lastDisplayData.push(data.id);\r\n        }\r\n    },\r\n    //创建或更新Item（非虚拟列表用）\r\n    _createOrUpdateItem2(listId) {\r\n        let item = this.content.children[listId];\r\n        if (!item) { //如果不存在\r\n            item = cc.instantiate(this._itemTmp);\r\n            item._listId = listId;\r\n            this.content.addChild(item);\r\n            let listItem = item.getComponent('listItem');\r\n            item.listItem = listItem;\r\n            if (listItem) {\r\n                listItem._list = this;\r\n                listItem._registerEvent();\r\n            }\r\n            if (this.renderEvent) {\r\n                this.renderEvent(item, listId % this._actualNumItems);\r\n                // cc.Component.EventHandler.emitEvents([this.renderEvent], item, listId % this._actualNumItems);\r\n            }\r\n        } else if (this._forceUpdate && this.renderEvent) { //强制更新\r\n            item._listId = listId;\r\n            if (this.renderEvent) {\r\n                this.renderEvent(item, listId % this._actualNumItems);\r\n                // cc.Component.EventHandler.emitEvents([this.renderEvent], item, listId % this._actualNumItems);\r\n            }\r\n        }\r\n        this._updatelistItem(item.listItem);\r\n        if (this._lastDisplayData.indexOf(listId) < 0) {\r\n            this._lastDisplayData.push(listId);\r\n        }\r\n    },\r\n\r\n    _updatelistItem(listItem) {\r\n        if (!listItem)\r\n            return;\r\n        if (this.selectedMode > SelectedType.NONE) {\r\n            switch (this.selectedMode) {\r\n                case SelectedType.SINGLE:\r\n                    listItem.selected = this.selectedId == listItem.node._listId;\r\n                    break;\r\n                case SelectedType.MULT:\r\n                    listItem.selected = this.multSelected.indexOf(listItem.node._listId) >= 0;\r\n                    break;\r\n            }\r\n        }\r\n    },\r\n    //仅虚拟列表用\r\n    _resetItemSize(item) {\r\n        return;\r\n        let size;\r\n        if (this._customSize && this._customSize[item._listId]) {\r\n            size = this._customSize[item._listId];\r\n        } else {\r\n            if (this._colLineNum > 1)\r\n                item.setContentSize(this._itemSize);\r\n            else\r\n                size = this._sizeType ? this._itemSize.height : this._itemSize.width;\r\n        }\r\n        if (size) {\r\n            if (this._sizeType)\r\n                item.height = size;\r\n            else\r\n                item.width = size;\r\n        }\r\n    },\r\n    /**\r\n     * 更新Item位置\r\n     * @param {Number||Node} listIdOrItem\r\n     */\r\n    _updateItemPos(listIdOrItem) {\r\n        let item = isNaN(listIdOrItem) ? listIdOrItem : this.getItemBylistId(listIdOrItem);\r\n        let pos = this.getItemPos(item._listId);\r\n        item.setPosition(pos.x, pos.y);\r\n    },\r\n    /**\r\n     * 设置多选\r\n     * @param {Array} args 可以是单个listId，也可是个listId数组\r\n     * @param {Boolean} bool 值，如果为null的话，则直接用args覆盖\r\n     */\r\n    setMultSelected(args, bool) {\r\n        let t = this;\r\n        if (!t.checkInited())\r\n            return;\r\n        if (!Array.isArray(args)) {\r\n            args = [args];\r\n        }\r\n        if (bool == null) {\r\n            t.multSelected = args;\r\n        } else {\r\n            let listId, sub;\r\n            if (bool) {\r\n                for (let n = args.length - 1; n >= 0; n--) {\r\n                    listId = args[n];\r\n                    sub = t.multSelected.indexOf(listId);\r\n                    if (sub < 0) {\r\n                        t.multSelected.push(listId);\r\n                    }\r\n                }\r\n            } else {\r\n                for (let n = args.length - 1; n >= 0; n--) {\r\n                    listId = args[n];\r\n                    sub = t.multSelected.indexOf(listId);\r\n                    if (sub >= 0) {\r\n                        t.multSelected.splice(sub, 1);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        t._forceUpdate = true;\r\n        t._onScrolling();\r\n    },\r\n    /**\r\n     * 获取多选数据\r\n     * @returns\r\n     */\r\n    getMultSelected() {\r\n        return this.multSelected;\r\n    },\r\n    /**\r\n     * 多选是否有选择\r\n     * @param {number} listId 索引\r\n     * @returns\r\n     */\r\n    hasMultSelected(listId) {\r\n        return this.multSelected && this.multSelected.indexOf(listId) >= 0;\r\n    },\r\n    /**\r\n     * 更新指定的Item\r\n     * @param {Array} args 单个listId，或者数组\r\n     * @returns\r\n     */\r\n    updateItem(args) {\r\n        if (!this.checkInited())\r\n            return;\r\n        if (!Array.isArray(args)) {\r\n            args = [args];\r\n        }\r\n        for (let n = 0, len = args.length; n < len; n++) {\r\n            let listId = args[n];\r\n            let item = this.getItemBylistId(listId);\r\n            if (item) {\r\n                if(this.renderEvent){\r\n                    this.renderEvent(item, listId % this._actualNumItems);\r\n                }\r\n                // cc.Component.EventHandler.emitEvents([this.renderEvent], item, listId % this._actualNumItems);\r\n            }\r\n        }\r\n    },\r\n    /**\r\n     * 更新全部\r\n     */\r\n    updateAll() {\r\n        if (!this.checkInited())\r\n            return;\r\n        this.numItems = this.numItems;\r\n    },\r\n    /**\r\n     * 根据listID获取Item\r\n     * @param {Number} listId\r\n     * @returns\r\n     */\r\n    getItemBylistId(listId) {\r\n        if (this.content) {\r\n            for (let n = this.content.childrenCount - 1; n >= 0; n--) {\r\n                if (this.content.children[n]._listId == listId)\r\n                    return this.content.children[n];\r\n            }\r\n        }\r\n    },\r\n    /**\r\n     * 获取在显示区域外的Item\r\n     * @returns\r\n     */\r\n    _getOutsideItem() {\r\n        let item;\r\n        let result = [];\r\n        for (let n = this.content.childrenCount - 1; n >= 0; n--) {\r\n            item = this.content.children[n];\r\n            if (!this.displayData.find(d => d.id == item._listId)) {\r\n                result.push(item);\r\n            }\r\n        }\r\n        return result;\r\n    },\r\n    //删除显示区域以外的Item\r\n    _delRedundantItem() {\r\n        if (this._virtual) {\r\n            let arr = this._getOutsideItem();\r\n            for (let n = arr.length - 1; n >= 0; n--) {\r\n                let item = arr[n];\r\n                // 加这一句是为了防止拖动时被卡住...\r\n                if (this._scrollItem && item._listId == this._scrollItem._listId)\r\n                    continue;\r\n                item.isCached = true;\r\n                this._pool.put(item);\r\n                for (let m = this._lastDisplayData.length - 1; m >= 0; m--) {\r\n                    if (this._lastDisplayData[m] == item._listId) {\r\n                        this._lastDisplayData.splice(m, 1);\r\n                        break;\r\n                    }\r\n                }\r\n            }\r\n            // cc.log('存入::', str, '    pool.length =', this._pool.length);\r\n        } else {\r\n            while (this.content.childrenCount > this._numItems) {\r\n                this._delSingleItem(this.content.children[this.content.childrenCount - 1]);\r\n            }\r\n        }\r\n    },\r\n    //删除单个Item\r\n    _delSingleItem(item) {\r\n        // cc.log('DEL::', item._listId, item);\r\n        item.removeFromParent();\r\n        if (item.destroy)\r\n            item.destroy();\r\n        item = null;\r\n    },\r\n    /**\r\n     * 动效删除Item（此方法只适用于虚拟列表，即_virtual=true）\r\n     * 一定要在回调函数里重新设置新的numItems进行刷新，毕竟本list是靠数据驱动的。\r\n     */\r\n    aniDelItem(listId, callFunc, aniType) {\r\n        let t = this;\r\n\r\n        if (!t.checkInited() || t.cyclic || !t._virtual)\r\n            return cc.error('This function is not allowed to be called!');\r\n\r\n        if (!callFunc)\r\n            return cc.error('CallFunc are not allowed to be NULL, You need to delete the corresponding index in the data array in the CallFunc!');\r\n\r\n        if (t._aniDelRuning)\r\n            return cc.warn('Please wait for the current deletion to finish!');\r\n\r\n\r\n        let item = t.getItemBylistId(listId);\r\n        if (!item) {\r\n            callFunc(listId);\r\n            return;\r\n        }\r\n        t._aniDelRuning = true;\r\n        t._aniDelCB = callFunc;\r\n        t._aniDelItem = item;\r\n        t._aniDelBeforePos = item.position;\r\n        t._aniDelBeforeScale = item.scale;\r\n        let curLastId = t.displayData[t.displayData.length - 1].id;\r\n        let resetSelectedId = item.listItem.selected;\r\n        item.listItem.showAni(aniType, () => {\r\n            //判断有没有下一个，如果有的话，创建粗来\r\n            let newId;\r\n            if (curLastId < t._numItems - 2) {\r\n                newId = curLastId + 1;\r\n            }\r\n            if (newId != null) {\r\n                let newData = t._calcItemPos(newId);\r\n                t.displayData.push(newData);\r\n                if (t._virtual)\r\n                    t._createOrUpdateItem(newData);\r\n                else\r\n                    t._createOrUpdateItem2(newId);\r\n            } else\r\n                t._numItems--;\r\n            if (t.selectedMode == SelectedType.SINGLE) {\r\n                if (resetSelectedId) {\r\n                    t._selectedId = -1;\r\n                } else if (t._selectedId - 1 >= 0) {\r\n                    t._selectedId--;\r\n                }\r\n            } else if (t.selectedMode == SelectedType.MULT && t.multSelected.length) {\r\n                let sub = t.multSelected.indexOf(listId);\r\n                // let tmp;\r\n                if (sub >= 0) {\r\n                    t.multSelected.splice(sub, 1);\r\n                }\r\n                //多选的数据，在其后的全部减一\r\n                for (let n = t.multSelected.length - 1; n >= 0; n--) {\r\n                    let id = t.multSelected[n];\r\n                    if (id >= listId)\r\n                        t.multSelected[n]--;\r\n                }\r\n            }\r\n            if (t._customSize) {\r\n                if (t._customSize[listId])\r\n                    delete t._customSize[listId];\r\n                let newCustomSize = {};\r\n                let size;\r\n                for (let id in t._customSize) {\r\n                    size = t._customSize[id];\r\n                    id = parseInt(id);\r\n                    newCustomSize[id - (id >= listId ? 1 : 0)] = size;\r\n                }\r\n                t._customSize = newCustomSize;\r\n            }\r\n            //后面的Item向前怼的动效\r\n            let sec = .2333;\r\n            let tween, haveCB;\r\n            for (let n = newId != null ? newId : curLastId; n >= listId + 1; n--) {\r\n                item = t.getItemBylistId(n);\r\n                if (item) {\r\n                    let posData = t._calcItemPos(n - 1);\r\n                    tween = cc.tween(item)\r\n                        .to(sec, { position: cc.v2(posData.x, posData.y) });\r\n\r\n                    if (n <= listId + 1) {\r\n                        haveCB = true;\r\n                        tween.call(() => {\r\n                            t._aniDelRuning = false;\r\n                            callFunc(listId);\r\n                            delete t._aniDelCB;\r\n                        });\r\n                    }\r\n                    tween.start();\r\n                }\r\n            }\r\n            if (!haveCB) {\r\n                t._aniDelRuning = false;\r\n                callFunc(listId);\r\n                delete t._aniDelCB;\r\n            }\r\n        }, true);\r\n    },\r\n    /**\r\n     * 滚动到..\r\n     * @param {Number} listId 索引（如果<0，则滚到首个Item位置，如果>=_numItems，则滚到最末Item位置）\r\n     * @param {Number} timeInSecond 时间\r\n     * @param {Number} offset 索引目标位置偏移，0-1\r\n     * @param {Boolean} overStress 滚动后是否强调该Item（这只是个实验功能）\r\n     */\r\n    scrollTo(listId, timeInSecond, offset, overStress) {\r\n        let t = this;\r\n        if (!t.checkInited())\r\n            return;\r\n        // t._scrollView.stopAutoScroll();\r\n        if (timeInSecond == null)   //默认0.5\r\n            timeInSecond = .5;\r\n        else if (timeInSecond < 0)\r\n            timeInSecond = 0;\r\n        if (listId < 0)\r\n            listId = 0;\r\n        else if (listId >= t._numItems)\r\n            listId = t._numItems - 1;\r\n        // 以防设置了numItems之后layout的尺寸还未更新\r\n        if (!t._virtual && t._layout && t._layout.enabled)\r\n            t._layout.updateLayout();\r\n\r\n        let pos = t.getItemPos(listId);\r\n        if (!pos) {\r\n            return CC_DEV && cc.error('pos is null', listId);\r\n        }\r\n        let targetX, targetY;\r\n\r\n        switch (t._alignCalcType) {\r\n            case 1://单行HORIZONTAL（LEFT_TO_RIGHT）、网格VERTICAL（LEFT_TO_RIGHT）\r\n                targetX = pos.left;\r\n                if (offset != null)\r\n                    targetX -= t.node.width * offset;\r\n                else\r\n                    targetX -= t._leftGap;\r\n                pos = new cc.v2(targetX, 0);\r\n                break;\r\n            case 2://单行HORIZONTAL（RIGHT_TO_LEFT）、网格VERTICAL（RIGHT_TO_LEFT）\r\n                targetX = pos.right - t.node.width;\r\n                if (offset != null)\r\n                    targetX += t.node.width * offset;\r\n                else\r\n                    targetX += t._rightGap;\r\n                pos = new cc.v2(targetX + t.content.width, 0);\r\n                break;\r\n            case 3://单列VERTICAL（TOP_TO_BOTTOM）、网格HORIZONTAL（TOP_TO_BOTTOM）\r\n                targetY = pos.top;\r\n                if (offset != null)\r\n                    targetY += t.node.height * offset;\r\n                else\r\n                    targetY += t._topGap;\r\n                pos = new cc.v2(0, -targetY);\r\n                break;\r\n            case 4://单列VERTICAL（BOTTOM_TO_TOP）、网格HORIZONTAL（BOTTOM_TO_TOP）\r\n                targetY = pos.bottom + t.node.height;\r\n                if (offset != null)\r\n                    targetY -= t.node.height * offset;\r\n                else\r\n                    targetY -= t._bottomGap;\r\n                pos = new cc.v2(0, -targetY + t.content.height);\r\n                break;\r\n        }\r\n        let viewPos = t.content.getPosition();\r\n        viewPos = Math.abs(t._sizeType ? viewPos.y : viewPos.x);\r\n\r\n        let comparePos = t._sizeType ? pos.y : pos.x;\r\n        let runScroll = Math.abs((t._scrollPos != null ? t._scrollPos : viewPos) - comparePos) > .5;\r\n        // cc.log(runScroll, t._scrollPos, viewPos, comparePos)\r\n\r\n        // t._scrollView.stopAutoScroll();\r\n\r\n        if (runScroll) {\r\n            t._scrollPos = comparePos;\r\n            t._scrollTolistId = listId;\r\n            t._scrollToEndTime = ((new Date()).getTime() / 1000) + timeInSecond;\r\n            t._scrollView.scrollToOffset(pos, timeInSecond);\r\n            // cc.log(listId, t.content.height, t.content.getPosition().y, pos.y);\r\n            t._scrollToSo = t.scheduleOnce(() => {\r\n                if (!t._adheringBarrier) {\r\n                    t.adhering = t._adheringBarrier = false;\r\n                }\r\n                t._scrollPos =\r\n                    t._scrollTolistId =\r\n                    t._scrollToEndTime =\r\n                    t._scrollToSo =\r\n                    null;\r\n                //cc.log('2222222222', t._adheringBarrier)\r\n                if (overStress) {\r\n                    // t.scrollTolistId = listId;\r\n                    let item = t.getItemBylistId(listId);\r\n                    if (item) {\r\n                        cc.tween(item)\r\n                            .to(.1, { scale: 1.05 })\r\n                            .to(.1, { scale: 1 })\r\n                            .start();\r\n                    }\r\n                }\r\n            }, timeInSecond + .1);\r\n\r\n            if (timeInSecond <= 0) {\r\n                t._onScrolling();\r\n            }\r\n        }\r\n    },\r\n    /**\r\n     * 计算当前滚动窗最近的Item\r\n     */\r\n    _calcNearestItem() {\r\n        let t = this;\r\n        t.nearestlistId = null;\r\n        let data, center;\r\n\r\n        if (t._virtual)\r\n            t._calcViewPos();\r\n\r\n        let vTop, vRight, vBottom, vLeft;\r\n        vTop = t.viewTop;\r\n        vRight = t.viewRight;\r\n        vBottom = t.viewBottom;\r\n        vLeft = t.viewLeft;\r\n\r\n        let breakFor = false;\r\n        for (let n = 0; n < t.content.childrenCount && !breakFor; n += t._colLineNum) {\r\n            data = this._virtual ? this.displayData[n] : this._calcExistItemPos(n);\r\n            if (data) {\r\n                center = this._sizeType ? ((data.top + data.bottom) / 2) : (center = (data.left + data.right) / 2);\r\n                switch (this._alignCalcType) {\r\n                    case 1://单行HORIZONTAL（LEFT_TO_RIGHT）、网格VERTICAL（LEFT_TO_RIGHT）\r\n                        if (data.right >= vLeft) {\r\n                            this.nearestlistId = data.id;\r\n                            if (vLeft > center)\r\n                                this.nearestlistId += this._colLineNum;\r\n                            breakFor = true;\r\n                        }\r\n                        break;\r\n                    case 2://单行HORIZONTAL（RIGHT_TO_LEFT）、网格VERTICAL（RIGHT_TO_LEFT）\r\n                        if (data.left <= vRight) {\r\n                            this.nearestlistId = data.id;\r\n                            if (vRight < center)\r\n                                this.nearestlistId += this._colLineNum;\r\n                            breakFor = true;\r\n                        }\r\n                        break;\r\n                    case 3://单列VERTICAL（TOP_TO_BOTTOM）、网格HORIZONTAL（TOP_TO_BOTTOM）\r\n                        if (data.bottom <= vTop) {\r\n                            this.nearestlistId = data.id;\r\n                            if (vTop < center)\r\n                                this.nearestlistId += this._colLineNum;\r\n                            breakFor = true;\r\n                        }\r\n                        break;\r\n                    case 4://单列VERTICAL（BOTTOM_TO_TOP）、网格HORIZONTAL（BOTTOM_TO_TOP）\r\n                        if (data.top >= vBottom) {\r\n                            this.nearestlistId = data.id;\r\n                            if (vBottom > center)\r\n                                this.nearestlistId += this._colLineNum;\r\n                            breakFor = true;\r\n                        }\r\n                        break;\r\n                }\r\n            }\r\n        }\r\n        //判断最后一个Item。。。（哎，这些判断真心恶心，判断了前面的还要判断最后一个。。。一开始呢，就只有一个布局（单列布局），那时候代码才三百行，后来就想着完善啊，艹..这坑真深，现在这行数都一千五了= =||）\r\n        data = this._virtual ? this.displayData[this.displayItemNum - 1] : this._calcExistItemPos(this._numItems - 1);\r\n        if (data && data.id == t._numItems - 1) {\r\n            center = t._sizeType ? ((data.top + data.bottom) / 2) : (center = (data.left + data.right) / 2);\r\n            switch (t._alignCalcType) {\r\n                case 1://单行HORIZONTAL（LEFT_TO_RIGHT）、网格VERTICAL（LEFT_TO_RIGHT）\r\n                    if (vRight > center)\r\n                        t.nearestlistId = data.id;\r\n                    break;\r\n                case 2://单行HORIZONTAL（RIGHT_TO_LEFT）、网格VERTICAL（RIGHT_TO_LEFT）\r\n                    if (vLeft < center)\r\n                        t.nearestlistId = data.id;\r\n                    break;\r\n                case 3://单列VERTICAL（TOP_TO_BOTTOM）、网格HORIZONTAL（TOP_TO_BOTTOM）\r\n                    if (vBottom < center)\r\n                        t.nearestlistId = data.id;\r\n                    break;\r\n                case 4://单列VERTICAL（BOTTOM_TO_TOP）、网格HORIZONTAL（BOTTOM_TO_TOP）\r\n                    if (vTop > center)\r\n                        t.nearestlistId = data.id;\r\n                    break;\r\n            }\r\n        }\r\n        // cc.log('t.nearestlistId =', t.nearestlistId);\r\n    },\r\n    //上一页\r\n    prePage(timeInSecond) {\r\n        // cc.log('👈');\r\n        if (!this.checkInited())\r\n            return;\r\n        if (timeInSecond == null)\r\n            timeInSecond = .5;\r\n        this.skipPage(this.curPageNum - 1, timeInSecond);\r\n    },\r\n    //下一页\r\n    nextPage(timeInSecond) {\r\n        // cc.log('👉');\r\n        if (!this.checkInited())\r\n            return;\r\n        if (timeInSecond == null)\r\n            timeInSecond = .5;\r\n        this.skipPage(this.curPageNum + 1, timeInSecond);\r\n    },\r\n    //跳转到第几页\r\n    skipPage(pageNum, timeInSecond) {\r\n        let t = this;\r\n        if (!t.checkInited())\r\n            return;\r\n        if (t._slideMode != SlideType.PAGE)\r\n            return cc.error('This function is not allowed to be called, Must SlideMode = PAGE!');\r\n        if (pageNum < 0 || pageNum >= t._numItems)\r\n            return;\r\n        if (t.curPageNum == pageNum)\r\n            return;\r\n        // cc.log(pageNum);\r\n        t.curPageNum = pageNum;\r\n        if (t.pageChangeEvent) {\r\n            cc.Component.EventHandler.emitEvents([t.pageChangeEvent], pageNum);\r\n        }\r\n        t.scrollTo(pageNum, timeInSecond);\r\n    },\r\n    //计算 CustomSize（这个函数还是保留吧，某些罕见的情况的确还是需要手动计算customSize的）\r\n    calcCustomSize(numItems) {\r\n        let t = this;\r\n        if (!t.checkInited())\r\n            return;\r\n        if (!t._itemTmp)\r\n            return cc.error('Unset template item!');\r\n        if (!t.renderEvent)\r\n            return cc.error('Unset Render-Event!');\r\n        t._customSize = {};\r\n        let temp = cc.instantiate(t._itemTmp);\r\n        t.content.addChild(temp);\r\n        for (let n = 0; n < numItems; n++) {\r\n            t.renderEvent(temp, n);\r\n            // cc.Component.EventHandler.emitEvents([t.renderEvent], temp, n);\r\n            if (temp.height != t._itemSize.height || temp.width != t._itemSize.width) {\r\n                t._customSize[n] = t._sizeType ? temp.height : temp.width;\r\n            }\r\n        }\r\n        if (!Object.keys(t._customSize).length)\r\n            t._customSize = null;\r\n        temp.removeFromParent();\r\n        if (temp.destroy)\r\n            temp.destroy();\r\n        return t._customSize;\r\n    },\r\n\r\n});"]}