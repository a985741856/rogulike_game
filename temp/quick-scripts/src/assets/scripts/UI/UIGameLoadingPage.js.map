{"version":3,"sources":["assets\\scripts\\UI\\UIGameLoadingPage.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;AAAA,8CAAyC;AACzC,kDAA2D;AAC3D,8CAA6C;AAC7C,2CAA0C;AAEpC,IAAA,KAAwB,EAAE,CAAC,UAAU,EAAnC,OAAO,aAAA,EAAE,QAAQ,cAAkB,CAAC;AAG5C;IAA+C,qCAAM;IAIjD;QAAA,YACI,kBAAM,mBAAQ,CAAC,iBAAiB,CAAC,SAEpC;QALO,gBAAU,GAAW,CAAC,CAAC;QAI3B,KAAI,CAAC,OAAO,EAAE,IAAI,KAAI,CAAC,MAAM,EAAE,CAAC;;IACpC,CAAC;IAES,kCAAM,GAAhB;QACI,EAAE,CAAC,IAAI,CAAC,EAAE,CAAC,kBAAQ,CAAC,YAAY,EAAE,IAAI,CAAC,qBAAqB,EAAE,IAAI,CAAC,CAAC;QACpE,IAAI,CAAC,UAAU,GAAG,IAAI,IAAI,EAAE,CAAC,OAAO,EAAE,CAAC;QACvC,eAAM,CAAC,YAAY,CAAC;YAChB,eAAM,CAAC,QAAQ,CAAC,UAAU,CAAC,IAAI,EAAE,IAAI,EAAE,CAAC,CAAC,CAAC;QAC9C,CAAC,EAAE,GAAG,CAAC,CAAC;IACZ,CAAC;IAES,mCAAO,GAAjB;QACI,EAAE,CAAC,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,CAAC;QACxB,uBAAU,CAAC,SAAS,EAAE,CAAC;QACvB,uBAAU,CAAC,IAAI,CAAC,MAAM,GAAG,EAAE,CAAC,KAAK,CAAC,UAAU,CAAC;QAC7C,eAAM,CAAC,QAAQ,CAAC,UAAU,CAAC,IAAI,CAAC,CAAC;IACrC,CAAC;IAEO,iDAAqB,GAA7B,UAA8B,KAAU;QACpC,QAAQ,KAAK,CAAC,IAAI,EAAE;YAChB,KAAK,kBAAQ,CAAC,iBAAiB,CAAC,CAAC;gBAC7B,IAAI,CAAC,eAAe,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC;gBACjC,MAAM;aACT;SACJ;IACL,CAAC;IAEO,2CAAe,GAAvB,UAAwB,GAAW;QAC/B,IAAI,GAAG,IAAI,CAAC,EAAE;YACV,IAAI,OAAO,GAAG,IAAI,IAAI,EAAE,CAAC,OAAO,EAAE,GAAG,IAAI,CAAC,UAAU,CAAC;YACrD,IAAI,OAAO,IAAI,IAAI,EAAE;gBACjB,eAAM,CAAC,KAAK,CAAC,QAAQ,CAAC,mBAAQ,CAAC,UAAU,CAAC,CAAC;aAC9C;iBAAM;gBACH,UAAU,CAAC;oBACP,eAAM,CAAC,KAAK,CAAC,QAAQ,CAAC,mBAAQ,CAAC,UAAU,CAAC,CAAC;gBAC/C,CAAC,EAAE,IAAI,GAAG,OAAO,CAAC,CAAC;aACtB;SACJ;IACL,CAAC;IA5CgB,iBAAiB;QADrC,OAAO;OACa,iBAAiB,CA8CrC;IAAD,wBAAC;CA9CD,AA8CC,CA9C8C,gBAAM,GA8CpD;kBA9CoB,iBAAiB","file":"","sourceRoot":"/","sourcesContent":["import UIPage from \"../Framework/UIPage\";\r\nimport Constant, { PageName } from \"../Framework/Constant\";\r\nimport { cocosz } from \"../Framework/CocosZ\";\r\nimport { guideLayer } from \"./GuideLayer\";\r\n\r\nconst { ccclass, property } = cc._decorator;\r\n\r\n@ccclass\r\nexport default class UIGameLoadingPage extends UIPage {\r\n\r\n    private _startTime: number = 0;\r\n\r\n    constructor() {\r\n        super(PageName.UIGameLoadingPage);\r\n        this.isValid() && this.onLoad();\r\n    }\r\n\r\n    protected onOpen(): void {\r\n        cc.game.on(Constant.E_GAME_LOGIC, this._onGameMessageHandler, this);\r\n        this._startTime = new Date().getTime();\r\n        cocosz.scheduleOnce(() => {\r\n            cocosz.audioMgr.playEffect(\"fj\", true, 1);\r\n        }, 0.1);\r\n    }\r\n\r\n    protected onClose() {\r\n        cc.game.targetOff(this);\r\n        guideLayer.hideFjAni();\r\n        guideLayer.node.zIndex = cc.macro.MIN_ZINDEX;\r\n        cocosz.audioMgr.stopEffect(\"fj\");\r\n    }\r\n\r\n    private _onGameMessageHandler(event: any) {\r\n        switch (event.type) {\r\n            case Constant.E_UPDATE_PROGRESS: {\r\n                this._updateProgress(event.data);\r\n                break;\r\n            }\r\n        }\r\n    }\r\n\r\n    private _updateProgress(pro: number) {\r\n        if (pro >= 1) {\r\n            let difTime = new Date().getTime() - this._startTime;\r\n            if (difTime >= 6000) {\r\n                cocosz.uiMgr.openPage(PageName.UIGamePage);\r\n            } else {\r\n                setTimeout(() => {\r\n                    cocosz.uiMgr.openPage(PageName.UIGamePage);\r\n                }, 6000 - difTime);\r\n            }\r\n        }\r\n    }\r\n\r\n}\r\n"]}