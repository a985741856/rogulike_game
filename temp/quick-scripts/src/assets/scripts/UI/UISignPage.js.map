{"version":3,"sources":["assets\\scripts\\UI\\UISignPage.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import UIPage from \"../Framework/UIPage\";\r\nimport Constant, { PageName, PanelName } from \"../Framework/Constant\";\r\nimport { cocosz } from \"../Framework/CocosZ\";\r\nimport Msg from \"../Framework/Msg\";\r\nimport FlyCoin from \"../Framework/FlyCoin\";\r\nimport { utils } from \"../../common-plugin/Scripts/Utils\";\r\nimport TweenEffect from \"../Framework/TweenEffect\";\r\n// @ts-ignore\r\nconst i18n = require('LanguageData');\r\n\r\n\r\nconst { ccclass, property } = cc._decorator;\r\n\r\n\r\nconst REWARD_SIGN: number[] = [500, 1000, 1500, 50, 2000, 2500, 100];\r\n\r\nclass DayItem {\r\n    private _index: number = -1;\r\n    private _node: cc.Node = null;\r\n\r\n    private _normal: cc.Node = null;\r\n    private _current: cc.Node = null;\r\n    private _got: cc.Node = null;\r\n    private _label: cc.Label = null;\r\n\r\n    constructor(index: number, node: cc.Node) {\r\n        this._index = index;\r\n        this._node = node;\r\n\r\n        this._normal = this._node.getChildByName(\"st1\");\r\n        this._current = this._node.getChildByName(\"st2\");\r\n        this._got = this._node.getChildByName(\"st3\");\r\n\r\n        if (this._node.getChildByName(\"rewardLabel\")) {\r\n            this._label = this._node.getChildByName(\"rewardLabel\").getComponent(cc.Label);\r\n            this._label.node.scale = 0.7;\r\n            this._label.node.setPosition(this._node.x, this._node.y - 60);\r\n            this._label.node.setParent(this._node.parent);\r\n            this._label.string = \"+\" + REWARD_SIGN[this._index];\r\n        }\r\n    }\r\n\r\n    public setStatus(status: number) {\r\n        if (status == 0) {\r\n            this._normal.active = true;\r\n            this._current.active = false;\r\n            this._got.active = false;\r\n            this._label.node.active = true;\r\n        }\r\n        else if (status == 1) {\r\n            this._normal.active = false;\r\n            this._current.active = true;\r\n            this._got.active = false;\r\n            this._label.node.active = true;\r\n        }\r\n        else if (status == 2) {\r\n            this._normal.active = true;\r\n            this._current.active = false;\r\n            this._got.active = true;\r\n            this._label.node.active = false;\r\n        }\r\n    }\r\n\r\n    public update() {\r\n        // 上一次领取的是第几天,从0开始\r\n        let lastDayIndex: number = cocosz.dataMgr.LastDailyBonusIndex;\r\n        // 超过一天, 重置一下天数\r\n        if (lastDayIndex == 6) {\r\n            lastDayIndex = -1;\r\n        }\r\n        // 上次领取的时间\r\n        const lastDayTime: string = cocosz.dataMgr.LastDailyBonusTime;\r\n        let canGet: boolean = false;\r\n        if (new Date().toDateString() != lastDayTime && this._index == lastDayIndex + 1) {\r\n            canGet = true;\r\n        }\r\n        // cc.log(`lastDayIndex: ${lastDayIndex} --- lastDayTime: ${lastDayTime}`);\r\n\r\n        // this._got.active = false;\r\n        // this._normal.active = false;\r\n        // this._current.active = false;\r\n        if (this._index <= lastDayIndex) {\r\n            // 已经领取过了\r\n            // this._got.active = true;\r\n            this.setStatus(2)\r\n        } else {\r\n            if (canGet) {\r\n                this.setStatus(1)\r\n                // this._current.active = true;\r\n            } else {\r\n                this.setStatus(0)\r\n                // this._normal.active = true;\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\n@ccclass\r\nexport default class UISignPanel extends UIPage {\r\n\r\n    private _mask: cc.Node = null;\r\n    private _panel: cc.Node = null;\r\n    private _btnGet: cc.Node = null;\r\n    private _btnDouble: cc.Node = null;\r\n    private _btnClose: cc.Node = null;\r\n    private _day: DayItem[] = [];\r\n\r\n\r\n    constructor() {\r\n        super(PanelName.UISignPanel);\r\n        this.isValid() && this.onLoad();\r\n    }\r\n\r\n    protected onLoad() {\r\n        this._panel = this._page.getChildByName(\"Panel\");\r\n        this._mask = this._page.getChildByName(\"mask\");\r\n        let btnNames: string[] = [\"BtnClose\", \"BtnDouble\", \"BtnGet\"];\r\n        for (let i = 0; i < btnNames.length; i++) {\r\n            let btn: cc.Node = cc.find(btnNames[i], this._panel);\r\n            if (!btn) continue\r\n            btn.on(cc.Node.EventType.TOUCH_END, this._onBtnClickedHandler, this);\r\n\r\n            if (btn.name == \"BtnGet\") {\r\n                this._btnGet = btn;\r\n            } else if (btn.name == \"BtnDouble\") {\r\n                this._btnDouble = btn;\r\n                this._btnDouble.active = cocosz.isADON;\r\n            }\r\n            else {\r\n                this._btnClose = btn;\r\n            }\r\n        }\r\n\r\n        for (let i = 0; i < 6; i++) {\r\n            let dayItem: DayItem = new DayItem(i, this._panel.getChildByName(\"Day_\" + (i + 1)));\r\n            this._day.push(dayItem);\r\n        }\r\n\r\n    }\r\n\r\n    protected onOpen() {\r\n        // 上报 首页签到\r\n        utils.umaEvent(\"gamegamesign\");\r\n        utils.SendEvent(\"页面-签到\");\r\n        this._initPanel();\r\n    }\r\n\r\n    private _initPanel() {\r\n        TweenEffect.panel_open_scale(this._panel);\r\n        // 缩放\r\n        this._updateDayItem();\r\n    }\r\n\r\n    private _updateDayItem() {\r\n        for (let i = 0; i < 6; i++) {\r\n            this._day[i].update();\r\n        }\r\n    }\r\n\r\n    private async _onBtnClickedHandler(event: cc.Event, data: any) {\r\n        cocosz.audioMgr.playBtnEffect();\r\n        \r\n        switch (event.target.name) {\r\n            case \"BtnGet\": {\r\n                if (!this._canGetBonus()) {\r\n                    Msg.Show(i18n.t(\"msg.jryqd\"));//今日已领取奖励\r\n                    return;\r\n                }\r\n                this._getReward(false);\r\n                break;\r\n            }\r\n            case \"BtnDouble\": {\r\n                if (!this._canGetBonus()) {\r\n                    Msg.Show(i18n.t(\"msg.jryqd\"));//今日已领取奖励\r\n                    return;\r\n                }\r\n                // utils.SendEvent(\"视频-双倍签到-播放\")\r\n                // cocosz.watchAD(() => {\r\n                //     utils.SendEvent(\"视频-双倍签到-成功\")\r\n                //     this._getReward(true);\r\n                // }, () => {\r\n                //     utils.SendEvent(\"视频-双倍签到-失败\")\r\n                // });\r\n                    this._getReward(true);\r\n                    utils.SendEvent(\"视频-双倍签到-成功\")\r\n                break;\r\n            }\r\n            case \"BtnClose\": {\r\n                cocosz.uiMgr.closePanel(PanelName.UISignPanel);\r\n                break;\r\n            }\r\n        }\r\n    }\r\n\r\n    private _getReward(double: boolean) {\r\n        if (double == false) {\r\n            // 上报 普通签到\r\n            utils.umaEvent(\"gamesignordinary\");\r\n            utils.SendEvent(\"签到-普通\");\r\n        } else {\r\n            // 上报 双倍签到\r\n            utils.umaEvent(\"gamedoublesign\");\r\n            utils.SendEvent(\"签到-双倍\");\r\n        }\r\n\r\n        // 签到索引\r\n        let lastDayIndex: number = cocosz.dataMgr.LastDailyBonusIndex;\r\n        if (lastDayIndex == 6) {\r\n            lastDayIndex = -1;\r\n        }\r\n        let curDayIndex = lastDayIndex + 1;\r\n        // 奖励数量\r\n        let count: number = REWARD_SIGN[curDayIndex];\r\n        if (double) { count *= 2; }\r\n        if (curDayIndex == 3 || curDayIndex == 6) {\r\n            // 钻石\r\n            Msg.Show(i18n.t(\"msg.gxhdzs\") + count);\r\n            cocosz.dataMgr.DiamondCount += count;\r\n            // 飞金币事件\r\n            setTimeout(() => {\r\n                cc.game.emit(Constant.E_GAME_LOGIC, { type: Constant.E_Fly_Coin, iconName: 'diamond', frameNodeName: 'CoinLabel2' })\r\n            }, 500);\r\n        } else {\r\n            // 金币\r\n            Msg.Show(i18n.t(\"msg.gxhdjb\") + count);\r\n            cocosz.dataMgr.CoinCount += count;\r\n            // 飞金币事件\r\n            setTimeout(() => {\r\n                cc.game.emit(Constant.E_GAME_LOGIC, { type: Constant.E_Fly_Coin, iconName: 'coin', frameNodeName: 'CoinLabel' })\r\n            }, 500);\r\n        }\r\n        // 本地信息\r\n        cocosz.dataMgr.LastDailyBonusIndex = curDayIndex;\r\n        cocosz.dataMgr.LastDailyBonusTime = new Date().toDateString();\r\n        // 刷新UI\r\n        // this._updateDayItem();\r\n        // 关闭弹窗\r\n        cocosz.uiMgr.closePanel(PanelName.UISignPanel);\r\n    }\r\n\r\n    private _canGetBonus() {\r\n        return (new Date().toDateString() != cocosz.dataMgr.LastDailyBonusTime);\r\n    }\r\n\r\n}\r\n"]}