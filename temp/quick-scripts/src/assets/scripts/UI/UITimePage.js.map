{"version":3,"sources":["assets\\scripts\\UI\\UITimePage.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import UIPage from \"../Framework/UIPage\";\r\nimport { PanelName } from \"../Framework/Constant\";\r\nimport { cocosz } from \"../Framework/CocosZ\";\r\nimport { utils } from \"../../common-plugin/Scripts/Utils\";\r\nimport TweenEffect from \"../Framework/TweenEffect\";\r\nimport GameDate from \"../Game/gameDate\";\r\n\r\nconst { ccclass, property } = cc._decorator;\r\n\r\nclass ItemTime {\r\n    private _id: number = 0;\r\n    private _node: cc.Node = null;\r\n    private _info: { time: number, coinNum: number, diamondNum: number };\r\n\r\n    private _txt_zxsc: cc.Node = null;\r\n    private _txt_ylq: cc.Node = null;\r\n    private _btn: cc.Node = null;\r\n    private _label_coin: cc.Label = null;\r\n    private _label_diamond: cc.Label = null;\r\n    private _label_time: cc.Label = null;\r\n\r\n    constructor(i, n: cc.Node) {\r\n        this._id = i;\r\n        this._node = n;\r\n        this._info = GameDate.TimeReward[i];\r\n\r\n        this._txt_zxsc = this._node.getChildByName(\"txt_zxsc\");\r\n        this._txt_ylq = this._node.getChildByName(\"txt_ylq\");\r\n        this._btn = this._node.getChildByName(\"btn\");\r\n        this._btn.on(cc.Node.EventType.TOUCH_END, this.click, this);\r\n        this._label_coin = this._node.getChildByName(\"label_coin\").getComponent(cc.Label);\r\n        this._label_coin.string = this._info.coinNum + \"\";\r\n        this._label_diamond = this._node.getChildByName(\"label_diamond\").getComponent(cc.Label);\r\n        this._label_diamond.string = this._info.diamondNum + \"\";\r\n        this._label_time = this._node.getChildByName(\"label_time\").getComponent(cc.Label);\r\n        this._label_time.string = cocosz.StoHMS(this._info.time);\r\n    }\r\n\r\n    click() {\r\n        // 领取奖励\r\n        let arrRecieve = cocosz.dataMgr.receiveToday;\r\n        if (arrRecieve[this._id] == 0) { \r\n            cocosz.audioMgr.playBtnEffect();\r\n            arrRecieve[this._id] = 1;\r\n            cocosz.dataMgr.receiveToday = arrRecieve;\r\n            this.update();\r\n\r\n            cocosz.dataMgr.CoinCount += this._info.coinNum;\r\n            cocosz.dataMgr.DiamondCount += this._info.diamondNum;\r\n        }\r\n    }\r\n\r\n    update() {\r\n        // 时间达到\r\n        if (cocosz.dataMgr.OnlineToday >= this._info.time) {\r\n            let arrRecieve = cocosz.dataMgr.receiveToday;\r\n            // 已领取\r\n            if (arrRecieve[this._id]) {\r\n                this._btn.active = this._txt_zxsc.active = this._label_time.node.active = false;\r\n                this._txt_ylq.active = true;\r\n            }\r\n            // 待领取\r\n            else {\r\n                this._txt_ylq.active = this._txt_zxsc.active = this._label_time.node.active = false;\r\n                this._btn.active = true;\r\n            }\r\n        }\r\n        // 时间未达到\r\n        else {\r\n            this._txt_ylq.active = this._btn.active = false;\r\n            this._txt_zxsc.active = this._label_time.node.active = true;\r\n        }\r\n    }\r\n\r\n}\r\n\r\n/**\r\n * 皮肤试用面板\r\n */\r\n@ccclass\r\nexport default class UITimePanel extends UIPage {\r\n\r\n    private mask: cc.Node = null;\r\n    private panel: cc.Node = null;\r\n\r\n    private label_online: cc.Label = null;\r\n    private itemList: ItemTime[] = [];\r\n\r\n    constructor() {\r\n        super(PanelName.UITimePanel);\r\n        this.isValid() && this.onLoad();\r\n    }\r\n\r\n    protected onLoad() {\r\n        this.mask = this._page.getChildByName(\"mask\");\r\n        this.panel = this._page.getChildByName(\"panel\");\r\n        // 按钮\r\n        let btnNames: string[] = [\"BtnBack\"];\r\n        for (let i = 0; i < btnNames.length; i++) {\r\n            let btn: cc.Node = cc.find(btnNames[i], this.panel);\r\n            if (btn) {\r\n                btn.on(cc.Node.EventType.TOUCH_END, this._onBtnClickedHandler, this);\r\n            }\r\n        }\r\n        // 在线时间\r\n        this.label_online = this.panel.getChildByName(\"label_online\").getComponent(cc.Label);\r\n    }\r\n\r\n    protected onOpen() {\r\n        utils.SendEvent(\"页面-在线奖励\");\r\n        this._initPanel();\r\n    }\r\n\r\n    protected onClose(): void { }\r\n\r\n    private _initPanel() {\r\n        TweenEffect.panel_mask_opacity(this.mask)\r\n        TweenEffect.panel_open_moveY(this.panel);\r\n\r\n        // 列表\r\n        for (let i = 0; i < 5; i++) {\r\n            let n = this.panel.getChildByName(\"item\" + i);\r\n            if (n) {\r\n                let item = new ItemTime(i, n);\r\n                this.itemList.push(item);\r\n            }\r\n        }\r\n\r\n        cc.tween(this._page)\r\n            .call(() => { this.updateTime(); })\r\n            .delay(1)\r\n            .union()\r\n            .repeatForever()\r\n            .start();\r\n    }\r\n\r\n    updateTime() {\r\n        // 显示在线时间\r\n        this.label_online.string = cocosz.StoHMS(cocosz.dataMgr.OnlineToday);\r\n        // 更新列表\r\n        this.itemList.forEach(v => {\r\n            v.update();\r\n        })\r\n\r\n    }\r\n\r\n    /**\r\n     * 所有按钮点击事件\r\n     * @param event \r\n     * @param data \r\n     */\r\n    private async _onBtnClickedHandler(event: cc.Event, data: any) {\r\n        cocosz.audioMgr.playBtnEffect();\r\n\r\n        switch (event.target.name) {\r\n            case \"BtnBack\": {\r\n                TweenEffect.panel_close_moveY(this.panel, () => {\r\n                    cocosz.uiMgr.closePanel(PanelName.UITimePanel);\r\n                });\r\n                break;\r\n            }\r\n        }\r\n    }\r\n\r\n\r\n}\r\n"]}