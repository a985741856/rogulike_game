{"version":3,"sources":["assets\\common-plugin\\Scripts\\AdAgentXiaomi.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import AdAgent from \"./AdAgent\";\r\nimport { BannerLocation } from \"./YZ_Constant\";\r\nimport PlatUtils from \"./PlatUtils\";\r\nimport { utils } from \"./Utils\";\r\nimport { NativeBannerInfo } from \"./CommonConfig\";\r\nimport CompatibleTool from \"./CompatibleTool\";\r\nimport YZ_NativeBanner from \"./YZ_NativeBanner\";\r\n\r\nconst { ccclass, property } = cc._decorator;\r\n\r\n@ccclass\r\nexport default class AdAgentXiaoMi extends AdAgent {\r\n\r\n    _bannerAd: any = null;\r\n    _insertAd: any = null;\r\n    _videoAd: any = null;\r\n\r\n    _nativeBannerAd: any[] = [];\r\n    _nativeInsertAd: any[] = [];\r\n    _nativeSingleAd: any[] = [];\r\n\r\n    nativeBannerAd: any = null;\r\n\r\n    _isInsertShow: boolean = false;\r\n    // 当前位置id的索引\r\n    _curPosIdIndexNativeBanner: number = 0;\r\n    _curPosIdIndexNativeInser: number = 0;\r\n    _curPosIdIndexSingleNative: number = 0;\r\n\r\n    _nativeData: any = null;\r\n    _nativeInsertData: any = null;\r\n    _nativeBannerNode: cc.Node = null;\r\n    _nativeInsertNode: cc.Node = null;\r\n\r\n    _videoCallback: Function = null;\r\n    _videoLoaded: boolean = null;\r\n\r\n    _isBannerShow: boolean = false;\r\n\r\n    _isInsertAdShow: boolean = false;\r\n    _isInsertAdLoaded: boolean = false;\r\n\r\n    _isVideoLoaded: boolean = false;\r\n    _isVideoShow: boolean = false;\r\n\r\n    lastLastShowVideoTime: number = 0; //最后一次显示视频时间\r\n\r\n    showNum: number = 0; // Banner广告展示次数\r\n    showInsertNum: number = 0; // 插屏广告展示次数\r\n\r\n    _showBannerCallBack: Function = null;\r\n    _isNativeBannerShow: boolean = false; //原生广告展示，调用的隐藏\r\n\r\n\r\n    public get ServerConfig() {\r\n        if (PlatUtils.IsXiaoMi) {\r\n            return utils.Tool_XiaoMi.ServerConfig;\r\n        }\r\n        return null;\r\n\r\n    }\r\n\r\n    public Init() {\r\n        if (PlatUtils.IsXiaoMi) {\r\n            utils.registerServerInitEvent(() => {\r\n                this._initVideoAd();\r\n            }, this);\r\n        }\r\n    }\r\n\r\n    _initVideoAd() {\r\n        if (!this._videoAd) {\r\n\r\n            if (!utils.config.xiaomiConfig.videoId) {\r\n                utils.showLog(\"视频ID配置不正确！\");\r\n                if (this._videoCallback) {\r\n                    this._videoCallback(false, \"暂无视频广告!\");\r\n                    this._videoCallback = null;\r\n                }\r\n                return;\r\n            }\r\n\r\n            let posId: string = utils.config.xiaomiConfig.videoId.trim();\r\n            utils.showLog(\"video广告ID:\" + posId);\r\n            //@ts-ignore\r\n            this._videoAd = qg.createRewardedVideoAd({\r\n                adUnitId: posId\r\n            });\r\n\r\n            if (this._videoAd) {\r\n                this._videoAd.onLoad((() => {\r\n                    utils.showLog(\"激励视频加载成功!\");\r\n                    this._isVideoLoaded = true;\r\n                }));\r\n\r\n                this._videoAd.onError((err => {\r\n                    utils.showLog(\"激励视频异常!\" + `error: errorMsg: ${err.errMsg}, erroCode: ${err.errCode}`);\r\n                    this._isVideoLoaded = false;\r\n                }));\r\n\r\n                this._videoAd.onClose(res => {\r\n                    this._isVideoShow = false;\r\n                    if (res && res.isEnded) {\r\n                        utils.showLog(\"正常播放结束，可以下发游戏奖励\");\r\n                        if (this._videoCallback) {\r\n                            this._videoCallback(true, \"\");\r\n                            this._videoCallback = null;\r\n                        }\r\n                    } else {\r\n                        utils.showLog(\"播放中途退出，不下发游戏奖励\");\r\n                        if (this._videoCallback) {\r\n                            this._videoCallback(false, \"观看完视频才能获得奖励!\");\r\n                            this._videoCallback = null;\r\n                        }\r\n                    }\r\n                });\r\n\r\n                // this._videoAd.load();\r\n            }\r\n        }\r\n    }\r\n\r\n\r\n    _nativeIsClose: boolean = false;\r\n\r\n    _showBannerTimerId: number = 0;\r\n    _delayShowBannerId: number = 0;\r\n\r\n    canShowNativeBanner = true; //原生banner是否展示\r\n    // nbclr:是否开启强制刷新\r\n\r\n    //当前显示Banner的位置\r\n    _curLocation: BannerLocation = BannerLocation.None;\r\n    _isTimeRefresh: boolean = false;\r\n    //启动定时器的时间\r\n    _startBannerTimerTask: number = 0;\r\n    _showBannerCount: number = 0;\r\n\r\n\r\n    public ShowBanner(location: BannerLocation = null, args: any = null, isTimeRefresh: boolean = false) {\r\n        if (PlatUtils.IsXiaoMi) {\r\n            if (!this.ServerConfig) {\r\n                utils.showLog(\"未请求到配置文件！\");\r\n                return;\r\n            }\r\n\r\n            if (this.ServerConfig && this.ServerConfig.isTest && this.ServerConfig.isTest == \"true\") {\r\n                this.showNum++;\r\n                if (this.showNum % 2 == 0) {\r\n                    utils.showLog(\"测试模式>> 顺序展示原生Banner广告！\");\r\n                    this._createNativeBannerAd(this._showNativeBanner);\r\n                } else {\r\n                    utils.showLog(\"测试模式>> 顺序展示默认Banner广告！\");\r\n                    this._createMiniGameBannerAd(location);\r\n                }\r\n                return;\r\n            }\r\n\r\n            if (!this.checkBannerAdShow()) {\r\n                this.HideBanner();\r\n                return;\r\n            }\r\n\r\n            this._showBannerCount++;\r\n\r\n\r\n            let oldLocation = this._curLocation;\r\n\r\n            this._curLocation = location;\r\n\r\n            this._isTimeRefresh = isTimeRefresh;\r\n            //如果跳用位置切换之后，验证是不是通过定时器强制刷新数据，不是则先隐藏banner\r\n            if (oldLocation != location) {\r\n                this.HideBanner(location);\r\n            }\r\n\r\n\r\n\r\n\r\n            let curTime: number = new Date().getTime();\r\n            let refresh_ad_time: number = (curTime - this._startBannerTimerTask) / 1000;\r\n\r\n            let interval = this.ServerConfig.refresh_ad_time;\r\n            // console.log(\"isTimeRefresh=\" + isTimeRefresh);\r\n            if (args && args.isRefresh) {\r\n                isTimeRefresh = true;\r\n            } else if (interval && interval > 0) {\r\n                if (refresh_ad_time > interval) {\r\n                    isTimeRefresh = true;\r\n                }\r\n            }\r\n            // 判断当前位置是不是显示banner\r\n            if (this.getNativeBannerInfo().is_show_banner == -1) {\r\n                utils.showLog(\"当前位置配置为不展示banner!\");\r\n                this.HideBanner(location);\r\n                return;\r\n            } else {\r\n                if (!isTimeRefresh) {\r\n                    if (this.ServerConfig.nbclr && this.ServerConfig.nbclr == \"true\" && this._curNativeBannerInfo.nativeBannerAd) {\r\n                        utils.showLog(\"服务器配置定时器刷新数据 \");\r\n\r\n                        utils.showLog(`原生banner延迟显示${this.getNativeBannerInfo().delay_show_time}秒`);\r\n\r\n                        clearTimeout(this._showBannerTimerId);\r\n                        clearTimeout(this._delayShowBannerId);\r\n\r\n                        //@ts-ignore\r\n                        this._delayShowBannerId = setTimeout(() => {\r\n                            this._showNativeBanner(this._curNativeBannerInfo.nativeBannerAd, this._curNativeBannerInfo.data);\r\n                        }, this.getNativeBannerInfo().delay_show_time * 1000);\r\n                        utils.showLog(\"开启定时刷新 >>>>>>>>>\" + (interval - refresh_ad_time));\r\n                        //@ts-ignore\r\n                        this._showBannerTimerId = setTimeout(() => {\r\n                            utils.showLog(`定时${interval}秒调用showbanner`);\r\n                            this.ShowBanner(this._curLocation, {}, true);\r\n                        }, (interval - refresh_ad_time) * 1000);\r\n                        return;\r\n                    }\r\n                }\r\n            }\r\n\r\n\r\n\r\n            this.canShowNativeBanner = true;\r\n            this._nativeIsClose = false;\r\n\r\n\r\n            clearTimeout(this._showBannerTimerId);\r\n            clearTimeout(this._delayShowBannerId);\r\n            utils.showLog(\"清理定时器\");\r\n            if (this.ServerConfig) {\r\n\r\n                utils.showLog(\"banner 优先展示 >>>>\" + this.ServerConfig.banner_first_ad);\r\n\r\n                if (interval && interval > 0) {\r\n                    utils.showLog(\"开启定时刷新 >>>>>>>>>\" + interval);\r\n                    //@ts-ignore\r\n                    this._showBannerTimerId = setTimeout(() => {\r\n                        utils.showLog(`定时${interval}秒调用showbanner`);\r\n                        this.ShowBanner(this._curLocation, {}, true);\r\n                    }, interval * 1000);\r\n                }\r\n\r\n                let closeCount = this.ServerConfig.banner_close_count ? this.ServerConfig.banner_close_count : 0;\r\n                if (closeCount > 0 && utils.Tool_XiaoMi.bannerAdCloseCounts >= closeCount) {\r\n                    utils.showLog(`banner 关闭次数达到${closeCount}次,banner今日不再显示！`);\r\n                    return;\r\n                }\r\n\r\n\r\n                if (this.ServerConfig.banner_first_ad) {\r\n                    if (this.ServerConfig.banner_first_ad.indexOf(\"native\") > -1) {\r\n                        utils.showLog(\"优先展示原生Banner广告!\" + isTimeRefresh + \" <<<<\");\r\n                        if (!this._isTimeRefresh) {\r\n                            utils.showLog(`原生banner延迟显示${this.getNativeBannerInfo().delay_show_time}秒`);\r\n                            //@ts-ignore\r\n                            this._delayShowBannerId = setTimeout(() => {\r\n                                this._createNativeBannerAd(this._showNativeBanner);\r\n                            }, this.getNativeBannerInfo().delay_show_time * 1000);\r\n                        } else {\r\n                            this._createNativeBannerAd(this._showNativeBanner);\r\n                        }\r\n\r\n                    } else {\r\n                        utils.showLog(\"优先展示小游戏Banner广告!\");\r\n                        this._createMiniGameBannerAd(location);\r\n                    }\r\n                } else {\r\n                    utils.showLog(\"配置数据中没有 banner_first_ad 字段， banner广告不显示!\");\r\n                }\r\n            } else {\r\n                utils.showLog(\"服务器配置数据未初始化!\");\r\n            }\r\n        }\r\n    }\r\n\r\n    public HideBanner(location: BannerLocation = null) {\r\n        if (PlatUtils.IsXiaoMi) {\r\n\r\n            clearTimeout(this._showBannerTimerId);\r\n            clearTimeout(this._delayShowBannerId);\r\n            this._isBannerShow = false;\r\n            this._nativeIsClose = true;\r\n\r\n            if (this._bannerAd) {\r\n                utils.showLog(\"隐藏小游戏Banner\");\r\n                this._bannerAd.hide();\r\n            }\r\n            this.canShowNativeBanner = false;\r\n            if (this._nativeBannerNode) {\r\n                utils.showLog(\"隐藏原生Banner\");\r\n                this._nativeBannerNode.active = false;\r\n            }\r\n        }\r\n    }\r\n\r\n    _nativeBannerInfo: NativeBannerInfo = null;\r\n    /**\r\n     * 获取当前banner配置\r\n     */\r\n    getNativeBannerInfo() {\r\n        if (this._nativeBannerInfo && this._nativeBannerInfo.location == this._curLocation) {\r\n            return this._nativeBannerInfo;\r\n        }\r\n        return utils.config.xiaomiConfig.getNativeBannerInfo(this._curLocation);\r\n    }\r\n\r\n\r\n\r\n\r\n    _createMiniGameBannerAd(location: BannerLocation = null) {\r\n        if (PlatUtils.IsXiaoMi) {\r\n            this._isBannerShow = true;\r\n\r\n            if (utils.config.xiaomiConfig\r\n                && utils.config.xiaomiConfig.bannerId) {\r\n\r\n                if (this._bannerAd) {\r\n                    this._bannerAd.destroy();\r\n                }\r\n                let left = (utils.Tool_XiaoMi.SysInfo.screenWidth - 385) * 0.5;\r\n                if (cc.winSize.height < cc.winSize.width) {\r\n                    left = utils.Tool_XiaoMi.SysInfo.screenWidth * 0.5\r\n                }\r\n                let bannerStyle: any = {\r\n                    left: left,\r\n                    top: utils.Tool_XiaoMi.SysInfo.screenHeight - 58,\r\n                    width: 385\r\n                }\r\n                if (this.getNativeBannerInfo()._alignType === \"top\") {\r\n                    bannerStyle.top = 0;\r\n                }\r\n                //@ts-ignore\r\n                this._bannerAd = qg.createBannerAd({\r\n                    adUnitId: utils.config.xiaomiConfig.bannerId,\r\n                    style: bannerStyle\r\n                });\r\n                utils.showLog(\"createBannerAd:\" + this._bannerAd);\r\n\r\n\r\n                utils.showLog(\"注册小游戏banner回调!\");\r\n                this._bannerAd.onError((err) => {\r\n                    utils.showLog(\"xiaomi 小游戏Banner广告出错: \" + err.code + err.msg);\r\n                    let bannerInfo = this.getNativeBannerInfo();\r\n                    if (bannerInfo.st_banner_show_back_up == -1) {\r\n                        utils.showLog(\"服务器配置不显示备用广告\");\r\n                        return;\r\n                    }\r\n                    if (this._isBannerShow) {\r\n                        this._isBannerShow = false;\r\n                        if (this.ServerConfig.banner_first_ad.indexOf(\"default\") > -1) {\r\n                            this._curPosIdIndexNativeBanner = 0;\r\n                            this._createNativeBannerAd(this._showNativeBanner.bind(this));\r\n                        }\r\n                    }\r\n                });\r\n\r\n                this._bannerAd.onResize((res) => {\r\n                    utils.showLog(\"xiaomi 小游戏Banner显示成功！\");\r\n\r\n                    if (this._nativeBannerNode) {\r\n                        this._nativeBannerNode.active = false;\r\n                    }\r\n                    this._showBannerCallBack && this._showBannerCallBack();\r\n                    this._showBannerCallBack = null;\r\n\r\n                    // utils.showLog(\"xiaomi 小游戏Banner onResize！\" + JSON.stringify(res));\r\n                    // utils.showLog(\"xiaomi 小游戏Banner curStyle\" + JSON.stringify(this._bannerAd.style));\r\n\r\n                    // this._bannerAd.style.width = utils.Tool_XiaoMi.SysInfo.screenWidth;\r\n                    this._bannerAd.style.left = (utils.Tool_XiaoMi.SysInfo.screenWidth - res.width) * 0.5;\r\n                    if (this.getNativeBannerInfo()._alignType == \"top\") {\r\n                        this._bannerAd.style.top = 0;\r\n                    } else {\r\n                        this._bannerAd.style.top = utils.Tool_XiaoMi.SysInfo.screenHeight - res.height;\r\n                    }\r\n                    // utils.showLog(\"xiaomi 小游戏Banner curStyle\" + JSON.stringify(this._bannerAd.style));\r\n\r\n                });\r\n\r\n                this._bannerAd.onClose(() => {\r\n                    utils._bannerCloseTime = new Date().getTime();\r\n                    if (!this._isNativeBannerShow) {\r\n                        utils.Tool_XiaoMi.countBannerCloseCount();\r\n                        utils.showLog(\"xiaomi 小游戏Banner 广告隐藏,当前隐藏次数>\" + utils.Tool_XiaoMi.bannerAdCloseCounts);\r\n                    } else {\r\n                        this._isNativeBannerShow = false;\r\n                        utils.showLog(\"xiaomi 小游戏Banner 广告隐藏,来自原生的显示，不增加隐藏次数，当前隐藏次数>\" + utils.Tool_XiaoMi.bannerAdCloseCounts);\r\n                    }\r\n\r\n                })\r\n\r\n\r\n\r\n\r\n\r\n                if (this._bannerAd) {\r\n\r\n                    this._bannerAd.show();\r\n                    utils.showLog(\"xiaomi 小游戏Banner show\");\r\n                } else {\r\n                    utils.showLog(\"xiaomi 小游戏Banner广告创建失败!\");\r\n                    if (this.ServerConfig.indexOf(\"default\") > -1) {\r\n                        this._curPosIdIndexNativeBanner = 0;\r\n                        this._createNativeBannerAd(this._showNativeBanner.bind(this));\r\n                    }\r\n                }\r\n            } else {\r\n                utils.showLog(\"xiaomi 小游戏Banner广告配置信息错误!\");\r\n                let bannerInfo = this.getNativeBannerInfo();\r\n                if (bannerInfo.st_banner_show_back_up == -1) {\r\n                    utils.showLog(\"服务器配置不显示备用广告\");\r\n                    return;\r\n                }\r\n                if (this.ServerConfig.banner_first_ad.indexOf(\"default\") > -1) {\r\n                    this._curPosIdIndexNativeBanner = 0;\r\n                    this._createNativeBannerAd(this._showNativeBanner.bind(this));\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    _curNativeBannerInfo: any = {};\r\n    _createNativeBannerAd(completeCallback: Function) {\r\n        if (PlatUtils.IsXiaoMi) {\r\n\r\n            let callback = completeCallback;\r\n\r\n            utils.showLog(\"curPosIdIndexNativeBanner:\" + this._curPosIdIndexNativeBanner);\r\n\r\n            let nativeBannerAd = this._nativeBannerAd[this._curPosIdIndexNativeBanner];\r\n\r\n            if (!nativeBannerAd) {\r\n                if (utils.config.xiaomiConfig.nativeBannerIds\r\n                    && utils.config.xiaomiConfig.nativeBannerIds[this._curPosIdIndexNativeBanner]) {\r\n                    utils.showLog(\"创建原生广告Banner。 posId:\" + utils.config.xiaomiConfig.nativeBannerIds[this._curPosIdIndexNativeBanner]);\r\n                    //@ts-ignore\r\n                    nativeBannerAd = qg.createNativeAd({\r\n                        adUnitId: utils.config.xiaomiConfig.nativeBannerIds[this._curPosIdIndexNativeBanner]\r\n                    });\r\n\r\n                    if (nativeBannerAd) {\r\n                        this._nativeBannerAd.push(nativeBannerAd);\r\n\r\n                        nativeBannerAd.onLoad((res) => {\r\n                            if (this._nativeIsClose) {\r\n                                utils.showLog(\"隐藏了BANNER，不做任何处理！\");\r\n                                return;\r\n                            }\r\n                            if (res && res.adList && res.adList.length > 0) {\r\n                                this._startBannerTimerTask = new Date().getTime();\r\n                                utils.showLog(\"原生Banner广告资源拉取成功！\");\r\n                                utils.showLog(JSON.stringify(res));\r\n                                res = JSON.parse(JSON.stringify(res));\r\n                                let data = res.adList[0];\r\n                                //如果当前显示为结算banner,则不做数据验证\r\n                                if (this._checkNativeDataValid(data) || this.getNativeBannerInfo().show_st_banner == \"true\") {\r\n                                    if (this.canShowNativeBanner) {\r\n                                        this._curPosIdIndexNativeBanner = 0;\r\n                                        this._showNativeBanner(nativeBannerAd, data);\r\n                                        this._curNativeBannerInfo.nativeBannerAd = nativeBannerAd;\r\n                                        this._curNativeBannerInfo.data = data;\r\n                                        // 删除当前广告\r\n                                        if (this._bannerAd) {\r\n                                            this._isNativeBannerShow = true;\r\n                                            utils.showLog(\"隐藏小游戏Banner\");\r\n                                            this._bannerAd.hide();\r\n                                        }\r\n                                    } else {\r\n                                        utils.showLog(\"已经隐藏banner不可重复展示\")\r\n                                    }\r\n                                    return;\r\n                                }\r\n                            }\r\n\r\n                            utils.showLog(\"原生Banner广告资源出错！\");\r\n                            this._curPosIdIndexNativeBanner++;\r\n                            if (this._curPosIdIndexNativeBanner < utils.config.xiaomiConfig.nativeBannerIds.length) {\r\n                                this._createNativeBannerAd(callback);\r\n                            } else {\r\n                                this._curPosIdIndexNativeBanner = 0;\r\n                                // 原生广告遍历完毕\r\n                                utils.showLog(\"原生广告条遍历完毕，无法展示！\");\r\n                                let bannerInfo = this.getNativeBannerInfo();\r\n                                if (bannerInfo.st_banner_show_back_up == -1) {\r\n                                    utils.showLog(\">>>>>服务器配置不显示备用广告！\");\r\n                                    return;\r\n                                }\r\n                                if (this.ServerConfig.banner_first_ad.indexOf(\"native\") > -1) {\r\n                                    utils.showLog(\"开始展示小游戏广告条！\")\r\n                                    this._createMiniGameBannerAd();\r\n                                }\r\n                            }\r\n\r\n                        });\r\n\r\n                        nativeBannerAd.onError((err) => {\r\n                            if (this._nativeIsClose) {\r\n                                utils.showLog(\"隐藏了BANNER，不做任何处理！\");\r\n                                return;\r\n                            }\r\n                            utils.showLog(\"原生Banner广告资源拉取失败！\" + err.code + err.msg);\r\n                            this._curPosIdIndexNativeBanner++;\r\n                            if (this._curPosIdIndexNativeBanner < utils.config.xiaomiConfig.nativeBannerIds.length) {\r\n                                this._createNativeBannerAd(callback);\r\n                            } else {\r\n                                this._curPosIdIndexNativeBanner = 0;\r\n                                // 原生广告遍历完毕\r\n                                utils.showLog(\"原生广告条遍历完毕，无法展示！\");\r\n                                let bannerInfo = this.getNativeBannerInfo();\r\n                                if (bannerInfo.st_banner_show_back_up == -1) {\r\n                                    utils.showLog(\">>>>>服务器配置不显示备用广告！\");\r\n                                    return;\r\n                                }\r\n                                if (this.ServerConfig.banner_first_ad.indexOf(\"native\") > -1) {\r\n                                    utils.showLog(\"开始展示小游戏广告条！\")\r\n                                    this._createMiniGameBannerAd();\r\n                                } else {\r\n                                    //显示自定义banner\r\n                                    if (utils.isShowRecommondGamesBanner()) {\r\n                                        clearTimeout(this._showBannerTimerId);\r\n                                        utils.showRecommendGamesBanner();\r\n                                        utils.showLog(`小游戏、原生广告条都无法展示，展示自定义banner`);\r\n                                        return;\r\n                                    }\r\n                                }\r\n                            }\r\n                        });\r\n                    }\r\n                }\r\n            }\r\n\r\n            if (nativeBannerAd) {\r\n                utils.showLog(\"nativeBannerAd reLoad>>\");\r\n                nativeBannerAd.load();\r\n            } else {\r\n                this._curPosIdIndexNativeBanner++;\r\n                if (utils.config.xiaomiConfig.nativeBannerIds && this._curPosIdIndexNativeBanner < utils.config.xiaomiConfig.nativeBannerIds.length) {\r\n                    this._createNativeBannerAd(callback);\r\n                } else {\r\n                    this._curPosIdIndexNativeBanner = 0;\r\n                    // 原生广告遍历完毕\r\n                    utils.showLog(\"原生广告条遍历完毕，无法展示！\");\r\n                    let bannerInfo = this.getNativeBannerInfo();\r\n                    if (bannerInfo.st_banner_show_back_up == -1) {\r\n                        utils.showLog(\">>>>>服务器配置不显示备用广告！\");\r\n                        return;\r\n                    }\r\n                    if (this.ServerConfig.banner_first_ad.indexOf(\"native\") > -1) {\r\n                        utils.showLog(\"开始展示小游戏广告条！\")\r\n                        this._createMiniGameBannerAd();\r\n                    } else {\r\n                        //显示自定义banner\r\n                        if (utils.isShowRecommondGamesBanner()) {\r\n                            clearTimeout(this._showBannerTimerId);\r\n                            utils.showRecommendGamesBanner();\r\n                            utils.showLog(`小游戏、原生广告条都无法展示，展示自定义banner`);\r\n                            return;\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n\r\n\r\n    /**\r\n     * 显示视频广告\r\n     * @param callback 视频回调\r\n     */\r\n    public ShowVideo(callback: Function) {\r\n        if (PlatUtils.IsXiaoMi) {\r\n            this._videoCallback = callback;\r\n\r\n            if (!this._videoAd) {\r\n                if (this._videoCallback) {\r\n                    this._videoCallback(false, \"暂无视频广告!\");\r\n                    this._videoCallback = null;\r\n                }\r\n                this._initVideoAd();\r\n            } else {\r\n                // if (this._isVideoLoaded) {\r\n                this._videoAd.show();\r\n                // } else {\r\n                //     if (this._videoCallback) {\r\n                //         this._videoCallback(false, \"暂无视频广告!\");\r\n                //         this._videoCallback = null;\r\n                //     }\r\n                //     this._videoAd.load();\r\n                //     return;\r\n                // }\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 显示插屏\r\n     * @param location \r\n     */\r\n    public ShowInterstitial(location: BannerLocation = null) {\r\n        if (PlatUtils.IsXiaoMi) {\r\n            if (!this.checkInsertAdShow()) {\r\n                return;\r\n            }\r\n\r\n\r\n            let delayTime: number = 0;\r\n            if (this.ServerConfig\r\n                && this.ServerConfig.intersititia_delay_show_time) {\r\n                delayTime = this.ServerConfig.intersititia_delay_show_time;\r\n            }\r\n\r\n            utils.showLog(`插屏广告延时展示！ delayTime:${delayTime}秒`);\r\n\r\n            if (this.ServerConfig && this.ServerConfig.isTest && this.ServerConfig.isTest == \"true\") {\r\n                this.showInsertNum++;\r\n                // utils.showLog(this.showInsertNum % 2 == 0, \"<<this.showInsertNum % 2 == 0\");\r\n                //@ts-ignore\r\n                if (this.showInsertNum % 2 == 0) {\r\n                    utils.showLog(\"测试模式>> 顺序展示原生插屏广告！\");\r\n                    this.nativeInserAdDelayCall();\r\n                } else {\r\n                    //@ts-ignore\r\n                    this._createMiniGameInsertAd();\r\n                }\r\n                return;\r\n            }\r\n\r\n            if (this.ServerConfig) {\r\n                if (location && location == BannerLocation.Pause) {\r\n                    //@ts-ignore\r\n                    if (this.ServerConfig.intersititial_first_ad == \"native\") {\r\n                        utils.showLog(\"暂停界面不延时展示！\");\r\n                        utils.showLog(\"优先展示原生插屏广告!\");\r\n                        this.nativeInserAdDelayCall();\r\n                    } else {\r\n                        utils.showLog(\"优先展示小游戏插屏广告!\");\r\n                        this._createMiniGameInsertAd();\r\n                    }\r\n                } else {\r\n                    //@ts-ignore\r\n                    if (this.ServerConfig.intersititial_first_ad == \"native\") {\r\n                        utils.showLog(\"优先展示原生插屏广告!\");\r\n                        utils.delayCall(this.nativeInserAdDelayCall.bind(this), delayTime);\r\n                    } else {\r\n                        utils.showLog(\"优先展示小游戏插屏广告!\");\r\n                        utils.delayCall(this._createMiniGameInsertAd.bind(this), delayTime);\r\n                    }\r\n                }\r\n            } else {\r\n                utils.showLog(\"服务器配置数据未初始化!\");\r\n            }\r\n        }\r\n    }\r\n\r\n    _createMiniGameInsertAd() {\r\n\r\n        this._isInsertShow = true;\r\n\r\n        //@ts-ignore\r\n        this._insertAd = qg.createInterstitialAd({\r\n            adUnitId: utils.config.xiaomiConfig.insertId.trim()\r\n        });\r\n\r\n        if (this._insertAd) {\r\n            this._insertAd.onLoad(() => {\r\n                utils.showLog(\"插屏广告加载成功\");\r\n                if (this._isInsertShow) {\r\n                    this._insertAd.show().then(() => {\r\n                        utils.showLog(\"插屏广告展示成功!\");\r\n                        this._insertLastShowTime = new Date().getTime();\r\n                    }).catch(function (err) {\r\n                        utils.showLog(`插屏广告展示失败!, err=${JSON.stringify(err)}`);\r\n                    });\r\n                }\r\n            })\r\n            this._insertAd.onError((err) => {\r\n                utils.showLog(`插屏广告监听异常!, err=${JSON.stringify(err)}`);\r\n                if (this._isInsertShow) {\r\n                    if (this.ServerConfig.intersititial_first_ad == \"default\") {\r\n                        this._isInsertShow = false;\r\n                        utils.showLog(\"开始显示原生插屏广告!\");\r\n                        this._curPosIdIndexNativeInser = 0;\r\n                        utils.delayCall(this.nativeInserAdDelayCall.bind(this), this.ServerConfig.intersititia_delay_show_time || 0);\r\n                    }\r\n                }\r\n            })\r\n        } else {\r\n            utils.showLog(\"插屏广告未初始化!\");\r\n        }\r\n    }\r\n\r\n    _nativeInsertAdShowCount: number = 0;\r\n    public nativeInserAdDelayCall() {\r\n        utils.showLog(\"原生插屏广告: 当前点击次数=\" + utils.Tool_XiaoMi.NativeInsertAdClickTimes + \"; 点击次数限制=\" + this.ServerConfig.intersititia_click_count + \"; 展示次数间隔=\" + this.ServerConfig.intersititial_interval_time + \"; 展示累计=\" + this._nativeInsertAdShowCount);\r\n        if (utils.Tool_XiaoMi.NativeInsertAdClickTimes >= (this.ServerConfig.intersititia_click_count || 0)) {\r\n            // 每日点击次数到达上限，限制展示次数\r\n            if (this._nativeInsertAdShowCount >= (this.ServerConfig.intersititia_show_interval || 0)) {\r\n                // 可以展示\r\n                this._createNativeInsertAd(this._showNativeInsert);\r\n            } else {\r\n                // 不能展示\r\n                this._nativeInsertAdShowCount++;\r\n            }\r\n        } else {\r\n            this._createNativeInsertAd(this._showNativeInsert);\r\n        }\r\n    }\r\n\r\n    _createNativeInsertAd(completeCallback: Function) {\r\n        if (PlatUtils.IsXiaoMi) {\r\n\r\n            let callback = completeCallback;\r\n\r\n            utils.showLog(\"curPosIdIndexNativeInsert:\" + this._curPosIdIndexNativeInser);\r\n\r\n            if (utils.config.xiaomiConfig.nativeInsertIds\r\n                && utils.config.xiaomiConfig.nativeInsertIds[this._curPosIdIndexNativeInser]) {\r\n                utils.showLog(\"创建原生插屏广告。 posId:\" + utils.config.xiaomiConfig.nativeInsertIds[this._curPosIdIndexNativeInser]);\r\n                //@ts-ignore\r\n                let nativeInsertAd = qg.createNativeAd({\r\n                    adUnitId: utils.config.xiaomiConfig.nativeInsertIds[this._curPosIdIndexNativeInser]\r\n                });\r\n\r\n                if (nativeInsertAd) {\r\n                    // this._nativeInsertAd.push(nativeInsertAd);\r\n\r\n                    nativeInsertAd.onLoad((res) => {\r\n                        if (res && res.adList && res.adList.length > 0) {\r\n                            utils.showLog(\"原生插屏广告资源拉取成功！\");\r\n                            utils.showLog(JSON.stringify(res));\r\n                            res = JSON.parse(JSON.stringify(res));\r\n                            let data = res.adList[0];\r\n                            if (this._checkNativeInsertDataValid(data)) {\r\n\r\n                                this._curPosIdIndexNativeInser = 0;\r\n                                this._showNativeInsert(nativeInsertAd, data);\r\n                                return;\r\n                            } else {\r\n                                utils.showLog(\"原生插屏广告资源不合法！\");\r\n                            }\r\n                        }\r\n\r\n                        utils.showLog(\"原生插屏广告资源出错！\");\r\n                        this._curPosIdIndexNativeInser++;\r\n                        if (this._curPosIdIndexNativeInser < utils.config.xiaomiConfig.nativeInsertIds.length) {\r\n                            this._createNativeInsertAd(callback);\r\n                        } else {\r\n                            this._curPosIdIndexNativeInser = 0;\r\n                            // 原生广告遍历完毕\r\n                            utils.showLog(\"原生插屏广告遍历完毕，无法展示！\");\r\n                            if (this.ServerConfig.intersititial_first_ad == \"native\") {\r\n                                utils.showLog(\"开始展示小游戏插屏广告!\");\r\n                                this._createMiniGameInsertAd();\r\n                            }\r\n                        }\r\n                    });\r\n\r\n                    nativeInsertAd.onError((err) => {\r\n                        utils.showLog(\"原生插屏广告创建失败！\" + JSON.stringify(err));\r\n                    });\r\n\r\n                    let adLoad = nativeInsertAd.load();\r\n                    adLoad && adLoad.then((res) => {\r\n                        console.log(\"res\", JSON.stringify(res));\r\n                    }).catch(err => {\r\n                        utils.showLog(\"原生插屏广告资源拉取失败！\" + JSON.stringify(err));\r\n                        this._curPosIdIndexNativeInser++;\r\n                        if (this._curPosIdIndexNativeInser < utils.config.xiaomiConfig.nativeInsertIds.length) {\r\n                            this._createNativeInsertAd(callback);\r\n                        } else {\r\n                            this._curPosIdIndexNativeInser = 0;\r\n                            // 原生广告遍历完毕\r\n                            utils.showLog(\"原生插屏广告遍历完毕，无法展示！\");\r\n                            if (this.ServerConfig.intersititial_first_ad == \"native\") {\r\n                                utils.showLog(\"开始展示小游戏插屏广告!\");\r\n                                this._createMiniGameInsertAd();\r\n                            }\r\n                        }\r\n                    })\r\n                } else {\r\n                    this._curPosIdIndexNativeInser++;\r\n                    if (utils.config.xiaomiConfig.nativeInsertIds && this._curPosIdIndexNativeInser < utils.config.xiaomiConfig.nativeInsertIds.length) {\r\n                        this._createNativeInsertAd(callback);\r\n                    } else {\r\n                        this._curPosIdIndexNativeInser = 0;\r\n                        // 原生广告遍历完毕\r\n                        utils.showLog(\"原生插屏广告遍历完毕，无法展示！\");\r\n                        if (this.ServerConfig.intersititial_first_ad == \"native\") {\r\n                            utils.showLog(\"开始展示小游戏插屏广告!\");\r\n                            this._createMiniGameInsertAd();\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n       * 显示原生插屏组件\r\n       */\r\n    _showNativeInsert(nativeInsertAd: any, data: any) {\r\n        if (PlatUtils.IsXiaoMi) {\r\n            if (data) {\r\n                utils.showLog(\"显示原生插屏\");\r\n                if ((!cc.isValid(this._nativeInsertNode)) || !this._nativeInsertNode && utils.config.otherconfig.nativeInsert) {\r\n                    utils.showLog(\"创建原生插屏广告位\");\r\n                    this._nativeInsertNode = cc.instantiate(utils.config.otherconfig.nativeInsert);\r\n                    this._nativeInsertNode.position = CompatibleTool.position(cc.winSize.width / 2, cc.winSize.height / 2);\r\n                    cc.director.getScene().addChild(this._nativeInsertNode, 9999);\r\n                }\r\n\r\n                if (this._nativeInsertNode) {\r\n                    let nativeInsert = this._nativeInsertNode.getComponent(\"YZ_NativeInsert\");\r\n                    if (nativeInsert) {\r\n                        this._nativeInsertAdShowCount = 0;\r\n                        this._insertLastShowTime = new Date().getTime();\r\n                        nativeInsert.init(nativeInsertAd, data);\r\n                    } else {\r\n                        utils.showLog(\"NativeInsert组件不存在!\");\r\n                    }\r\n                } else {\r\n                    utils.showLog(\"原生广告插屏位没有创建！\");\r\n                }\r\n\r\n                if (!this.ServerConfig.show_insert_hide_banner || this.ServerConfig.show_insert_hide_banner != \"false\") {\r\n                    utils.showLog(\"原生广告插屏展示后隐藏Banner！\");\r\n                    this.HideBanner();\r\n                }\r\n            }\r\n        }\r\n    }\r\n    /**\r\n * 显示原生banner组件\r\n */\r\n    _showNativeBanner(nativeBannerAd: any, data: any) {\r\n        if (PlatUtils.IsXiaoMi) {\r\n            if (data) {\r\n\r\n                if (cc.isValid(this._nativeBannerNode) && this._nativeBannerNode) {\r\n                    this._nativeBannerNode.destroy();\r\n                }\r\n\r\n                // if (!cc.isValid(this._nativeBannerNode) || (!this._nativeBannerNode && utils.config.otherconfig.nativeBanner)) {\r\n                this._nativeBannerNode = cc.instantiate(utils.config.otherconfig.nativeBanner);\r\n                this._nativeBannerNode.position = CompatibleTool.position(cc.winSize.width / 2, this._nativeBannerNode.height * this._nativeBannerNode.scaleY / 2);\r\n                cc.director.getScene().addChild(this._nativeBannerNode, 1000);\r\n                // }\r\n                if (this._nativeBannerNode) {\r\n                    this._nativeBannerNode.active = true;\r\n                    let nativeBanner: YZ_NativeBanner = this._nativeBannerNode.getComponent(\"YZ_NativeBanner\");\r\n                    if (nativeBanner) {\r\n                        nativeBanner.init(nativeBannerAd, data, this.getNativeBannerInfo());\r\n                    } else {\r\n                        utils.showLog(\"NativeBanner组件不存在!\");\r\n                    }\r\n                    this._showBannerCallBack && this._showBannerCallBack();\r\n                    this._showBannerCallBack = null;\r\n                } else {\r\n                    utils.showLog(\"原生广告banner位没有创建！\");\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n\r\n\r\n\r\n    _insertLastShowTime = 0;\r\n    /**\r\n     * 验证插屏是否能展示\r\n     * 2、时间限制 默认30秒\r\n     */\r\n    private checkInsertAdShow(): boolean {\r\n        let intervalTime = this.ServerConfig.intersititial_interval_time ? this.ServerConfig.intersititial_interval_time : 30;\r\n        let curTime: number = new Date().getTime();\r\n        let interval: number = (curTime - this._insertLastShowTime) / 1000;\r\n\r\n        utils.showLog(\"xiaomi服务器插屏间隔显示时间为：\" + intervalTime + \"秒！\");\r\n        utils.showLog(\"xiaomi插屏当前广告间隔时间：\" + interval + \"秒！\");\r\n\r\n        if (intervalTime > 0 && interval < intervalTime) {\r\n            utils.showLog(\"xiaomi插屏广告显示的间隔少于\" + intervalTime + \"秒。插屏不显示\");\r\n            return false;\r\n        }\r\n\r\n        return true;\r\n    }\r\n\r\n    /**\r\n     * 验证Banner是否能展示\r\n     * 2、时间限制 默认30秒\r\n     */\r\n    private checkBannerAdShow(): boolean {\r\n        let intervalTime = this.ServerConfig.hide_banner_interval_show_time ? this.ServerConfig.hide_banner_interval_show_time : 0;\r\n        let curTime: number = new Date().getTime();\r\n        let interval: number = (curTime - utils._bannerCloseTime) / 1000;\r\n\r\n        utils.showLog(\"xiaomi服务器Banner关闭后间隔显示时间为：\" + intervalTime + \"秒！\");\r\n        utils.showLog(\"xiaomi-Banner关闭后当前广告间隔时间：\" + interval + \"秒！\");\r\n\r\n        if (intervalTime > 0 && interval < intervalTime) {\r\n            utils.showLog(\"xiaomi-Banner关闭后显示的间隔少于\" + intervalTime + \"秒。Banner不显示\");\r\n            return false;\r\n        }\r\n\r\n        return true;\r\n    }\r\n\r\n    _checkNativeInsertDataValid(data: any) {\r\n        if (!data) {\r\n            return false;\r\n        }\r\n        return data.title && ((data.iconUrlList && data.iconUrlList.length > 0) || (data.imgUrlList && data.imgUrlList.length > 0));\r\n    }\r\n\r\n    _checkNativeDataValid(data: any) {\r\n        if (!data) {\r\n            return false;\r\n        }\r\n        return data.imgUrlList && data.imgUrlList.length;\r\n    }\r\n}\r\n"]}