{"version":3,"sources":["assets\\common-plugin\\Scripts\\YZ_NativeItem.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import PlatUtils from \"./PlatUtils\";\r\nimport { utils } from \"./Utils\";\r\nimport YZ_NativeAdObject from \"./YZ_NativeAdObject\";\r\nimport YZ_Constant, { BannerLocation } from \"./YZ_Constant\";\r\nimport CompatibleTool from \"./CompatibleTool\";\r\n\r\nconst { ccclass, property } = cc._decorator;\r\n\r\n@ccclass\r\nexport default class YZ_NativeItem extends cc.Component {\r\n\r\n    private _nativeAdTiltle: cc.Label = null;\r\n    private _nativeAdIcon: cc.Sprite = null;\r\n    private _nativeAdDesc: cc.Label = null;\r\n    private _nativeAdImg: cc.Sprite = null;\r\n    private _closeBtn: cc.Node = null;\r\n    private _downBtn: cc.Node = null;\r\n\r\n    private _noImageView: cc.Node = null;\r\n\r\n    _nativeAd: YZ_NativeAdObject = null;\r\n    isShow: boolean = false;\r\n    showType: number = 1;\r\n\r\n    params?: any = null;\r\n\r\n    content: cc.Node = null;\r\n\r\n\r\n    onLoad() {\r\n        this.content = this.node.children[0];\r\n        this._noImageView = this.content.getChildByName(\"NoImageView\");\r\n        this._nativeAdTiltle = this._noImageView.getChildByName(\"title\").getComponent(cc.Label);\r\n        this._nativeAdIcon = this._noImageView.getChildByName(\"icon\").getComponent(cc.Sprite);\r\n        this._nativeAdDesc = this._noImageView.getChildByName(\"desc\").getComponent(cc.Label);\r\n        this._nativeAdImg = this.content.getChildByName(\"image\").getComponent(cc.Sprite);\r\n        // this._downBtn = this.content.getChildByName(\"Btn_Download\");\r\n        this._closeBtn = this.content.getChildByName(\"closeBtn\");\r\n\r\n\r\n        if (this.params) {\r\n            if (this.params.parent) {\r\n                this.node.width = this.node.parent.width;\r\n                this.node.height = this.node.parent.height;\r\n            }\r\n        } else {\r\n            if (utils.ServerConfig.st_native_ad_height) {\r\n                this.node.height = utils.ServerConfig.st_native_ad_height;\r\n            }\r\n        }\r\n        this.content.active = false;\r\n        cc.game.on(YZ_Constant.YZ_NativeAdClick, () => {\r\n            this.reportAdClick();\r\n        }, this);\r\n        // this._closeBtn.active = utils.ServerConfig.st_banner_close_but_show ? (utils.ServerConfig.st_banner_close_but_show == \"true\") : false;\r\n        // this._downBtn.active = utils.ServerConfig.show_statement_nativeAd_closeBtn ? (utils.ServerConfig.show_statement_nativeAd_closeBtn == \"true\") : false;\r\n    }\r\n\r\n    onDisable() {\r\n        cc.game.targetOff(this);\r\n        this.node.destroy();\r\n    }\r\n\r\n    update() {\r\n        if (this._nativeAd && !this.isShow) {\r\n            this.isShow = true;\r\n            this.showNativeAd();\r\n        }\r\n    }\r\n\r\n\r\n    init(nativeObj: YZ_NativeAdObject) {\r\n        utils.showLog(\"初始化单个原生广告>>>\");\r\n        this._nativeAd = nativeObj;\r\n    }\r\n\r\n    showNativeAd() {\r\n\r\n        if (utils.ServerConfig.st_native_ad_is_hide_banner && utils.ServerConfig.st_native_ad_is_hide_banner == \"true\") {\r\n            utils.showLog(\"服务器配置显示结算原生广告后隐藏banner >>>\");\r\n            utils.adManager.HideBanner(BannerLocation.Game);\r\n        }\r\n\r\n        if (utils.ServerConfig.st_native_ad_show_rec_banner && utils.ServerConfig.st_native_ad_show_rec_banner == \"true\") {\r\n            utils.showRecBanner();\r\n        }\r\n\r\n        let nativeData = this._nativeAd.data;\r\n\r\n\r\n        let title = nativeData.title;\r\n        let desc = nativeData.desc;\r\n        if (title.length > 6) {\r\n            title = title.slice(0, 6);\r\n            title += \"...\";\r\n        }\r\n        if (desc.length > 18) {\r\n            desc = desc.slice(0, 17);\r\n            desc += \"...\";\r\n        }\r\n\r\n        this._nativeAdTiltle.string = title;\r\n        this._nativeAdDesc.string = desc;\r\n\r\n        if (nativeData.imgUrlList && nativeData.imgUrlList.length > 0) {\r\n            // 有图片，优先显示图片\r\n            // this._titleLabel.node.active = true;\r\n            // this._icon.node.active = false;\r\n            // this._img.node.active = true;\r\n            // this._desLabel.node.active = true;\r\n            this._noImageView.active = false;\r\n            this._nativeAdImg.node.active = true;\r\n\r\n            CompatibleTool.LoadRes(nativeData.imgUrlList[0], (err, res) => {\r\n                if (!err && cc.isValid(this) && this._nativeAdImg) {\r\n                    this._nativeAdImg.spriteFrame = new cc.SpriteFrame(res);\r\n                    this._nativeAdImg.node.active = true;\r\n                    this.content.active = true;\r\n                }\r\n            });\r\n\r\n        } else if (PlatUtils.IsOPPO && nativeData.iconUrlList && nativeData.iconUrlList.length > 0) {\r\n            // 有icon\r\n\r\n            this._nativeAdImg.node.active = false;\r\n            this._noImageView.active = true;\r\n            CompatibleTool.LoadRes(nativeData.iconUrlList[0], (err, res) => {\r\n                if (!err && cc.isValid(this) && this._nativeAdIcon) {\r\n                    this._nativeAdIcon.spriteFrame = new cc.SpriteFrame(res);\r\n                    this.content.active = true;\r\n                }\r\n            });\r\n        } else if (PlatUtils.IsVIVO && nativeData.icon) {\r\n            // 有icon\r\n\r\n            this._nativeAdImg.node.active = false;\r\n            this._noImageView.active = true;\r\n\r\n\r\n            CompatibleTool.LoadRes(nativeData.icon, (err, res) => {\r\n                if (!err && cc.isValid(this) && this._nativeAdIcon) {\r\n                    this._nativeAdIcon.spriteFrame = new cc.SpriteFrame(res);\r\n                    this.content.active = true;\r\n                }\r\n            });\r\n        }\r\n        this.node.active = true;\r\n        this.reportAdShow();\r\n        if (this.params) {\r\n            this.params.callBack && this.params.callBack();\r\n        }\r\n    }\r\n\r\n\r\n    // onEnable() {\r\n    //     // if (PlatUtils.IsOPPO || PlatUtils.IsVIVO) {\r\n    //     //     if (!this._closeBtn.active) {\r\n    //     //         this.node.on(cc.Node.EventType.TOUCH_START, (event: cc.Event) => {\r\n    //     //             this._reportAdClick();\r\n    //     //         }, this);\r\n    //     //     }\r\n    //     // }\r\n    // }\r\n\r\n    // onDisable() {\r\n    //     if (PlatUtils.IsOPPO || PlatUtils.IsVIVO) {\r\n    //         this.node.targetOff(this);\r\n    //     }\r\n    // }\r\n\r\n    onBtnClickHandler(event: cc.Event, data: any) {\r\n        switch (event.target.name) {\r\n            case \"closeBtn\": {\r\n                this.node.active = false;\r\n                break;\r\n            }\r\n            case \"Btn_Download\": {\r\n                this.reportAdClick();\r\n                break;\r\n            }\r\n        }\r\n    }\r\n\r\n\r\n\r\n    reportAdShow() {\r\n\r\n        utils.showLog(\"reportAdShow\");\r\n        if (this._nativeAd) {\r\n            this._nativeAd.reportAdShow();\r\n        }\r\n    }\r\n\r\n    reportAdClick() {\r\n        if (this._nativeAd) {\r\n            this._nativeAd.reportAdClick();\r\n        } else {\r\n            utils.showLog(\"广告加载失败！\");\r\n        }\r\n    }\r\n}\r\n"]}