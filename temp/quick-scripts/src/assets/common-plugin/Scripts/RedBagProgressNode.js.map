{"version":3,"sources":["assets\\common-plugin\\Scripts\\RedBagProgressNode.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import { utils } from \"./Utils\";\r\nimport { BannerLocation, SubLocation } from \"./YZ_Constant\";\r\nimport PlatUtils from \"./PlatUtils\";\r\nimport CompatibleTool from \"./CompatibleTool\";\r\n\r\nconst { ccclass, property } = cc._decorator;\r\n\r\n@ccclass\r\nexport default class RedBagProgressNode extends cc.Component {\r\n    progressLbl: cc.Label = null;\r\n    progressBar: cc.ProgressBar = null;\r\n    tripNode: cc.Node = null;\r\n    tripProgressLbl: cc.Label = null;\r\n    _location: any = \"default\";\r\n    onLoad() {\r\n        this.progressLbl = this.node.getComponentInChildren(cc.Label)\r\n        this.progressBar = this.node.getComponentInChildren(cc.ProgressBar);\r\n        this.tripNode = cc.find(\"Mask/tripNode\", this.node);\r\n        this.tripNode.opacity = 0;\r\n        this.tripProgressLbl = this.tripNode.getComponentInChildren(cc.Label);\r\n    }\r\n\r\n\r\n    public init(data?: any) {\r\n        if (data) {\r\n            if (data.location) {\r\n                this._location = data.location;\r\n            }\r\n        }\r\n        cc.log(\"wid s==========\" + utils.yzRedBagInfo.totalProgress + \" pro =\" + utils.yzRedBagInfo.progress);\r\n        this.progressBar.progress = utils.yzRedBagInfo.progress / utils.yzRedBagInfo.totalProgress;\r\n        this.progressLbl.string = `${utils.yzRedBagInfo.progress}/${utils.yzRedBagInfo.totalProgress}`\r\n        this.tripProgressLbl.string = `通过${utils.yzRedBagInfo.totalProgress}关即可领取红包`\r\n\r\n        if (utils.yzRedBagInfo.progress >= utils.yzRedBagInfo.totalProgress) {\r\n            cc.find(\"Mask/Icon/pro_cghb\", this.node).active = false;\r\n            cc.find(\"Mask/Icon/pro_full\", this.node).active = true;\r\n            cc.find(\"Mask/Icon/pro_full\", this.node).stopAllActions();\r\n            cc.find(\"Mask/Icon/pro_full\", this.node).runAction(cc.repeatForever(cc.sequence(cc.scaleTo(0.5, 1.2), cc.scaleTo(0.5, 1))));\r\n        } else {\r\n            cc.find(\"Mask/Icon/pro_cghb\", this.node).active = true;\r\n            cc.find(\"Mask/Icon/pro_full\", this.node).active = false;\r\n            cc.find(\"Mask/Icon/pro_full\", this.node).stopAllActions();\r\n        }\r\n\r\n        setTimeout(() => {\r\n            if (this.tripNode && cc.isValid(this.tripNode)) {\r\n                this.tripNode.runAction(cc.sequence(cc.fadeIn(0.3), cc.callFunc(() => {\r\n                    if (this.tripNode && cc.isValid(this.tripNode)) {\r\n                        this.tripNode.runAction(cc.sequence(cc.delayTime(5), cc.fadeOut(0.3)));\r\n                    }\r\n                })))\r\n            }\r\n        }, 3000);\r\n    }\r\n\r\n    onEnable() {\r\n        this.init();\r\n        utils.SendEvent(`红包进度挂件-${this._location}-展示成功`);\r\n        cc.game.on(\"YZ_RED_BAG_PROGRESS_CHANGE\", () => {\r\n            this.init();\r\n        }, this);\r\n    }\r\n\r\n    showOpenRedBagPanel() {\r\n        utils.SendEvent(`红包进度挂件-${this._location}-点击上报`);\r\n        if (utils.yzRedBagInfo.progress >= utils.yzRedBagInfo.totalProgress) {\r\n            utils.showOpenRedBagPanel({ showType: 2 });\r\n        } else {\r\n            utils.showMsg(\"再挑战\" + (utils.yzRedBagInfo.totalProgress - utils.yzRedBagInfo.progress) + \"关即可领取现金红包\");\r\n        }\r\n    }\r\n\r\n    onDisable() {\r\n        this.unscheduleAllCallbacks();\r\n        this.node.targetOff(this);\r\n        cc.game.targetOff(this);\r\n    }\r\n\r\n\r\n    // _postData(appid: string) {\r\n    //     utils.postData(appid);\r\n    // }\r\n\r\n\r\n}\r\n"]}