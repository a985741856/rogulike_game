{"version":3,"sources":["assets\\common-plugin\\Scripts\\QCrossWidget6.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import { utils } from \"./Utils\";\r\nimport QCrossWidgetItem from \"./QCrossWidgetItem\";\r\nimport AldUtils from \"./AldUtils\";\r\nimport { SubLocation } from \"./YZ_Constant\";\r\n\r\nconst { ccclass, property } = cc._decorator;\r\n\r\n@ccclass\r\nexport default class QCrossWidget6 extends cc.Component {\r\n\r\n\r\n    _pageView: cc.PageView = null;\r\n    _pageItem: cc.Node = null;\r\n    _pageRecItem: cc.Node = null;\r\n    private _jumpList: any = null;\r\n    private _items: QCrossWidgetItem[] = [];\r\n\r\n    onLoad() {\r\n\r\n        this._pageView = this.node.getChildByName(\"PageView\").getComponent(cc.PageView);\r\n        this._pageItem = this._pageView.content.getChildByName(\"Panel\");\r\n        this._pageRecItem = this._pageItem.children[0];\r\n        this._pageView.content.removeAllChildren();\r\n        // for (let i = 0; i < 6; i++) {\r\n        //     let item: cc.Node = panel.getChildByName(`Item${i}`);\r\n        //     let qcrossWidgetItem: QCrossWidgetItem = item.getComponent(\"QCrossWidgetItem\");\r\n        //     qcrossWidgetItem._location = \"isQCross\";\r\n\r\n        //     this._items.push(item.getComponent(\"QCrossWidgetItem\"));\r\n        // }\r\n\r\n        AldUtils.SendEvent(\"显示6元素交叉推广组件\");\r\n    }\r\n\r\n    start() {\r\n        this._jumpList = utils.getRecommondGameList();\r\n        if (this._jumpList && this._jumpList.length > 0) {\r\n            this._initWidget();\r\n        } else {\r\n            cc.warn(\"交叉推广数据为null, 6元素交叉推广组件不显示!\");\r\n            this.node.destroy();\r\n        }\r\n    }\r\n\r\n    private _initWidget() {\r\n        let totalPage: number = Math.ceil(this._jumpList.length / 6);\r\n        // utils.showLog(`qcrosswidget >>> totalPage = ${totalPage}`);\r\n        utils.showLog(`qcrosswidget >>> totalPage = ${totalPage}`);\r\n        let indx: number = 0;\r\n        for (let i = 0; i < totalPage; i++) {\r\n            let page = cc.instantiate(this._pageItem);\r\n            page.removeAllChildren();\r\n            this._pageView.addPage(page);\r\n            for (let j = 0; j < 6; j++) {\r\n                if (!this._jumpList[indx]) break;\r\n                let tempNode = cc.instantiate(this._pageRecItem);\r\n                page.addChild(tempNode);\r\n\r\n                let qcrossWidgetItem: QCrossWidgetItem = tempNode.getComponent(\"QCrossWidgetItem\");\r\n                qcrossWidgetItem._location = SubLocation.isQCross;\r\n                let data = this._jumpList[indx];\r\n                tempNode.getComponent(\"QCrossWidgetItem\").init(data);\r\n                indx++;\r\n            }\r\n        }\r\n\r\n        this.autoRefrshPageView();\r\n        // for (let i = 0; i < this._jumpList.length; i++) {\r\n        //     let data: any = this._jumpList[i];\r\n        //     if (data && data.logo) {\r\n        //         let itemIdx: number = idx;\r\n        //         if (itemIdx >= this._items.length) {\r\n        //             return;\r\n        //         }\r\n        //         idx++;\r\n        //         this._items[itemIdx].init(data);\r\n        //     }\r\n        // }\r\n    }\r\n\r\n    autoRefrshPageView() {\r\n        this.unscheduleAllCallbacks();\r\n\r\n        let interval = 3;\r\n        if (utils.ServerConfig && utils.ServerConfig.statement_auto_refresh) {\r\n            interval = utils.ServerConfig.statement_auto_refresh;\r\n        }\r\n        utils.showLog(`结算交叉推广组件${interval}秒自动刷新`);\r\n        this.schedule(() => {\r\n            let count = this._pageView.getPages().length;\r\n            let index = this._pageView.getCurrentPageIndex();\r\n            index = ((index < count) && (index + 1 !== count)) ? (index + 1) : 0;\r\n            if (index == 0) {\r\n                this._pageView.scrollToPage(index, 0);\r\n            } else {\r\n                this._pageView.scrollToPage(index, 2);\r\n            }\r\n        }, interval);\r\n    }\r\n}\r\n"]}